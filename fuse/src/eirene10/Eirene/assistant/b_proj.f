C
C
      subroutine B_PROJ(B,EB,V,V_PARALLEL,V_PERP,PHI)
C
C  PROJECTS A VECTOR V ONTO ANOTHER VECTOR B
C  AT ENTRY: B_PROJ : NORMALIZE B TO UNIT VECTOR EB FIRST
C  AT ENTRY: B_PROJN: EB IS KNOWN TO BE THE UNIT VECTOR OF B
C  INPUT : B(3), V(3)
C  OUTPUT: V_PARALLEL, V_PERP   (V_PARALLEL CAN BE POSITIVE OR NEGATIVE)
C
      USE PRECISION
      implicit none
      REAL(DP), INTENT(INOUT) :: B(3), V(3)
      REAL(DP), INTENT(OUT) :: EB(3), V_PARALLEL, V_PERP, PHI
      REAL(DP) :: BNI, VQ

      BNI=1./SQRT(SUM(B*B)+1.D-30)
      EB=B*BNI
C
      ENTRY B_PROJN(B,EB,V,V_PARALLEL,V_PERP,PHI)
      V_PARALLEL=SUM(V*EB)
C
      VQ=SUM(V*V)
      V_PERP    =SQRT(VQ-V_PARALLEL**2)
C
C     PHI= ?
	PHI=0._DP   ! for the time being
      return
      end

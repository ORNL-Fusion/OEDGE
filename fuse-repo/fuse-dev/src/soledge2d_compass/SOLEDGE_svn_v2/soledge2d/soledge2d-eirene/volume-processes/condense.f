C
C
      SUBROUTINE EIRENE_CONDENSE
C
C  CONDENSE COLLISION KERNEL, IF SOME SECONDARIES ARE NOT FOLLOWED
C  BY EIRENE, I.E., IF NFOLA(IATM), NFOLM(IMOL), NFOLI(IION) LT 0
C  FOR SOME TEST PARTICLE SPECIES
C
      USE EIRMOD_PRECISION
      USE EIRMOD_PARMMOD
      USE EIRMOD_COMUSR
      USE EIRMOD_COMPRT, ONLY: IUNOUT
      USE EIRMOD_CCONA
      USE EIRMOD_CGRID
      USE EIRMOD_CZT1
      USE EIRMOD_CTRCEI
      USE EIRMOD_CTEXT
      USE EIRMOD_COMXS
      USE EIRMOD_CSPEI
 
      IMPLICIT NONE
 
      INTEGER :: ISP, IION, ICOL, IATM, IMOL, IRDS, IMDS
 
      DO 10 IATM=1,NATMI
C  NRCA=0 ?
        DO 100 ICOL=1,NRCA(IATM)
100     CONTINUE
10    CONTINUE
C
C
      DO 20 IMOL=1,NMOLI
C  currently: only electron impact collisions
        DO 200 IMDS=1,NMDSI(IMOL)
          IRDS=LGMEI(IMOL,IMDS)
          DO 220 IION=1,NIONI
            ISP=NSPAM+IION
            IF (PIODS(IRDS,IION).GT.0) THEN
              IF (NFOLI(IION).LT.0) THEN
                WRITE (iunout,*) 'TEST ION ',TEXTS(ISP),
     .                           ' CAN BE CONDENSED'
              ENDIF
            ENDIF
220       CONTINUE
200     CONTINUE
20    CONTINUE
C
      RETURN
      END

C
C
      SUBROUTINE EIRENE_FISOTR
C
C  SAMPLE IRNDVC TRIPLES OF RANDOM NUMBER FROM A 3D ISOTROPIC
C  DISTRIBUTION
C  AND RETURN THEM IN THE ARRAYS FI1,FI2,FI3
C  THIS ROUTINE IS CALLED, IF INIV3=0, AND IT RETURNS INIV3=IRNDVC
C
      USE EIRMOD_CRAND
 
      IMPLICIT NONE
 
      REAL(DP) :: ZCTHET, ZTHETA, ZSTHET, ZSPHI, ZCPHI, PI2, ZEP1, ZEP2
      REAL(DP), EXTERNAL :: RANF_EIRENE
      INTEGER :: J
 
      DATA PI2/6.283185/
C
      DO 100 J=1,IRNDVC
        ZEP1=RANF_EIRENE( )
        ZEP2=RANF_EIRENE( )
C  THETA
        ZTHETA=PI2*ZEP2
        ZCTHET=COS(ZTHETA)
        ZSTHET=SIN(ZTHETA)
C  PHI
        ZCPHI=ZEP1+ZEP1-1.
        ZSPHI=SQRT(1.-ZCPHI*ZCPHI)
C
        FI1(J)=ZCPHI
        FI2(J)=ZSPHI*ZSTHET
        FI3(J)=ZSPHI*ZCTHET
100   CONTINUE
      INIV3=IRNDVC
      RETURN
      END

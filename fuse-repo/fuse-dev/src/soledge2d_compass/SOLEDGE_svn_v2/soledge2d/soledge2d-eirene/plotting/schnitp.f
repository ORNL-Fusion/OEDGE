 
 
      SUBROUTINE EIRENE_SCHNITP(X1,Y1,X2,Y2,X3,Y3,X4,Y4,EX,EY)
C   INTERSECTION POINT E OF 2 STRAIGHT LINES G1 AND G2
C   G1 IS DEFINED BY POINTS 1 AND 2
C   G2 IS DEFINED BY POINTS 3 AND 4
 
      USE EIRMOD_PRECISION
 
      IMPLICIT NONE
 
      REAL(DP), INTENT(IN) :: X1, Y1, X2, Y2, X3, Y3, X4, Y4
      REAL(DP), INTENT(OUT) :: EX, EY
      REAL(DP) :: MUE
 
      MUE = ((Y2-Y4)*(X3-X4)+(X4-X2)*(Y3-Y4))/
     .      ((X1-X2)*(Y3-Y4)-(Y1-Y2)*(X3-X4)+1.D-20)
      EX = X2 + MUE * (X1-X2)
      EY = Y2 + MUE * (Y1-Y2)
      END

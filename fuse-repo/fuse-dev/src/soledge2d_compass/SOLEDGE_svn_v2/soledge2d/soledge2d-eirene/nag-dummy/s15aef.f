 
*******************************************************************************
*******************************************************************************
 
      FUNCTION EIRENE_S15AEF(X,IFAIL)
C     MARK 4 RELEASE NAG COPYRIGHT 1974.
C     MARK 4.5 REVISED
C     MARK 8 REVISED. IER-221 (MAR 1980)
C     MARK 11.5(F77) REVISED. (SEPT 1985.)
C     MARK 14 REVISED. IER-755 (DEC 1989).
C     ERF(X)
C
C     **************************************************************
C
C     TO EXTRACT THE CORRECT CODE FOR A PARTICULAR MACHINE-RANGE,
C     ACTIVATE THE STATEMENTS CONTAINED IN COMMENTS BEGINNING  CDD ,
C     WHERE  DD  IS THE APPROXIMATE NUMBER OF SIGNIFICANT DECIMAL
C     DIGITS REPRESENTED BY THE MACHINE
C     DELETE THE ILLEGAL DUMMY STATEMENT OF THE FORM
C     * EXPANSION (DATA) *
C
C     **************************************************************
C     .. Scalar Arguments ..
      USE EIRMOD_PRECISION
      IMPLICIT NONE
      REAL(DP)                 X,  EIRENE_S15AEF
      INTEGER              IFAIL
C     .. Local Scalars ..
      REAL(DP)                 BJ, BJP1, BJP2, HALF, ONE, SQRTPI, THREE,
     *                     TWENTY, TWO, X2, XUP, XV, ZERO
      INTEGER              J, NCFC, NCFD
C     .. Local Arrays ..
C07   REAL(DP)                 C(8), D(8)
C12   REAL(DP)                 C(11), D(12)
C14   REAL(DP)                 C(15), D(15)
      REAL(DP)                 C(18), D(17)
C     .. Intrinsic Functions ..
      INTRINSIC            ABS, EXP, SIGN
C     .. Data statements ..
C      * EXPANSION (DATA) *
C07   DATA NCFC,NCFD/8,8/,XUP/4.0E0/,SQRTPI/1.772454E0/
C07  A,C(1),C(2),C(3),C(4),C(5),C(6),C(7),C(8)
C07  A/1.944907E0,4.2019E-2,-1.8687E-2,5.129E-3,-1.068E-3
C07  A,1.74E-4,-2.1E-5,2.0E-6/
C07  A,D(1),D(2),D(3),D(4),D(5),D(6),D(7),D(8)
C07  A/1.483110E0,-3.01071E-1,6.8995E-2,-1.3916E-2,2.421E-3
C07  A,-3.66E-4,4.9E-5,-6.0E-6/
C
C12   DATA NCFC,NCFD/11,12/,XUP/5.0E0/,SQRTPI/1.7724538509E0/,C(1),
C12  * C(2),C(3),C(4),C(5),C(6),C(7),C(8),C(9),C(10),C(11)
C12  * /1.9449071068E0,4.20186582E-2,-1.86866104E-2,5.1281062E-3,
C12  * -1.0683107E-3,1.744738E-4,-2.15642E-5,1.7283E-6,-2.D-8,-1.65E-8,
C12  * 2.D-9/,D(1),D(2),D(3),D(4),D(5),D(6),D(7),D(8),D(9),
C12  * D(10),D(11),D(12)/1.4831105641E0,-3.010710734E-1,6.89948307E-2,
C12  * -1.39162713E-2,2.4207995E-3,-3.658640E-4,4.86210E-5,-5.7493E-6,
C12  * 6.113E-7,-5.90E-8,5.2E-9,-4.D-10/
C
C14   DATA NCFC,NCFD/15,15/,XUP/5.75E0/,SQRTPI/1.7724538509055E0/
C14  A,C(1),C(2),C(3),C(4),C(5),C(6),C(7),C(8),C(9),C(10)
C14  A,C(11),C(12),C(13),C(14),C(15)
C14  A/1.9449071068179E0,4.20186582324E-2,-1.86866103977E-2
C14  A,5.1281061839E-3,-1.0683107462E-3,1.744737872E-4
C14  A,-2.15642056E-5,1.7282658E-6,-2.00479E-8,-1.64782E-8
C14  A,2.0008E-9,2.58E-11,-3.06E-11,1.9E-12,4.0E-13/
C14  A,D(1),D(2),D(3),D(4),D(5),D(6),D(7),D(8),D(9),D(10)
C14  A,D(11),D(12),D(13),D(14),D(15)
C14  A/1.4831105640848E0,-3.010710733866E-1,6.89948306898E-2
C14  A,-1.39162712647E-2,2.4207995224E-3,-3.658639686E-4
C14  A,4.86209844E-5,-5.7492565E-6,6.113243E-7,-5.89910E-8
C14  A,5.2070E-9,-4.233E-10,3.19E-11,-2.2E-12,1.0E-13/
C
      DATA NCFC,NCFD/18,17/,XUP/6.25E0/,SQRTPI/1.7724538509055160E0/
     A,C(1),C(2),C(3),C(4),C(5),C(6),C(7),C(8),C(9),C(10),C(11)
     A,C(12),C(13),C(14),C(15),C(16),C(17),C(18)
     A/1.9449071068178803E0,4.20186582324414E-2,-1.86866103976769E-2
     A,5.1281061839107E-3,-1.0683107461726E-3,1.744737872522E-4
     A,-2.15642065714E-5,1.7282657974E-6,-2.00479241E-8
     A,-1.64782105E-8,2.0008475E-9,2.57716E-11,-3.06343E-11
     A,1.9158E-12,3.703E-13,-5.43E-14,-4.0E-15,1.2E-15/
     A,D(1),D(2),D(3),D(4),D(5),D(6),D(7),D(8),D(9),D(10),D(11)
     A,D(12),D(13),D(14),D(15),D(16),D(17)
     A/1.4831105640848036E0,-3.010710733865950E-1,6.89948306898316E-2
     A,-1.39162712647222E-2,2.4207995224335E-3,-3.658639685849E-4
     A,4.86209844323E-5,-5.7492565580E-6,6.113243578E-7
     A,-5.89910153E-8,5.2070091E-9,-4.232976E-10,3.18811E-11
     A,-2.2361E-12,1.467E-13,-9.0E-15,5.0E-16/
C
      DATA                 ZERO, ONE, TWO, THREE, TWENTY, HALF/0.0, 1.0,
     *                     2.0, 3.0, 20.0, 0.5/
C     .. Executable Statements ..
C
C     NO FAILURE EXITS
      IFAIL = 0
      XV = ABS(X)
      IF (XV.GE.XUP) GO TO 120
      IF (XV.LE.TWO) GO TO 60
      X2 = TWO - TWENTY/(XV+THREE)
C
C     SUMMATION
      BJP2 = ZERO
      BJP1 = C(NCFC)
      J = NCFC - 1
   20 BJ = X2*BJP1 - BJP2 + C(J)
      IF (J.EQ.1) GO TO 40
      BJP2 = BJP1
      BJP1 = BJ
      J = J - 1
      GO TO 20
   40 X2 = HALF*(BJ-BJP2)/XV*EXP(-X*X)/SQRTPI
       EIRENE_S15AEF = (ONE-X2)*SIGN(ONE,X)
      GO TO 140
C
   60 X2 = X*X - TWO
C     SUMMATION
      BJP2 = ZERO
      BJP1 = D(NCFD)
      J = NCFD - 1
   80 BJ = X2*BJP1 - BJP2 + D(J)
      IF (J.EQ.1) GO TO 100
      BJP2 = BJP1
      BJP1 = BJ
      J = J - 1
      GO TO 80
  100  EIRENE_S15AEF = HALF*(BJ-BJP2)*X
      GO TO 140
C
  120  EIRENE_S15AEF = SIGN(ONE,X)
  140 RETURN
      END

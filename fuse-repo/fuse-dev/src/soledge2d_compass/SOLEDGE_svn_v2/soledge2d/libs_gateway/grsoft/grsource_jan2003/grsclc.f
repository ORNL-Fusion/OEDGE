C@PROCESS OPT(3) NOSDUMP NOGOSTMT
C     SCALE CM
C     UPDATE  14.12.90 M.BUSCH
C             scale cm bezieht sich auf die bei GRSCLP (scale paper)
C             gesetzten cm Werte
C     UPDATE  17. 1.91 M.BUSCH
C UPDATE 26. 2.1991 Busch , COMMON GRREST neu
C                   GPM durch GRPTS ersetzt
C----------------------------------------------------------------------
      SUBROUTINE GRSCLC(XMIN,YMIN,XMAX,YMAX)

      INTEGER FLPIC, RAHMEN
      REAL    XMIN,YMIN,XMAX,YMAX
      REAL    XLN(300),YLN(300),XMR(300),YMR(300)

      COMMON /GRREST/MAXPKT,NRLN,XCURR,YCURR,XLN,YLN,
     $               NRMR,XMR,YMR
CDEC$ PSECT /GRREST/ NOSHR
      COMMON /SCALE/ XMAXDC,XUNITS,YUNITS
CDEC$ PSECT /SCALE/ NOSHR
      COMMON /GRPIC/ FLPIC,NSCLC,NSCLV, NSCLP, RAHMEN,
     $               XMAXCM,YMAXCM, XDCPIC,YDCPIC
CDEC$ PSECT /GRPIC/ NOSHR
C---- COMMONBLOCK DER STANDARDWERTE BZW. DER GEAENDERTEN TABELLENWERTE
      COMMON /GRPP/ PP(18)
CDEC$ PSECT /GRPP/ NOSHR
      save  /GRREST/,/SCALE/ ,/GRPIC/, /GRPP/

      EQUIVALENCE (PP(16),INTSYM)


C     FALLS PICTURE SIZE NICHT GESETZT - > STANDARD
      IF (FLPIC.NE.1234567890) THEN
         XMAXCM=39.5
         YMAXCM=28.7
         XDCPIC=1.
         YDCPIC=28.7/39.5
         CALL GSVP(1,0.,1.,0.,0.7266)
      ENDIF

C     NSCLC = ZEHLER GRSCLC AUFRUFE
      NSCLC=NSCLC+1

      PP(1)=XMIN
      PP(2)=YMIN
      PP(3)=XMAX
      PP(4)=YMAX

CCC   AUSGABE EVT. VORHANDENER GRJMP- UND GRDRW-DATEN

      IF (NRLN.GT.1) THEN
         CALL GPL(NRLN,XLN,YLN)
         XCURR=XLN(NRLN)
         YCURR=YLN(NRLN)
         NRLN=0
      ENDIF
      IF (NRMR.GT.0) THEN
         CALL GPM(NRMR,XMR,YMR)
         NRMR=0
      ENDIF

C---- IN DEN ROUTINEN  GRSCLC, GRSCLV MUSS DAS WINDOW
C---- NEU BERECHNET WERDEN.
C---- EINHEITEN/CM : UNITS=VALUES/CM
CNEU M.BUSCH
C     HIER AUF XMAXCM UND YMAXCM BEZIEHEN STATT AUF DAS WAS
C     VON GRSCLC KOMMT

      XUNITS=(PP(7)-PP(5))/(PP(3)-PP(1))
      YUNITS=(PP(8)-PP(6))/(PP(4)-PP(2))

C---- UMRECHNUNG DES WINDOW AUF DEN GESAMTEN VIEWPORTBEREICH

      XLI=PP(5)-PP(1)*XUNITS
      YLI=PP(6)-PP(2)*YUNITS
C---- PP(9) = FCTR = 10.5 : XMAXCM=39.5, YMAXCM=28.7
C     XMAXCM=3.7619048*PP(9)
C     YMAXCM=2.7333333*PP(9)

      XRE=PP(7)+(XMAXCM-PP(3))*XUNITS
      YRE=PP(8)+(YMAXCM-PP(4))*YUNITS
C---- WINDOW AUF NDC  ABBILDEN
      CALL GSWN(1,XLI,XRE,YLI,YRE)
      CALL GRCHRC(PP(14),PP(15),INTSYM)
C      WRITE(93,*) ' GRSCLC-----------'
C      WRITE(93,*) ' GSWN XLI,XRE,YLI,YRE,XUNITS,YUNITS'
C      WRITE(93,*)  XLI,XRE,YLI,YRE,XUNITS,YUNITS
C      WRITE(93,*)   XLI,XRE,YLI,YRE
C      WRITE(93,*) ' GRSCLC---END-----'


      END

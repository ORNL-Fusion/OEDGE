%checking if points are not aligned
for n=1:nknots_
    if(knots_interp(n).nsol<=3)
        if(knots_interp(n).nsol==3)
            k=knots_interp(n).sol(1,1);
            i=knots_interp(n).sol(1,2);
            j=knots_interp(n).sol(1,3);
            p1r=zones.zone(k).gridRc(i,j);
            p1z=zones.zone(k).gridZc(i,j);
            k=knots_interp(n).sol(2,1);
            i=knots_interp(n).sol(2,2);
            j=knots_interp(n).sol(2,3);
            p2r=zones.zone(k).gridRc(i,j);
            p2z=zones.zone(k).gridZc(i,j);
            k=knots_interp(n).sol(3,1);
            i=knots_interp(n).sol(3,2);
            j=knots_interp(n).sol(3,3);
            p3r=zones.zone(k).gridRc(i,j);
            p3z=zones.zone(k).gridZc(i,j);
        else
            if(knots_interp(n).nsol==2)
                k=knots_interp(n).sol(1,1);
                i=knots_interp(n).sol(1,2);
                j=knots_interp(n).sol(1,3);
                p1r=zones.zone(k).gridRc(i,j);
                p1z=zones.zone(k).gridZc(i,j);
                k=knots_interp(n).sol(2,1);
                i=knots_interp(n).sol(2,2);
                j=knots_interp(n).sol(2,3);
                p2r=zones.zone(k).gridRc(i,j);
                p2z=zones.zone(k).gridZc(i,j);
                p3r=R_(knots_interp(n).eir(1));
                p3z=Z_(knots_interp(n).eir(1));
            else
                if(knots_interp(n).nsol==1)
                    k=knots_interp(n).sol(1,1);
                    i=knots_interp(n).sol(1,2);
                    j=knots_interp(n).sol(1,3);
                    p1r=zones.zone(k).gridRc(i,j);
                    p1z=zones.zone(k).gridZc(i,j);
                    p2r=R_(knots_interp(n).eir(1));
                    p2z=Z_(knots_interp(n).eir(1));
                    p3r=R_(knots_interp(n).eir(2));
                    p3z=Z_(knots_interp(n).eir(2));
                else
                    if(knots_interp(n).neir~=0)
                        p1r=R_(knots_interp(n).eir(1));
                        p1z=Z_(knots_interp(n).eir(1));
                        p2r=R_(knots_interp(n).eir(2));
                        p2z=Z_(knots_interp(n).eir(2));
                        p3r=R_(knots_interp(n).eir(3));
                        p3z=Z_(knots_interp(n).eir(3));
                    end
                end
            end
        end
        v1r=p2r-p1r;
        v1z=p2z-p1z;
        v2r=p3r-p1r;
        v2z=p3z-p1z;
        hr=v2r/v1r;
        hz=v2z/v1z;
        if(abs(hz/hr-1)<=1e-3)
            disp(strcat('points almost aligned for triangle ',num2str(n)))
        end
    end
end

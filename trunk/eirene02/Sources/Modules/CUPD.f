      MODULE CUPD

      USE PRECISION
      USE PARMMOD

      IMPLICIT NONE

      PRIVATE

      PUBLIC :: ALLOC_CUPD, DEALLOC_CUPD, INIT_CUPD

      REAL(DP), PUBLIC, SAVE ::
     R X00, Y00, Z00, X01, Y01, Z01

      REAL(DP), PUBLIC, ALLOCATABLE, SAVE ::
     R ALPD(:), BLPD(:), CLPD(:)

      INTEGER, PUBLIC, SAVE ::
     I NCOUP, NCOUT,  NCOU,   NNTCLL,
     I IRCELL, IPCELL, ITCELL, ISRFCL

      INTEGER, PUBLIC, ALLOCATABLE, SAVE ::
     I JUPC(:),   KUPC(:),   NUPC(:),
     I NCOUNP(:), NCOUNT(:),
     I LUPC(:),   MUPC(:)

      CONTAINS


      SUBROUTINE ALLOC_CUPD

      IF (ALLOCATED(ALPD)) RETURN

      ALLOCATE (ALPD(N2ND))
      ALLOCATE (BLPD(N3RD))
      ALLOCATE (CLPD(N2ND+N3RD))

      ALLOCATE (JUPC(N2ND))
      ALLOCATE (KUPC(N3RD))
      ALLOCATE (NUPC(N2ND+N3RD))
      ALLOCATE (NCOUNP(N2ND+N3RD))
      ALLOCATE (NCOUNT(N2ND+N3RD))
      ALLOCATE (LUPC(N2ND))
      ALLOCATE (MUPC(N2ND))

      WRITE (55,*) ' CUPD ',2*(N2ND+N3RD)*8
      WRITE (55,*) ' CUPD ',(4*(N2ND+N3RD)+2*N2ND)*4

      CALL INIT_CUPD

      RETURN

      END SUBROUTINE ALLOC_CUPD


      SUBROUTINE DEALLOC_CUPD

      IF (.NOT.ALLOCATED(ALPD)) RETURN

      DEALLOCATE (ALPD)
      DEALLOCATE (BLPD)
      DEALLOCATE (CLPD)

      DEALLOCATE (JUPC)
      DEALLOCATE (KUPC)
      DEALLOCATE (NUPC)
      DEALLOCATE (NCOUNP)
      DEALLOCATE (NCOUNT)
      DEALLOCATE (LUPC)
      DEALLOCATE (MUPC)

      RETURN

      END SUBROUTINE DEALLOC_CUPD


      SUBROUTINE INIT_CUPD

      ALPD   = 0._DP
      BLPD   = 0._DP
      CLPD   = 0._DP

      JUPC   = 0
      KUPC   = 0
      NUPC   = 0
      NCOUNP = 0
      NCOUNT = 0
      LUPC   = 0
      MUPC   = 0

      RETURN

      END SUBROUTINE INIT_CUPD

      END MODULE CUPD

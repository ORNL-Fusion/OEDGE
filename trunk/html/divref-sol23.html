<!DOCTYPE HTML PUBLIC "-//SoftQuad//DTD HoTMetaL PRO 4.0::19971010::extensions to HTML 4.0//EN"
 "hmpro4.dtd">

<HTML>
  
  <HEAD>
    <TITLE>SOL23/OSM2 Reference Manual</TITLE>
<!-- Changed by: David Elder, 18-Mar-1999 -->
    <META NAME="Description" CONTENT="">
    <META HTTP-EQUIV="Description" CONTENT="">

<!--    <LINK REL=STYLESHEET TYPE="text/css" HREF="divdocs.css" TITLE="Style"> -->

    <STYLE TYPE="text/css">


        BODY { color:black; 
               background:white }

        A:link  { color:blue; 
                  text-decoration: none;
                  font-weight:normal}
                  
        A:active { color:green; 
                   text-decoration: none;
                   font-weight:bold}
                   
        A:visited{ color:red; 
                   text-decoration: none;
                   font-weight:normal}`
                   
	
	H1 { font-weight:bold;
             font-style:italic; 
             text-align:center;
             color:red }

	H2 { font-weight:bold;
             color:green}
	
	H3 { font-weight:bold;
	     color:crimson}
               

	.c1 { color:green;
	      font-weight:bold}

        .c2 { color:green;
              font-weight:bold;
              font-size:larger;
              font-style:italic; 
              text-align:center
              }

    </STYLE>

  </HEAD>
  
  <BODY>
    
    <P><B><FONT SIZE="4"></FONT></B></P>
    
    <H1 ALIGN="CENTER">SOL Option 23 (OSM2) Parameter Reference:</H1>
    
    <P><B></B></P>
    
    <P ALIGN="CENTER">W.Fundamenski</P>
    
    <P><FONT SIZE="2"></FONT></P>
    
    <P ALIGN="CENTER">17.II.2000</P>
    
    <P ALIGN="CENTER"></P>
    
    <P ALIGN="JUSTIFY">The following parameters are to be entered at the end of
      the DIVIMP input file (.d6i), in the order indicated in the skeleton file
      wfdefault.d6i, which also contains the default values for a typical case.
      They link to the code modules iodiv.d6a, sol23.d6a, and cfd_osm.d6a via
      the sol23 and sol23_input variable common blocks. For a description of the
      physics and numerics (CFD and DVM) of the OSM2 code, please consult the
      appendices for a description of the modelling equations and numerical
      algorithms. Variables appear in bold type.</P>
    
    <P><B></B></P>

    <DIV ID=toc> 
    
    <P><B><FONT SIZE="+2">Table of Contents:</FONT></B></P>
    
    <P><B></B></P>
    
    <P><B></B></P>

<PRE>    
<A HREF="#301"><FONT CLASS=c1>301</font> SOL23  ptipte ..........   1.0   </A>
<A HREF="#302"><FONT CLASS=c1>302</font> SOL23  adaptnr              2    </A>
<A HREF="#303"><FONT CLASS=c1>303</font> SOL23  debugflag            0    </A>
<A HREF="#304"><FONT CLASS=c1>304</font> SOL23  debugnr              0    </A>
<A HREF="#305"><FONT CLASS=c1>305</font> SOL23  refresh             100   </A>
<A HREF="#306"><FONT CLASS=c1>306</font> SOL23  artvisc2 ........   0.3   </A> 
<A HREF="#307"><FONT CLASS=c1>307</font> SOL23  artvisc4            0.01  </A>
<A HREF="#308"><FONT CLASS=c1>308</font> SOL23  dtf                 0.5	  </A>
<A HREF="#309"><FONT CLASS=c1>309</font> SOL23  dtg                1.0E24 </A>
<A HREF="#310"><FONT CLASS=c1>310</font> SOL23  grid0               0.1	  </A>
<A HREF="#311"><FONT CLASS=c1>311</font> SOL23  gridexp .........   1.25  </A>
<A HREF="#312"><FONT CLASS=c1>312</font> SOL23  itermax             1000  </A>
<A HREF="#313"><FONT CLASS=c1>313</font> SOL23  ga1                 10.0  </A>
<A HREF="#314"><FONT CLASS=c1>314</font> SOL23  ga2                 0.01  </A>
<A HREF="#315"><FONT CLASS=c1>315</font> SOL23  ga3                 0.2	  </A>
<A HREF="#316"><FONT CLASS=c1>316</font> SOL23  ga4   ...........   10.0  </A>
<A HREF="#317"><FONT CLASS=c1>317</font> SOL23  updtqpit             0	  </A>
<A HREF="#318"><FONT CLASS=c1>318</font> SOL23  updtqp2             0.003 </A>
<A HREF="#319"><FONT CLASS=c1>319</font> SOL23  updtqp3             0.03  </A>
<A HREF="#320"><FONT CLASS=c1>320</font> SOL23  updtqpte            0.01  </A>
<A HREF="#321"><FONT CLASS=c1>321</font> SOL23  garelax .........   0.03  </A>
<A HREF="#322"><FONT CLASS=c1>322</font> SOL23  gaiter               1	  </A>
<A HREF="#323"><FONT CLASS=c1>323</font> SOL23  limitte              1	  </A>
<A HREF="#324"><FONT CLASS=c1>324</font> SOL23  celldte             0.95  </A>
<A HREF="#325"><FONT CLASS=c1>325</font> SOL23  updtbcte            30.0  </A>
<A HREF="#326"><FONT CLASS=c1>326</font> SOL23  updtdel0 ........   1.0   </A>
<A HREF="#327"><FONT CLASS=c1>327</font> SOL23  updtdel1            1.0	  </A>
<A HREF="#328"><FONT CLASS=c1>328</font> SOL23  updtdelm            0.1	  </A>
<A HREF="#329"><FONT CLASS=c1>329</font> SOL23  qbrelax             0.02  </A>
<A HREF="#330"><FONT CLASS=c1>330</font> SOL23  gridg               0.03  </A>
<A HREF="#331"><FONT CLASS=c1>331</font> SOL23  grid_dx0 ........   0.001 </A>
<A HREF="#332"><FONT CLASS=c1>332</font> SOL23  gae                 5.0	  </A>
<A HREF="#333"><FONT CLASS=c1>333</font> SOL23  gai                 2.5	  </A>
<A HREF="#334"><FONT CLASS=c1>334</font> SOL23  tectrl               1	  </A>
<A HREF="#335"><FONT CLASS=c1>335</font> SOL23  drflag               0	  </A>
<A HREF="#336"><FONT CLASS=c1>336</font> SOL23  dsflag  .........    0    </A>
<A HREF="#337"><FONT CLASS=c1>337</font> SOL23  limrel1             0.03  </A>
<A HREF="#338"><FONT CLASS=c1>338</font> SOL23  limrel2             0.1	  </A>
<A HREF="#339"><FONT CLASS=c1>339</font> SOL23  limrel3             0.03  </A>
<A HREF="#340"><FONT CLASS=c1>340</font> SOL23  limrel4             0.03  </A>
<A HREF="#341"><FONT CLASS=c1>341</font> SOL23  tulimit  ........   5.0   </A>
<A HREF="#342"><FONT CLASS=c1>342</font> SOL23  g0relax             0.1	  </A>
<A HREF="#343"><FONT CLASS=c1>343</font> SOL23  p0relax             0.02  </A>
<A HREF="#344"><FONT CLASS=c1>344</font> SOL23  dpdrflag             0	  </A>
<A HREF="#345"><FONT CLASS=c1>345</font> SOL23  dpdrtemin           1.0	  </A>
<A HREF="#346"><FONT CLASS=c1>346</font> SOL23  dpdrstep  .......   0.1   </A>
<A HREF="#347"><FONT CLASS=c1>347</font> SOL23  nuflag               0	  </A>
<A HREF="#348"><FONT CLASS=c1>348</font> SOL23  nulimit            1.0E20 </A>
<A HREF="#349"><FONT CLASS=c1>349</font> SOL23  vnmult              1.0	  </A>
<A HREF="#350"><FONT CLASS=c1>350</font> SOL23  pinmom               0	  </A>
<A HREF="#351"><FONT CLASS=c1>351</font> SOL23  emolec              3.0   </A>
<A HREF="#352"><FONT CLASS=c1>352</font> SOL23  rec_heat  .......   13.6  </A>
<A HREF="#353"><FONT CLASS=c1>353</font> SOL23  pinqimult           1.0	  </A>
<A HREF="#354"><FONT CLASS=c1>354</font> SOL23  pinqiflag            0	  </A>
<A HREF="#355"><FONT CLASS=c1>355</font> SOL23  prring0              7	  </A>
<A HREF="#356"><FONT CLASS=c1>356</font> SOL23  prring1              3    </A>
<A HREF="#357"><FONT CLASS=c1>357</font> SOL23  qperp34 .........    0	  </A>
<A HREF="#358"><FONT CLASS=c1>358</font> SOL23  qeiflag              1	  </A>
<A HREF="#359"><FONT CLASS=c1>359</font> SOL23  chie                 1	  </A>
<A HREF="#360"><FONT CLASS=c1>360</font> SOL23  joule                1	  </A>
<A HREF="#361"><FONT CLASS=c1>361</font> SOL23  fluxexp              1    </A>
<A HREF="#362"><FONT CLASS=c1>362</font> SOL23  qrec    .........    1	  </A>
<A HREF="#363"><FONT CLASS=c1>363</font> SOL23  fzrad               1.0	  </A>
<A HREF="#364"><FONT CLASS=c1>364</font> SOL23  dvmrel               2	  </A>
<A HREF="#365"><FONT CLASS=c1>365</font> SOL23  intopt               1	  </A>
<A HREF="#366"><FONT CLASS=c1>366</font> SOL23  adaptgrid            0    </A>
<A HREF="#367"><FONT CLASS=c1>367</font> SOL23  seed                 1	  </A>
<A HREF="#368"><FONT CLASS=c1>368</font> SOL23  izlen   .........   0.5	  </A>
<A HREF="#369"><FONT CLASS=c1>369</font> SOL23  izlam               0.03  </A>
<A HREF="#370"><FONT CLASS=c1>370</font> SOL23  izoffset            0.03  </A>
<A HREF="#371"><FONT CLASS=c1>371</font> SOL23  momlen              0.1   </A>
<A HREF="#372"><FONT CLASS=c1>372</font> SOL23  relax               0.01  </A>
<A HREF="#373"><FONT CLASS=c1>373</font> SOL23  maxtol              3.0E-3</A>
<A HREF="#374"><FONT CLASS=c1>374</font> SOL23  rmstol  .........   3.0E-4</A>
<A HREF="#375"><FONT CLASS=c1>375</font> SOL23  Qperp               1	  </A>
</pre>
</DIV>
    <P>&nbsp</p>
    
    <P>&nbsp</P>
    
    <P>&nbsp</P>
    
    <P>&nbsp</P>
    
    <P>&nbsp</P>
    
    <P><B><FONT SIZE="+2">Summary of SOL23 Parameters:</FONT></B></P>
    
    <P><B></B></P>
    <TABLE WIDTH="100%" BORDER="1">
      <TR>
        <TD WIDTH="15%">ptipte</TD>
        <TD WIDTH="85%">[real*8] the ratio of ion to electron volumetric
        cross-field (input) powers, <B>Q<FONT FACE="Symbol">^</FONT> </B><SUP>(3)</SUP>
        / <B>Q<FONT FACE="Symbol">^</FONT> </B><SUP>(4)</SUP>. <B>Ptipte</B>
        = 1 is typically assumed, as suggested by experiment.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%">adaptnr</TD>
        <TD WIDTH="85%">[integer] the number of SOL rings for which grid
        adaptation is to be used when the <B>adaptgrid </B>flag is set to 2.
        Otherwise ignored. Grid adaptation from ring # irsep to ring # irsep +
        <B>adaptnr. </B></TD>
      </TR>
      <TR>
        <TD WIDTH="15%">debugflag</TD>
        <TD WIDTH="85%">[integer] create output for debugging purposes (0 off,
        1 on).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%">debugnr</TD>
        <TD WIDTH="85%">[integer] ring number which is to be debugged = irsep +
        <B>debugnr.</B> active when <B>debugflag </B> = 1, otherwise ignored.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%">refresh</TD>
        <TD WIDTH="85%">[integer] update sources (inside the subroutine initQ)
        every <B>refresh</B> number of CFD iterations; typically, <B>refresh</B>
        = 100.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">artvisc2</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] 2<SUP>nd</SUP> order artificial
        (Jameson) viscosity parameter.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">artvisc4</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] 4<SUP>th</SUP> order artificial
        (Jameson) viscosity parameter.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">dtf</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] convective time step wrt. CFL
        (that is Courant-Friedrichs-Levi, not the Canadian Football League!)
        time step. Due to BC updates along explicit lines, infinite time steps
        are not possible. <B>dtf</B> &lt; 1 is suggested.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">dtg</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] conductive time step wrt. CFL time
        step (since conduction terms are fully implicit, an infinite <B>dtg</B>
        is used) </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">grid0</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] initial nearest target cell size
        wrt. predicted ne and Te gradients. These are estimated based on the
        boundary conditions.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">gridexp</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] fractional size increase of cells
        in some zone away from the target. The creation of the initial grid is
        still fairly arbitrary and improved methods may be introduced at a later
        stage.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">itermax</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] maximum number of CFD iterations
        = <B>itermax</B> * ikmax, where ikmax is the number of grid points on
        the fine grid. Solution will stop after this # of iterations and return
        an error message. </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">ga1</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] adaptive grid algorithm parameter
        controlling the intensity of the imposed forcing function. With <B>ga1</B>
        = 0, the forcing function = 0.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">ga2</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] adaptive grid algorithm parameter
        specifying the (geometric) contribution of imposed boundary cell size to
        the boundary forcing function. With <B>ga2</B> = 0, the boundary
        forcing function is specified entirely based on internal criteria, with
        <B>ga2</B> = 1, entirely on boundary criteria.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">ga3</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] adaptive grid algorithm parameter
        controlling the exponential penetration of the boundary forcing function
        into the grid, which decays with exp( -<B>ga3</B>*(ik-1)).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">ga4</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] adaptive grid algorithm parameter
        specifying the (adaptive) contribution to the net forcing function. With
        <B>ga4</B> = 0, the net forcing function is specified entirely based on
        geometric criteria, with <B>ga4</B> = 1, the adaptive and geometric
        contributions are given equal weight.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">updtqpit</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] update cross-field sources
        (subroutine updateQperp) to impose Te_target &gt; Te_ctrl where Te_ctrl
        is the adjustable lower bound on Te (0 off, 1 on). Only useful for
        strongly detached cases, when recombination leads to local plasma
        condensation and cooling.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">updtqp2</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] fractional increase of the
        cross-field momentum source Qperp(2) as part of the Diagnostic Variance
        Minimization algorithm. Typically <B>updtqp2</B> ~ 0.1*<B>updtqp3</B>,
        see below. </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">updtqp3</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] fractional increase of the
        cross-field energy sources for ions and electrons Qperp(3) and Qperp(4)
        as part of the Diagnostic Variance Minimization algorithm.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">updtqpte</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] the floating target Te is allowed
        to descend below the specified Te_ctrl by the amount <B>updtqpte</B> in
        eV (typically 0.01 to 0.05). The advantage of allowing a small departure
        from Te_ctrl, is the increased speed of convergence when combined with
        <B>updtqpit</B> = 1 (see above).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">garelax</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] relaxation parameter for grid
        adaptation. Eg. with <B>garelax</B> = 0.01 the grid is updated by only
        1% with the new, adapted grid, and by 99% with the previous grid. For
        stability reasons, <B>garelax</B> &lt; 0.03.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">gaiter</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] number of iterations (*ikmax) for
        grid adaptation. Should be sufficiently long to solve the optimization
        problem, but short in respect to the convergence time of the plasma
        solver itself.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">limitte</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] limit temperature gradients (0
        off, 1 on). Useful for strongly detached conditions when recombination
        leads to a condensation phenomena. With this option, the Te gradient
        inversion (Te droping away from target) can be controlled (see <B>celldte
        </B>below)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">celldte</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] sets the limit on the decrease of
        Te away from the targets (when <B>limitte</B> = 1). The ratio of Te
        from cell to cell must be greater the <B>celldte</B> &lt; 1. Thus for
        <B>celldte</B> = 0.95, decrease in Te is limited to 5%.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">updtbcte</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] semi-implicit BC update above this
        Te value (eV). The semi-implicit BC update is only useful at higher Te,
        when the explicit updates become prohibitively expansive; otherwise, the
        extra expense and often stability concerns introduced by the
        semi-implicit algorithm are not justified. </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">updtdel0</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] the first of the three relaxation
        parameters for BC updates. The precise roles of each of these parameters
        is best seen by examining the subroutine updateBC. Briefly, <B>updtdel0</B>
        corresponds to the weight imposed on the Bohm criterion.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">updtdel1</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] the second of the three relaxation
        parameters for BC updates; <B>updtdel1</B> controls the floating update
        of target conditions as extrapolated from the two nearest inner grid
        points.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">updtdelm</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] the final relaxation parameter for
        BC updates, reduces BC updates when the solution enters the subsonic
        regime.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">qbrelax</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] relaxation parameter for initial
        phasing in of flux expanasion sources QB. It is only significant if
        problems linked to QB stability occur. In the future, QB Jacobians
        elements will be activated which should stabilize any problems caused by
        spurious QB noise.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">gridg</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] similar to <B>grid0</B>, only
        specific to Te gradients. It acts as a weight on the conductive vs.
        convective limits to near target gradients. With <B>gridg </B> = 0, the
        maximum cell size is zero. </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">grid_dx0</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] near target cell size limit which
        is imposed as the geometric constrain during grid adaptation. At the
        moment this is specified in absolute units (meters), but a more
        sophisticated, gradient based expression could be introduced later on.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">gae</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] electron heat transmission
        coefficient.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">gai</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] ion heat transmission coefficient
        (the net ion coefficient used in the code consists of <B>gai</B> + the
        convective contribution to ion energy flow ~ M<SUP>2</SUP>).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">tectrl</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] read in Tectrl from the stored
        solution (0 off, 1 on). Allows the flexibility to start of with an
        already converged solution and change the target values in the input
        file to DIVIMP.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">drflag</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] produce across-B, radial output
        for .xls file (0 off, 1 on). Useful for producing graphic output in the
        standardized form used in the author&#146;s Ph.D.thesis.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">dsflag</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] produce along-B output for .xls
        file (0 off, 1 on).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">limrel1</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] maximum relative change in the
        mass source Q(1). The relaxation coefficient for PIN sources is reduced
        appropriately to satisfy this requirement. The <B>limrel</B> parameters
        are very important for strongly detached conditions when runaway
        condensation tends to produce strong density peaking.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">limrel2</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] same as <B>limrel1</B>, but for
        momentum source.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">limrel3</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] same as <B>limrel1</B>, but for
        the ion energy source.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">limrel4</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] same as <B>limrel1</B>, but for
        the electron energy source.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">tulimit</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] minimum upstream Te in eV (when
        this Te is reached the solution will terminate on this ring). Rarely
        required, but a useful safety condition. </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">g0relax</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] relaxation of target particle
        fluxes to the Langmuir values read in from the DIVIMP input file (useful
        in conjunction with <B>tectrl</B> = 1). </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">p0relax</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] relaxation of target power fluxes
        to the Langmuir values read in from the DIVIMP input file (useful in
        conjunction with <B>tectrl</B> = 1).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">dpdrflag</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] impose radially decaying power
        gradient (0 off, 1 on). The other requirement is that Te &gt; <B>dpdrtemin.
        </B>This may serve as a physical constraint, since radially decaying
        power gradients are observed almost universally in SOL plasmas.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">dpdrtemin</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] temperature limit when <B>dpdrflag
        = </B>1 (see above).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">dpdrstep</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] fractional step for adjusting the
        ion and electron input powers Qperp(3) and Qperp(4) when <B>dpdrflag =
        </B>1 (see above).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">nuflag</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] constrain upstream density to
        <B>nulimit</B> (see below) via adjustment of Te_ctrl (0 off, 1 on).
        Only relevant for strongly detached conditions when the target values
        are not sufficient to fully constrain the plasma solution. </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">nulimit</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] the desnity limit for <B>nuflag</B>
        (see above). Te_ctrl is increased when nu &gt; nu_limit, such that the
        recombination rate and the density peak tend to be reduced (stabilizing
        the runaway condensation).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">vnmult</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] ratio of neutral velocity to
        plasma velocity; used when <B>pinmom</B> = 0 (see below) to specify the
        amount of momentum removed per charge-exchange collision. Eg. for <B>vnmult</B>
        = 0.0, all of the ion momenum is removed, while for <B>vnmult</B> = 0.5
        only half.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">pinmom</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] momentum exchange option (0 =
        based on charge exchange estiamte Qcx, 1 = directly from PIN)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">emolec</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] birth energy of Frank-Condon
        neutrals (eV)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">rec_heat</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] energy deposited in the plasma per
        recombination event (eV)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">pinqimult</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] multiplier of the ion energy
        source returned from PIN; the flexibility of excluding the ion energy
        source was important for achieving arbitrarily strong detachment and for
        comparison with EDGE2D which excludes ion heating as a default.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">pinqiflag</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] ion energy source option (0 =
        from ionization, recombination, charge exchange sources, Qiz, Qrec, Qcx;
        1 = directly from PIN)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">prring0</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] first ring for specific file
        (.xls) output </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">prring1</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] ring step for specific file
        (.xls) output</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">qperp34</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] cross-field energy source,
        Qperp(3) and Qperp(4), dependence on plasma variables, U(s) (0 ~ const;
        1 ~ pe(s) + pi(s); 2 ~ B(s)); in all cases, the sources are zero below
        the X-point.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">qeiflag</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] e-i equipartition or energy
        exchange (0 off, 1 on)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">chie</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] electron conductivity flux limit
        (0 off, 1 on, 2 on + scaled to Brag.); flux limits constitute
        corrections for non-Maxwellian effects in regions of weak
        collisionality. Various levels of sophistication are possible, but the
        simple expression used here represents a fairly accurate correction to
        the conductive and viscous fluxes.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">joule</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] u*grad(p) or Joule heating source
        (0 off, 1 on); this term appears in the fluid equations due to the
        presence of parallel electric fields and acts as an extra e-i energy
        transfer term (the near target E|| transfers energy from the electrons
        to the ions). It is largest in the immediate vicinity of the target.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">fluxexp</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] flux expansion source QB (0 off,
        1 on); the nature of the flux expansion terms resides in the adiabatic
        conservation of the magnetic moments (flux) through a flux tube. In the
        present form, these sources have been derived along with the plasma
        fluid equations. Note that they are implicit in the Braginskii equations
        as well since these are cast in the general tensor form, and have to be
        projected unto magnetic coordinates.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">Qrec</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] recombination source (0 off, 1
        on); important below ~ 1eV. <BR>
         Volumetric recombination is a key mechanism in the phenomenon of plasma
        condensation or rapid density peak growth in strong detachment. </TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">fzrad</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] ratio of impurity radiation to
        hydrogen radiation, Qz = fzrad * Qe; impurity radiation affects the
        energy balance in all experimental edge plasmas; the correction addapted
        here is once of the simplest possible, assuming that impurity radiation
        is distributed in the same way as the hydrogenic radiation and is a
        constant fraction thereof. In the future, coupling with DIVIMP will
        provide a better estimate of Qz.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">dvmrel</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] selects sets of Diagnostic
        Variance Minimization (DVM) relaxation parameters which are used to
        adjust the cross-field sources Qperp in order to match the imposed (for
        now only target) conditions. There are three relaxation parameters a1,
        a2, and a3, which correspond to mass, momentum and energy sources.<BR>
         dvmrel = 0: a1=a2=a3=0.0<BR>
         dvmrel = 1: a1=0.0, a2=0.1, a3=0.3<BR>
         dvmrel = 2: a1=0.0, a2=0.03, a3=0.1<BR>
         dvmrel = 3: a1=0.0, a2=0.01, a3=0.03<BR>
         dvmrel = 4: a1=0.0, a2=0.1, a3=min(0.1,Tet/Teu)<BR>
         dvmrel = 5: a1=0.0, a2=a3=min(0.1,Tet/Teu)<BR>
         dvmrel = 6: a1=0.0, a2=a3=0.3*min(0.1,Tet/Teu)<BR>
         dvmrel = 7: a1=0.0, a2=0.1, a3=0.3*min(0.1,Tet/Teu)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">intopt</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] integration option (0 const, 1
        linear); used in all integration routines along the flux tube.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">adaptgrid</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] grid adaptation (0 off, 1 on, 2
        on from irsep to irsep + adaptnr); the grid is adapted to minimise the
        relative change in plasma variable from cell to cell.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">seed</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] ionization options for the
        initial (seed) plasma (1 exponential, 2 gaussian with an offset)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">izlen</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] ionization length for seed plasma
        (as a fraction of connection length)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">izoffset</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] ionization offset for seed
        gaussian plasma (as a fraction of connection length)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">momlen</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] momentum length for seed plasma
        (as a fraction of connection length)</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">relax</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] maximum source relaxtion
        coefficient; the actual relaxation coefficients are determined by the
        added requirement that the relative change in the sources should be
        smaller than the specified limits (see <B>limrel1-4</B>). However in
        the absence of strong changes, <B>relax</B> determines both the
        convergence and stability of PIN relaxation. For attached cases, higher
        values (eg. <B>relax </B>~ 0.1) may be used to speed up convergence
        wrt. PIN sources.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">maxtol</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] maximum residual tolerance; key
        parameter for CFD convergence. In the initial stages a relatively high
        value may be addapted in order to save time (eg. 0.01) which can then be
        lowered in the final series of iterations (eg. to 0.001 or 0.0001).</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">rmstol</TD>
        <TD WIDTH="85%" HEIGHT="19">[real*8] root-mean-square residual
        tolerance; usually chosen as 0.1*<B>maxtol</B>.</TD>
      </TR>
      <TR>
        <TD WIDTH="15%" HEIGHT="19">perp</TD>
        <TD WIDTH="85%" HEIGHT="19">[integer] main Diagnostic Variance
        Minimization (DVM) option; selects set of scalings of cross-field mass
        Qperp(1) and momentum Qperp(2) sources with plasma variables.<BR>
        perp=0: Qperp(1) ~ 1, Qperp(2) ~ U(2)<BR>
        perp=1: Qperp(1) ~ U(1), Qperp(2) ~ U(2)<BR>
        perp=2: Qperp(1) ~ U(1), Qperp(2) ~ 1<BR>
        perp=3: Qperp(1) ~ U(1)^(1/2), Qperp(2) ~ U(2)<BR>
        perp=4: Qperp(1) ~ U(1), Qperp(2) ~ U(2)^(1/2)</TD>
      </TR>
    </TABLE>
    
    <P>&nbsp</P>
    <P>&nbsp</P>
    <P>&nbsp</P>
    

    <H1 ALIGN="CENTER">Default Setting for a Typical Case (extracted from wfdefault.d6i):</H1>

<PRE>    
    
$
$   SOL 23 - Input parameters (s23_par_...)
$
'+301 SOL23  ptipte ................................      '    1.0
'+302 SOL23  adaptnr                                      '     2
'+303 SOL23  debugflag                                    '     0
'+304 SOL23  debugnr                                      '     0
'+305 SOL23  refresh                                      '    100
'+306 SOL23  artvisc2 ..............................      '    0.3
'+307 SOL23  artvisc4                                     '    0.01
'+308 SOL23  dtf                                          '    0.5
'+309 SOL23  dtg                                          '   1.0E24
'+310 SOL23  grid0                                        '    0.1
'+311 SOL23  gridexp ................................     '    1.25
'+312 SOL23  itermax                                      '    1000
'+313 SOL23  ga1                                          '    10.0
'+314 SOL23  ga2                                          '    0.01
'+315 SOL23  ga3                                          '    0.2
'+316 SOL23  ga4   .................................      '    10.0
'+317 SOL23  updtqpit                                     '     0
'+318 SOL23  updtqp2                                      '    0.003
'+319 SOL23  updtqp3                                      '    0.03
'+320 SOL23  updtqpte                                     '    0.01
'+321 SOL23  garelax ................................     '    0.03
'+322 SOL23  gaiter                                       '     1
'+323 SOL23  limitte                                      '     1
'+324 SOL23  celldte                                      '    0.95
'+325 SOL23  updtbcte                                     '    30.0
'+326 SOL23  updtdel0 ..............................      '    1.0
'+327 SOL23  updtdel1                                     '    1.0
'+328 SOL23  updtdelm                                     '    0.1
'+329 SOL23  qbrelax                                      '    0.02
'+330 SOL23  gridg                                        '    0.03
'+331 SOL23  grid_dx0 ...............................     '    0.001
'+332 SOL23  gae                                          '    5.0
'+333 SOL23  gai                                          '    2.5
'+334 SOL23  tectrl                                       '     1
'+335 SOL23  drflag                                       '     0
'+336 SOL23  dsflag  ................................     '     0
'+337 SOL23  limrel1                                      '    0.03
'+338 SOL23  limrel2                                      '    0.1
'+339 SOL23  limrel3                                      '    0.03
'+340 SOL23  limrel4                                      '    0.03
'+341 SOL23  tulimit  ...............................     '    5.0
'+342 SOL23  g0relax                                      '    0.1
'+343 SOL23  p0relax                                      '    0.02
'+344 SOL23  dpdrflag                                     '     0
'+345 SOL23  dpdrtemin                                    '    1.0
'+346 SOL23  dpdrstep  ..............................     '    0.1
'+347 SOL23  nuflag                                       '     0
'+348 SOL23  nulimit                                      '   1.0E20
'+349 SOL23  vnmult                                       '    1.0
'+350 SOL23  pinmom                                       '     0
'+351 SOL23  emolec                                       '    3.0
'+352 SOL23  rec_heat  ...............................    '    13.6
'+353 SOL23  pinqimult                                    '    1.0
'+354 SOL23  pinqiflag                                    '     0
'+355 SOL23  prring0                                      '     7
'+356 SOL23  prring1                                      '     3
'+357 SOL23  qperp34 .................................    '     0
'+358 SOL23  qeiflag                                      '     1
'+359 SOL23  chie                                         '     1
'+360 SOL23  joule                                        '     1
'+361 SOL23  fluxexp                                      '     1
'+362 SOL23  qrec    ..................................   '     1
'+363 SOL23  fzrad                                        '    1.0
'+364 SOL23  dvmrel                                       '     2
'+365 SOL23  intopt                                       '     1
'+366 SOL23  adaptgrid                                    '     0
'+367 SOL23  seed                                         '     1
'+368 SOL23  izlen   ..................................   '    0.5
'+369 SOL23  izlam                                        '    0.03
'+370 SOL23  izoffset                                     '    0.03
'+371 SOL23  momlen                                       '    0.1
'+372 SOL23  relax                                        '    0.01
'+373 SOL23  maxtol                                       '    3.0E-3
'+374 SOL23  rmstol  .................................    '    3.0E-4
'+375 SOL23  Qperp                                        '    1


</pre>    

  </BODY>
</HTML>
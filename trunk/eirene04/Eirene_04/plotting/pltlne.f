C
C
      SUBROUTINE PLTLNE(NRET,XX,YY,XMI2D,XMA2D,YMI2D,YMA2D,LSTORE)

      USE PRECISION

      IMPLICIT NONE

      REAL(DP), INTENT(INOUT) :: XX(*), YY(*)
      REAL(DP), INTENT(IN) :: XMI2D, XMA2D, YMI2D, YMA2D
      INTEGER, INTENT(IN) :: NRET
      LOGICAL, INTENT(IN) :: LSTORE
      REAL(DP) :: XT, YT, XTN, YTN, XT2, YT2, TESTN
      INTEGER :: IN, IFL, I
c
      DO 148 I=1,NRET
        IFL=I-1
        XTN=XX(I)
        YTN=YY(I)
        CALL TSTCHM(IFL,XTN,YTN,XT,YT,IN,TESTN,
     .              XMI2D,XMA2D,YMI2D,YMA2D,XT2,YT2)
C
        IF (IN.EQ.0) IN=4
        GOTO (1481,1482,1483,1484,14852),IN
1481      CONTINUE
            CALL GRDRW (REAL(XTN,KIND(1.E0)),REAL(YTN,KIND(1.E0)))
            IF (LSTORE) CALL STCOOR(XTN,YTN,1)
            GOTO 1485
1482      CONTINUE
            CALL GRDRW(REAL(XT,KIND(1.E0)),REAL(YT,KIND(1.E0)))
            CALL GRJMP(REAL(XTN,KIND(1.E0)),REAL(YTN,KIND(1.E0)))
            IF (LSTORE) THEN
              CALL STCOOR(XT,YT,0)
              CALL STCOOR(XTN,YTN,1)
            END IF
            GOTO 1485
1483      CONTINUE
            CALL GRJMP(REAL(XT,KIND(1.E0)),REAL(YT,KIND(1.E0)))
            CALL GRDRW(REAL(XTN,KIND(1.E0)),REAL(YTN,KIND(1.E0)))
            IF (LSTORE) THEN
              CALL STCOOR(XT,YT,0)
              CALL STCOOR(XTN,YTN,1)
            END IF
            GOTO 1485
1484      CONTINUE
            CALL GRJMP(REAL(XTN,KIND(1.E0)),REAL(YTN,KIND(1.E0)))
            IF (LSTORE) CALL STCOOR(XTN,YTN,0)
            GOTO 1485
14852     CONTINUE
            CALL GRJMP(REAL(XT,KIND(1.E0)),REAL(YT,KIND(1.E0)))
            CALL GRDRW(REAL(XT2,KIND(1.E0)),REAL(YT2,KIND(1.E0)))
            IF (LSTORE) THEN
              CALL STCOOR(XT,YT,0)
              CALL STCOOR(XT2,YT2,1)
            END IF
            GOTO 1485
1485    CONTINUE
C
148   CONTINUE
      return
      end

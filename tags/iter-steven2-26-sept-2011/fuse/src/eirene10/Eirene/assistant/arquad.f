C
C
      FUNCTION ARQUAD(X1,Y1,X2,Y2,X3,Y3,X4,Y4)
C
C  THIS FUNCTION EVALUATES THE AREA OF A QUADRANGLE GIVEN BY
C  THE COORDINATES (X1,Y1), (X2,Y2), (X3,Y3) AND (X4,Y4)
C  THIS SUBROUTINE IN A REDUCED FORM OF SUBR. APOLYG (FORMERLY: POLYGM)
C
C  AREA OF CELLS
C
      USE PRECISION
      IMPLICIT NONE
      REAL(DP), INTENT(IN) :: X1, Y1, X2, Y2, X3, Y3, X4, Y4
      REAL(DP) :: A1, B1, C1, A2, B2, C2, RHO1, RHO2, AREAD1, AREAD2,
     .          ARQUAD

      A1=SQRT((X1-X4)**2+(Y1-Y4)**2)
      B1=SQRT((X3-X4)**2+(Y3-Y4)**2)
      C1=SQRT((X1-X3)**2+(Y1-Y3)**2)
      RHO1=0.5*(A1+B1+C1)
      A2=SQRT((X1-X2)**2+(Y1-Y2)**2)
      B2=SQRT((X3-X2)**2+(Y3-Y2)**2)
      C2=C1
      RHO2=0.5*(A2+B2+C2)
      AREAD1=SQRT(MAX(0._DP,RHO1*(RHO1-A1)*(RHO1-B1)*(RHO1-C1)))
      AREAD2=SQRT(MAX(0._DP,RHO2*(RHO2-A2)*(RHO2-B2)*(RHO2-C2)))
      ARQUAD=AREAD1+AREAD2
      RETURN
      END

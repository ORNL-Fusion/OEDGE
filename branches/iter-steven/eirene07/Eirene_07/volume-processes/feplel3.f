!pb  22.11.06: flag for shift of first parameter to rate_coeff introduced


      FUNCTION FEPLEL3 (IREL,K)

      USE PRECISION
      USE PARMMOD
      USE COMUSR
      USE CCONA
      USE COMPRT
      USE COMXS

      IMPLICIT NONE

      INTEGER, INTENT(IN) :: IREL, K
      REAL(DP) :: PLS, ADD, EPEL, FEPLEL3, RATE_COEFF
      INTEGER :: II, KK, IPLSTI

      FEPLEL3=0.D0
      KK=NELREL(IREL)
      IPLSTI=MPLSTI(IPLS)
      IF (KK < 0) THEN
        SELECT CASE (KK)
        CASE (-1)
C  DEFAULT EL MODEL
C  OUT
        CASE (-2)
C  MEAN ENERGY FROM DRIFTING MONOENERGETIC
            FEPLEL3=EPLEL3(IREL,1,1)+EDRIFT(IPLS,K)
        CASE (-3)
C  MEAN ENERGY FROM DRIFTING MAXWELLIAN
            FEPLEL3=1.5*TIIN(IPLSTI,K)+EDRIFT(IPLS,K)
        END SELECT
      ELSE
C  MEAN ENERGY FROM SINGLE PARAMETER FIT KK
        PLS=TIINL(IPLSTI,K)+ADDEL(IREL,IPLS)
        EPEL = RATE_COEFF(KK,PLS,0._DP,.FALSE.,0)
        ADD=EPLEL3(IREL,1,1)
        FEPLEL3=EPEL*DIIN(IPLS,K)*ADD
      END IF

      RETURN
      END

<!DOCTYPE HTML PUBLIC "-//SoftQuad//DTD HoTMetaL PRO 4.0::19971010::extensions to HTML 4.0//EN"
 "hmpro4.dtd">

<HTML>
  
  <HEAD>
    <TITLE>DIVIMP Reference Manual</TITLE>
<!-- Changed by: David Elder, 18-Mar-1999 -->
    <META NAME="Description" CONTENT="">
    <META HTTP-EQUIV="Description" CONTENT="">


<!--    <LINK REL=STYLESHEET TYPE="text/css" HREF="divdocs.css" TITLE="Style"> -->

    <STYLE TYPE="text/css">

        BODY { color:black; 
               background:white }

        A:link  { color:blue; 
                  text-decoration: none;
                  font-weight:normal}
                  
        A:active { color:green; 
                   text-decoration: none;
                   font-weight:bold}
                   
        A:visited{ color:red; 
                   text-decoration: none;
                   font-weight:normal}`
                   
	
	H1 { font-weight:bold;
             font-style:italic; 
             text-align:center;
             color:red }

	H2 { font-weight:bold;
             color:green}
	
	H3 { font-weight:bold;
	     color:crimson}
               

	.c1 { color:green;
	      font-weight:bold}

        .c2 { color:green;
              font-weight:bold;
              font-size:larger;
              font-style:italic; 
              text-align:center
              }


    </STYLE>


  </HEAD>

  <BODY>
  
    <P></P>
    <CENTER><B><FONT SIZE="5">DIVIMP Reference Manual</FONT></B></CENTER>
    
    <P></P>
    <CENTER>Version 6.10</CENTER>
    
    <P></P>
    
    <P></P>
    
    <P></P>
    <CENTER>J.D. Elder and P.C. Stangeby</CENTER>
    
    <P></P>
    <CENTER>University of Toronto</CENTER>
    
    <P></P>
    <CENTER>Institute for Aerospace Studies</CENTER>
    
    <P></P>
    <CENTER>4925 Dufferin St.,</CENTER>
    
    <P></P>
    <CENTER>Downsview, Ontario</CENTER>
    
    <P></P>
    <CENTER>CANADA</CENTER>
    
    <P></P>
    <CENTER>M3H 5T6</CENTER>
    
    <P></P>
    <CENTER>June 12, 2000</CENTER>
    



    <P>&nbsp;</P>
    <P>&nbsp;</P>
    <P>&nbsp;</P>
    <P>&nbsp;</P>
    <P>&nbsp;</P>
    
    
    <P><H2>DIVIMP REFERENCE MANUAL</H2></P>
    
    <DIV ID=toc> 
    
    <P><B><FONT SIZE="4">Table of Contents</FONT></B></P>
        
    <pre> 
    <A HREF="#title"><FONT CLASS=c1>A01</FONT> TITLE</A>
    <A HREF="#a02"><FONT CLASS=c1>A02</FONT> Case Description</A>    
    <A HREF="#grid"><FONT CLASS=c1>A03</FONT> EQUILIBRIUM GRID FILE NAME</A>    

    <a HREF="#opts">OPTIONS</a>

    <A HREF="#gridop"><FONT CLASS=c1>G01</FONT> GRID OPTION</A>    
    <A HREF="#orthop"><FONT CLASS=c1>G02</FONT> NON-ORTHOGONAL OPTION</A>    
    <A HREF="#pdopt"><FONT CLASS=c1>G03</FONT> PARALLEL DISTANCE OPTION</A>    
    <A HREF="#cfdist"><FONT CLASS=c1>G04</FONT> CROSS-FIELD DISTANCE OPTION</A>    
    <A HREF="#rzcalc"><FONT CLASS=c1>G05</FONT> R,Z CALCULATION OPTION</A>    
    <A HREF="#xygrid"><FONT CLASS=c1>G06</FONT> XY GRID OPTION</A>    
    <A HREF="#area"><FONT CLASS=c1>G07</FONT> CELL AREA CALCULATION OPTION</A>    
    <A HREF="#bfield"><FONT CLASS=c1>S01</FONT> ON AXIS B-FIELD VALUE</A>    
    <A HREF="#izdata"><FONT CLASS=c1>D01</FONT> IONIZATION DATA SOURCE OPTION</A>    
    <A HREF="#huser"><FONT CLASS=c1>D02</FONT> SOURCE DATA OPTION SPECIFICATIONS - USERID FOR H DATABASE</A>    
    <A HREF="#hyear"><FONT CLASS=c1>D03</FONT> SOURCE DATA OPTION SPECIFICATIONS - H DATA YEAR</A>    
    <A HREF="#zuser"><FONT CLASS=c1>D04</FONT> SOURCE DATA OPTION SPECIFICATIONS - USERID FOR Z (IMPURITY) DATABASE</A>    
    <A HREF="#zyear"><FONT CLASS=c1>D05</FONT> SOURCE DATA OPTION SPECIFICATIONS - Z (IMPURITY) DATA YEAR</A>    
    <A HREF="#frates"><FONT CLASS=c1>D06</FONT> ATOMIC DATA SOURCE FILE NAME (Adpak, Strahl ...)</A>    
    <A HREF="#izopt"><FONT CLASS=c1>T01</FONT> IONIZATION</A>    
    <A HREF="#coll"><FONT CLASS=c1>T02</FONT> COLLISION</A>
    <A HREF="#t03"><FONT CLASS=c1>T03</FONT> REISER COULOMB COLLISION TRANSPORT OPTION</A>
    <A HREF="#fric"><FONT CLASS=c1>T04</FONT> FRICTION</A>    
    <A HREF="#heat"><FONT CLASS=c1>T05</FONT> HEATING</A>    
    <A HREF="#inj"><FONT CLASS=c1>I01</FONT> INJECTION</A>    
    <A HREF="#sol"><FONT CLASS=c1>P01</FONT> SOL</A>    
    <A HREF="#corepl"><FONT CLASS=c1>P02</FONT> CORE PLASMA OPTIONS</A>    
    <A HREF="#plasma"><FONT CLASS=c1>P03</FONT> PLASMA DECAY</A>    
    <A HREF="#pwbg"><FONT CLASS=c1>P04</FONT> PIECE-WISE BACKGROUND PLASMA OPTION INPUTS</A>    
    <A HREF="#e2dbg"><FONT CLASS=c1>F01</FONT> READ FLUID CODE BACKGROUND FOR REFERENCE</A>    
    <A HREF="#e2dtar"><FONT CLASS=c1>F02</FONT> FLUID CODE TARGET DATA USAGE OPTION</A>    
    <A HREF="#cxrec"><FONT CLASS=c1>T06</FONT> CX RECOMB</A>    
    <A HREF="#fdiff"><FONT CLASS=c1>I02</FONT> FIRST DIFFUSION</A>    
    <A HREF="#dpopt"><FONT CLASS=c1>T07</FONT> DPERP OPTION</A>    
    <A HREF="#perpst"><FONT CLASS=c1>T08</FONT> PERPENDICULAR STEP OPTION</A>    
    <A HREF="#pinch"><FONT CLASS=c1>T09</FONT> PINCH VELOCITY OPTION</A>    
    <A HREF="#tegrad"><FONT CLASS=c1>Q01</FONT> TEB GRADIENT OPTION</A>    
    <A HREF="#tigrad"><FONT CLASS=c1>Q02</FONT> TIB GRADIENT OPTION</A>    
    <A HREF="#tegcoe"><FONT CLASS=c1>T10</FONT> TEB GRAD COEFF OPTION</A>    
    <A HREF="#tigcof"><FONT CLASS=c1>T11</FONT> TIB GRAD COEFF OPTION</A>    
    <A HREF="#flattg"><FONT CLASS=c1>Q03</FONT> FORCED FLAT TEMPERATURE GRADIENT OPTION</A>    
    <A HREF="#tegfcu"><FONT CLASS=c1>Q04</FONT> TE GRADIENT CUT-OFF FOR FLATTENING OPTION</A>    
    <A HREF="#tigfcu"><FONT CLASS=c1>Q05</FONT> TI GRADIENT CUT-OFF FOR FLATTENING OPTION</A>    
    <A HREF="#tgfmod"><FONT CLASS=c1>T12</FONT> TEMPERATURE GRADIENT FORCE - MODIFICATION OPTION</A>    
    <A HREF="#traptg"><FONT CLASS=c1>P05</FONT> TRAP TGRAD OPTION</A>    
    <A HREF="#contsw"><FONT CLASS=c1>I03</FONT> CONTROL SWITCH</A>    
    <A HREF="#launch"><FONT CLASS=c1>N01</FONT> LAUNCH</A>    
    <A HREF="#vaflag"><FONT CLASS=c1>N02</FONT> VEL/ANGLE FLAG</A>    
    <A HREF="#suplau"><FONT CLASS=c1>N03</FONT> SUPPLEMENTARY LAUNCH OPTION</A>    
    <A HREF="#supva"><FONT CLASS=c1>N04</FONT> SUPPLEMENTARY VELOCITY/ANGLE FLAG</A>    
    <A HREF="#initva"><FONT CLASS=c1>N05</FONT> INITIAL NEUTRAL VELOCITY/ANGLE FLAG</A>    
    <A HREF="#extra2d"><FONT CLASS=c1>N06</FONT> EXTRA 2D NEUTRAL LAUNCH OPTION</A>    
    <A HREF="#2dva"><FONT CLASS=c1>N07</FONT> 2D NEUTRAL LAUNCH - VELOCITY/ANGLE FLAG OPTION</A>    
    <A HREF="#physpd"><FONT CLASS=c1>D07</FONT> PHYSICAL SPUTTER DATA - SOURCE OPTION</A>    
    <A HREF="#chspd"><FONT CLASS=c1>D08</FONT> CHEMICAL SPUTTER YIELD OPTION</A>    
    <A HREF="#sput"><FONT CLASS=c1>N08</FONT> SPUTTER OPTION</A>    
    <A HREF="#secspu"><FONT CLASS=c1>N09</FONT> SECONDARY SPUTTER OPTION (TN1209)</A>    
    <A HREF="#selfsp"><FONT CLASS=c1>I04</FONT> SELF SPUTTERING OPTION</A>    
    <A HREF="#normal"><FONT CLASS=c1>N10</FONT> NORMAL</A>    
    <A HREF="#neutsp"><FONT CLASS=c1>N11</FONT> NEUT SPREADING</A>    
    <A HREF="#inionv"><FONT CLASS=c1>I05</FONT> INITIAL ION VELOCITY OPTION</A>    
    <A HREF="#ionwal"><FONT CLASS=c1>G08</FONT> ION WALL OPTION</A>    
    <A HREF="#neutwa"><FONT CLASS=c1>G09</FONT> NEUTRAL WALL OPTION</A>    
    <A HREF="#trapwa"><FONT CLASS=c1>G10</FONT> TRAP WALL OPTION</A>
    <A HREF="#vesdef"><FONT CLASS=c1>G11</FONT> VESSEL WALL RE_DEFINITION OPTION (Baffle Inclusion)</A>
    <A HREF="#impvty"><FONT CLASS=c1>N12</FONT> IMPURITY NEUTRAL VELOCITY TYPE OPTION</A>    
    <A HREF="#neuref"><FONT CLASS=c1>N13</FONT> NEUTRAL REFLECTION OPTION</A>    
    <A HREF="#folrec"><FONT CLASS=c1>I06</FONT> FOLLOW RECOMBINED IMPURITY NEUTRAL OPTION</A>    
    <A HREF="#mtcopt"><FONT CLASS=c1>N14</FONT> IMPURITY NEUTRAL MOMENTUM TRANSFER COLLISION OPTION</A>    
    <A HREF="#mtc1"><FONT CLASS=c1>D09</FONT> MOMENTUM TRANSFER COLLISION - FIRST COEFFICIENT (KELIGHI)</A>    
    <A HREF="#mtc2"><FONT CLASS=c1>D10</FONT> MOMENTUM TRANSFER COLLISION - SECOND COEFFICIENT (KELIGHG)</A>    
    <A HREF="#prodep"><FONT CLASS=c1>I07</FONT> PROMPT DEPOSITION OPTION</A>    
    <A HREF="#tarpos"><FONT CLASS=c1>G12</FONT> TARGET POSITION OPTION</A>    
    <A HREF="#tarmir"><FONT CLASS=c1>I08</FONT> TARGET MIRROR OPTION</A>    
    <A HREF="#oldgeo"><FONT CLASS=c1>G13</FONT> PRE-DEFINED GEOMETRY SELECTION OPTION</A>    
    <A HREF="#periph"><FONT CLASS=c1>I09</FONT> ION PERIPHERY OPTION</A>    
    <A HREF="#perrec"><FONT CLASS=c1>I10</FONT> PERIPHERY RECYCLE OPTION</A>    
    <A HREF="#poldrf"><FONT CLASS=c1>T13</FONT> POLOIDAL DRIFT OPTION</A>    
    <A HREF="#rspec"><FONT CLASS=c1>B01</FONT> SPECIAL PLASMA PARAMETER - RSPEC</A>    
    <A HREF="#ircore"><FONT CLASS=c1>G14</FONT> RING LOCATION OF CORE MIRROR - IRCORE</A>    
    <A HREF="#mb"><FONT CLASS=c1>S02</FONT> MASS OF PLASMA IONS - MB</A>    
    <A HREF="#zb"><FONT CLASS=c1>S03</FONT> CHARGE ON PLASMA IONS - ZB</A>    
    <A HREF="#temps"><FONT CLASS=c1>Q06..Q11,Q16..Q21</FONT> TEMPERATURES - TEB0,TEBP,TEBOUT,TEBIN,TEBT,TIB0,TIBP,TIBOUT,TIBIN,TIBT</A>    
    <A HREF="#grads"><FONT CLASS=c1>Q12..Q15,Q22..Q25</FONT> GRADIENT PARAMETERS - FEBL1,FEBL2,FEBT,FEB2,FIBL1,FIBL2,FIBT,FIB2</A>    
    <A HREF="#dens"><FONT CLASS=c1>Q26..Q31</FONT> DENSITIES - NB0,NEBP,NBOUT,NBIN,NBT,NBOUP</A>    
    <A HREF="#langsw"><FONT CLASS=c1>Q32</FONT> LANGMUIR PROBE DATA SWITCH</A>    
    <A HREF="#prmuli"><FONT CLASS=c1>Q33</FONT> INNER/BOTH TARGET DATA MULTIPLIERS</A>    
    <A HREF="#probei"><FONT CLASS=c1>Q34</FONT> LANGMUIR PROBE DATA INPUT - INNER/BOTH PLATE</A>    
    <A HREF="#prmulo"><FONT CLASS=c1>Q35</FONT> OUTER TARGET DATA MULTIPLIERS</A>    
    <A HREF="#probeo"><FONT CLASS=c1>Q36</FONT> LANGMUIR PROBE DATA INPUT - OUTER PLATE</A>    
    <A HREF="#cordat"><FONT CLASS=c1>Q37</FONT> CORE PLASMA INPUT DATA</A>    
    <A HREF="#dperpv"><FONT CLASS=c1>T14</FONT> CROSS-FIELD DIFFUSION RATE - DPERP (M*M/S)</A>    
    <A HREF="#dperpp"><FONT CLASS=c1>T15</FONT> CROSS-FIELD DIFFUSION RATE FOR PRIVATE PLASMA REGION - DPERPT (M*M/S)</A>    
    <A HREF="#vpinch"><FONT CLASS=c1>T16</FONT> PERPENDICULAR PINCH VELOCITY - CVPINCH (M/S)</A>    
    <A HREF="#mi"><FONT CLASS=c1>S04</FONT> MASS OF IMPURITY IONS - MI</A>    
    <A HREF="#zi"><FONT CLASS=c1>S05</FONT> ATOMIC NUMBER OF IMPURITY IONS - ZI</A>    
    <A HREF="#ebd"><FONT CLASS=c1>D11</FONT> CHARACTERISTIC ENERGY EBD (EV)</A>    
    <A HREF="#zeff"><FONT CLASS=c1>I11</FONT> Z EFFECTIVE (SELF) - ZEFF</A>    
    <A HREF="#tem1"><FONT CLASS=c1>S06</FONT> INITIAL TEMPERATURE - TEM1 (EV)</A>    
    <A HREF="#tem2"><FONT CLASS=c1>S07 </FONT>INITIAL TEMPERATURE (2) - TEM2 (EV)</A>    
    <A HREF="#initrz"><FONT CLASS=c1>S08,S09</FONT> INITIAL R,Z POSITION OF IMPURITY</A>    
    <A HREF="#initiz"><FONT CLASS=c1>I12</FONT> INITIAL IONIZATION STATE OF IMPURITY IONS</A>    
    <A HREF="#nhc"><FONT CLASS=c1>D12</FONT> NEUTRAL HYDROGEN DENSITY PARAMETER - NHC (M**-3)</A>    
    <A HREF="#nho"><FONT CLASS=c1>D13</FONT> NHO (M**-3)</A>    
    <A HREF="#lamhx"><FONT CLASS=c1>D14</FONT> LAMHX (M)</A>    
    <A HREF="#lamhy"><FONT CLASS=c1>D15</FONT> LAMHY (M)</A>    
    <A HREF="#vcx"><FONT CLASS=c1>D16</FONT> CONSTANT FOR CX RECOMB OPTION 2 - VCX (M/S)</A>    
    <A HREF="#near"><FONT CLASS=c1>B02..B03</FONT> FOR AVERAGE DENSITY &amp;QUOT;NEAR&amp;QUOT; TARGET XNEAR,YNEAR</A>    
    <A HREF="#theta"><FONT CLASS=c1>N15</FONT> MEASURE THETA FROM T DEGREES FOR LAUNCH</A>    
    <A HREF="#vhyin"><FONT CLASS=c1>Q38</FONT> INBOARD PLASMA FLOW VELOCITY - NOT SUPPORTED - VHYIN (M/S)</A>    
    <A HREF="#eyin"><FONT CLASS=c1>Q39</FONT> INBOARD ELECTRIC FIELD - NOT SUPPORTED - EYIN (V/M)</A>    
    <A HREF="#vhyout"><FONT CLASS=c1>Q40</FONT> OUTBOARD PLASMA FLOW VEL (SOL 5,6 &amp;AMP; 7) - VHYOUT(M/S)</A>    
    <A HREF="#eyout"><FONT CLASS=c1>Q41</FONT> OUTBOARD ELECTRIC FIELD (SOL 5,6 &amp;AMP; 7) - EYOUT (V/M)</A>    
    <A HREF="#zenh"><FONT CLASS=c1>I13</FONT> COLLISION ENHANCEMENT FACTOR - ZENH</A>    
    <A HREF="#setti"><FONT CLASS=c1>I14</FONT> SET TI = MAX(TI,TB) WHEN REACHING STATE (0 OFF)</A>    
    <A HREF="#thresh"><FONT CLASS=c1>D17</FONT> THRESHOLD YIELD FOR SELF-SPUTTERING (EV)</A>    
    <A HREF="#zimp"><FONT CLASS=c1>D18</FONT> BOMBARDING ION CHARGE STATE - ZIMP</A>    
    <A HREF="#bombi"><FONT CLASS=c1>D19</FONT> BOMBION (0-MB 1-H 2-D 3-T 4-HE4 5-C 6-MI 7-O)</A>    
    <A HREF="#irf"><FONT CLASS=c1>D20</FONT> IONIZATION RATE FACTOR FOR NEUTRALS - IRF</A>    
    <A HREF="#sef"><FONT CLASS=c1>D21</FONT> SPUTTERING ENHANCEMENT FACTOR - SEF</A>    
    <A HREF="#solef"><FONT CLASS=c1>P06</FONT> SOL ENHANCEMENT FACTOR - ELECTRIC FIELD - SOLEF</A>    
    <A HREF="#solvf"><FONT CLASS=c1>P07</FONT> SOL ENHANCEMENT FACTOR - DRIFT VELOCITY - SOLVF</A>    
    <A HREF="#solprm"><FONT CLASS=c1>P08..P14</FONT> SOL PARAMETERS - FL,FS,FRM,KIN,KOUT,FRMIN,FRMAX</A>    
    <A HREF="#sol67"><FONT CLASS=c1>P15..P18</FONT> SOL PARAMETERS FOR SOL OPTIONS 6 AND 7.</A>    
    <A HREF="#mode"><FONT CLASS=c1>S10</FONT> DIVIMP MODE (1 IMPULSE, 2 STEADY STATE, 0 BOTH)</A>    
    <A HREF="#maxiz"><FONT CLASS=c1>I15</FONT> MAXIMUM IONIZATION STATE</A>    
    <A HREF="#num"><FONT CLASS=c1>S11</FONT> NUMBER OF IMPURITY IONS TO BE FOLLOWED</A>    
    <A HREF="#numsup"><FONT CLASS=c1>S12</FONT> NUMBER OF SUPPLEMENTARY PARTICLES TO BE FOLLOWED</A>    
    <A HREF="#fsrate"><FONT CLASS=c1>S13</FONT> QUANTUM ITERATION TIME IN NEUT - FSRATE (S)</A>    
    <A HREF="#qtim"><FONT CLASS=c1>S14</FONT> QUANTUM ITERATION TIME IN DIV - QTIM (S)</A>    
    <A HREF="#cpu"><FONT CLASS=c1>S15</FONT> CPU TIME LIMIT (S)</A>    
    <A HREF="#avdwel"><FONT CLASS=c1>S16</FONT> AVERAGE DWELL TIMES (S) FOR EACH CHARGE STATE</A>    
    <A HREF="#dweltf"><FONT CLASS=c1>S17</FONT> DWELL TIME FACTORS FOR TIME DEPENDENT ANALYSIS</A>    
    <A HREF="#mxdwel"><FONT CLASS=c1>S18</FONT> MAXIMUM DWELL TIME FOR STEADY STATE</A>    
    <A HREF="#yldmod"><FONT CLASS=c1>D22</FONT> SET OF YIELD MODIFIERS FOR PRIMARY, SECONDARY AND CHEMICALLY SPUTTERED NEUTRALS.</A>    
    <A HREF="#fixyld"><FONT CLASS=c1>D23</FONT> SPECIFIED FIXED YIELD VALUE FOR SPUTTER DATA OPTION 4</A>        
    <A HREF="#targt"><FONT CLASS=c1>D24</FONT> TARGET TEMPERATURE IN K</A>    
    <A HREF="#wallt"><FONT CLASS=c1>D25</FONT> WALL TEMPERATURE IN K</A>    
    <A HREF="#ppwt"><FONT CLASS=c1>D26</FONT> PRIVATE PLASMA WALL TEMPERATURE</A>    
    <A HREF="#wsegt"><FONT CLASS=c1>D27</FONT> SPECIFIC WALL SEGMENT TEMPERATURES</A>    
    <A HREF="#debugn"><FONT CLASS=c1>B04</FONT> DEBUG NEUT (0 OFF, &amp;GT;0 ON)</A>    
    <A HREF="#debugd"><FONT CLASS=c1>B05</FONT> DEBUG DIV (0 OFF, &amp;GT;0 ON)</A>    
    <A HREF="#debugv"><FONT CLASS=c1>B06</FONT> DEBUG ION VELOCITY (0 OFF, &amp;GT;0 ON)</A>    
    <A HREF="#seed"><FONT CLASS=c1>S19</FONT> RANDOM NUMBER SEED (0 GENERATE NEW SEED)</A>    
    <A HREF="#pinseed"><FONT CLASS=c1>H01</FONT> PIN/NIMBUS RANDOM NUMBER SEED (0 GENERATE NEW SEED, -1 USE FIXED PIN SEED)</A>
    <A HREF="#print"><FONT CLASS=c1>A04</FONT> PRINT OPTION (0 REDUCED, 1+)</A>    
    <A HREF="#pinpr"><FONT CLASS=c1>H02</FONT> PIN/NIMBUS PRINT OPTION (0 REGULAR, 1 ADDITIONAL DATA)</A>
    <A HREF="#divitr"><FONT CLASS=c1>S20</FONT> NUMBER OF DIVIMP ITERATIONS</A>    
    <A HREF="#folcor"><FONT CLASS=c1>I16</FONT> STOP FOLLOWING IONS REACHING MAIN PLASMA 0NO 1YES</A>    
    <A HREF="#rectgr"><FONT CLASS=c1>G15</FONT> RECTANGULAR GRID FOR NEUTRALS 0CALCULATE 99FILE</A>    
    <A HREF="#zo"><FONT CLASS=c1>D28</FONT> TEMPERATURE GRADIENT COEFFICIENT PARAMETER - ZO</A>    
    <A HREF="#lostir"><FONT CLASS=c1>F03</FONT> LOST SOL RING OPTION</A>    
    <A HREF="#vmultf"><FONT CLASS=c1>F04</FONT> VELOCITY MULTIPLICATION FACTORS - FOR DATA READ FROM FILES</A>    
    <A HREF="#ilosst"><FONT CLASS=c1>I17</FONT> ION LOSS TIME</A>    
    <A HREF="#powden"><FONT CLASS=c1>P19</FONT> POWER DENSITY - P/A</A>    
    <A HREF="#k0"><FONT CLASS=c1>P20</FONT> PARALLEL HEAT CONDUCTION COEFFICIENT - K0</A>    
    <A HREF="#k0i"><FONT CLASS=c1>P21</FONT> PARALLEL ION HEAT CONDUCTION COEFFICIENT - K0I</A>    
    <A HREF="#efield"><FONT CLASS=c1>P22</FONT> ELECTRIC FIELD OPTION - OVERRIDES OTHER E-FIELD OPTIONS OR DATA</A>    
    <A HREF="#ef4-1"><FONT CLASS=c1>P23</FONT> ELECTRIC FIELD OPTION 4 - SOURCE LENGTH SPECIFIER</A>    
    <A HREF="#ef4-2"><FONT CLASS=c1>P24</FONT> ELECTRIC FIELD OPTION 4 - COLLISIONAL DETERMINATION FACTOR</A>    
    <A HREF="#s12-ls"><FONT CLASS=c1>P25</FONT> IONIZATION SOURCE-CHARACTERISTIC LENGTH- SOL12 TO 15 - LS</A>    
    <A HREF="#s12-l2"><FONT CLASS=c1>P26</FONT> IONIZATION SOURCE- SECOND CHARACTERISTIC LENGTH - L<SUB>2</SUB></A>    
    <A HREF="#s12-fi"><FONT CLASS=c1>P27</FONT> IONIZATION SOURCE- SOURCE FRACTION - FI</A>    
    <A HREF="#s12-lr"><FONT CLASS=c1>P28</FONT> RADIATION SOURCE-CHARACTERISTIC LENGTH- SOL12 TO 15 - LR</A>    
    <A HREF="#s12-pa"><FONT CLASS=c1>P29</FONT> RADIATIVE POWER CONSTANT - SOL12 TO 15 - PR/A (W/M<SUP>2</SUP>)</A>    
    <A HREF="#s12frr"><FONT CLASS=c1>P30</FONT> RADIATION SOURCE STRENGTH FRACTION - FRR</A>    
    <A HREF="#s12-iz"><FONT CLASS=c1>P31</FONT> IONIZATION SOURCE OPTION - SOL12 TO 15</A>    
    <A HREF="#s12rad"><FONT CLASS=c1>P32</FONT> RADIATIVE SOURCE OPTION - SOL12 TO 15</A>    
    <A HREF="#s12img"><FONT CLASS=c1>P33</FONT> IMAGINARY ROOT OPTION</A>    
    <A HREF="#s12flu"><FONT CLASS=c1>P34</FONT> FLUX RECIRCULATION OPTION - SOL 12 TO 15</A>    
    <A HREF="#s12fss"><FONT CLASS=c1>P35</FONT> FLUX RECIRCULATION - SOURCE SPECIFICATIONS</A>    
    <A HREF="#zlim"><FONT CLASS=c1>B07</FONT> Z-LIMIT FOR DIVERTOR</A>    
    <A HREF="#injir"><FONT CLASS=c1>I18</FONT> RING NUMBER FOR ION INJECTION - INJECTION OPTION 2,3,5,6 - INJIR</A>    
    <A HREF="#inj1"><FONT CLASS=c1>I19</FONT> INJECTION REGION -LOWER BOUND-INJECTION OPTION 2,3,5,6 - INJ1</A>    
    <A HREF="#inj2"><FONT CLASS=c1>I20</FONT> INJECTION REGION -UPPER BOUND-INJECTION OPTION 2,3,5,6 - INJ2</A>    
    <A HREF="#fpwid"><FONT CLASS=c1>I21</FONT> FAR PERIPHERY WIDTH DEFINITION</A>    
    <A HREF="#fptarl"><FONT CLASS=c1>I22</FONT> FAR PERIPHERY TARGET LOSS - CHARACTERISTIC TIME</A>    
    <A HREF="#fpdiff"><FONT CLASS=c1>I23</FONT> FAR PERIPHERY DIFFUSION RATE</A>    
    <A HREF="#wprmul"><FONT CLASS=c1>N16</FONT> WALL LAUNCH SEGMENT PROBABILITY MULTIPLIERS</A>    
    <A HREF="#abspro"><FONT CLASS=c1>N17</FONT> ABSOLUTE WALL PROBABILITIES</A>    
    <A HREF="#polv"><FONT CLASS=c1>T17</FONT> POLOIDAL DRIFT VELOCITY - VPOL (M/S)</A>    
    <A HREF="#polvr"><FONT CLASS=c1>T18</FONT> POLOIDAL DRIFT VELOCITY - RANGE OF EFFECT</A>
    <A HREF="#emaxf"><FONT CLASS=c1>D29</FONT> EMAX-FACTOR FOR NEUT LAUNCH VELOCITY - EMAXF</A>    
    <A HREF="#wlener"><FONT CLASS=c1>D30</FONT> IMPURITY ION IMPACT ENERGY FOR WALL LAUNCH NEUTRALS</A>    
    <A HREF="#runpin"><FONT CLASS=c1>H03</FONT> RUN PIN OPTION</A>    
    <A HREF="#pincom"><FONT CLASS=c1>H04</FONT> PIN COMMAND LINE</A>    
    <A HREF="#ihcorr"><FONT CLASS=c1>H05</FONT> PIN CELL AREA OPTION (IHCORR)</A>    
    <A HREF="#hybrid"><FONT CLASS=c1>H06</FONT> PIN HYBRID WALL OPTION</A>    
    <A HREF="#ppuff"><FONT CLASS=c1>H07</FONT> PIN PUFFING OPTION</A>    
    <A HREF="#ppuffl"><FONT CLASS=c1>H08</FONT> PIN PUFF LOCATION SWITCH</A>    
    <A HREF="#hpcpuf"><FONT CLASS=c1>H09</FONT> PIN PUFF FRACTION - HPCPUF</A>    
    <A HREF="#ppcpuf"><FONT CLASS=c1>H10</FONT> PIN FLUX PUFF FRACTION - PPCPUF</A>    
    <A HREF="#tpufh"><FONT CLASS=c1>H11</FONT> PIN PUFF INJECTION TEMPERATURE (EV) - TPUFH</A>    
    <A HREF="#jhpuf1"><FONT CLASS=c1>H12</FONT> PIN PUFF LOCATION INDICES - JHPUF1</A>    
    <A HREF="#jhpuf2"><FONT CLASS=c1>H13</FONT> PIN PUFF LOCATION INDICES - JHPUF2</A>    
    <A HREF="#solite"><FONT CLASS=c1>P36</FONT> ITERATE SOL OPTION</A>    
    <A HREF="#secsol"><FONT CLASS=c1>P37</FONT> SECONDARY SOL OPTION</A>    
    <A HREF="#ssoliz"><FONT CLASS=c1>P38</FONT> IONIZATION OPTION FOR ITERATIVE SOL</A>    
    <A HREF="#nsolit"><FONT CLASS=c1>P39</FONT> NUMBER OF PIN/SOL ITERATIONS</A>    
    <A HREF="#tcoord"><FONT CLASS=c1>G16</FONT> SET OF TARGET COORDINATES</A>    
    <A HREF="#wcoord"><FONT CLASS=c1>G17</FONT> SET OF WALL COORDINATES</A>    
    <A HREF="#twcoor"><FONT CLASS=c1>G18</FONT> SET OF TRAP WALL OR ITER SECOND WALL COORDINATES</A>    
    <A HREF="#maxgen"><FONT CLASS=c1>D31</FONT> MAXIMUM NUMBER OF SPUTTERED GENERATIONS</A>    
    <A HREF="#bgir"><FONT CLASS=c1>B08</FONT> RING NUMBER FOR DETAILED BACKGROUND DATA</A>    
    <A HREF="#cospow"><FONT CLASS=c1>N18</FONT> POWER OF COSINE RELEASE DISTRIBUTION (V/A FLAG 12,13)</A>    
    <A HREF="#vmult"><FONT CLASS=c1>N19</FONT> VELOCITY MULTIPLIER FOR VELOCITY/ANGLE FLAG 14 AND 15</A>    
    <A HREF="#vmultr"><FONT CLASS=c1>N20</FONT> VELOCITY MULTIPLIER FOR RECOMBINED IONS</A>    
    <A HREF="#sleak"><FONT CLASS=c1>C01</FONT> SET OF S-VALUES FOR ION LEAKAGE DIAGNOSTIC</A>    
    <A HREF="#det">DETACHED PLASMA MODEL PARAMETERS</A>    
    <A HREF="#detlsw"><FONT CLASS=c1>R01</FONT> DETACHED PLASMA - LENGTH SCALING SWITCH</A>    
    <A HREF="#detter"><FONT CLASS=c1>R02</FONT> DETACHED PLASMA TE/TE0 RATIO</A>    
    <A HREF="#dettir"><FONT CLASS=c1>R03</FONT> DETACHED PLASMA TI/TI0 RATIO</A>    
    <A HREF="#detner"><FONT CLASS=c1>R04</FONT> DETACHED PLASMA NE/NE0 RATIO</A>
    <A HREF="#r05"><FONT CLASS=c1>R05</FONT> DETACHED PLASMA N-evolution EXPONENTS (ALPHA)</A>    
    <A HREF="#detqr"><FONT CLASS=c1>R06</FONT> DETACHED PLASMA QRAD/Q0 RATIO</A>    
    <A HREF="#detl1r"><FONT CLASS=c1>R07</FONT> DETACHED PLASMA L1/SMAX RATIO</A>    
    <A HREF="#detl2r"><FONT CLASS=c1>R08</FONT> DETACHED PLASMA L2/SMAX RATIO</A>    
    <A HREF="#detlvr"><FONT CLASS=c1>R09</FONT> DETACHED PLASMA LV/SMAX RATIO</A>    
    <A HREF="#detv1m"><FONT CLASS=c1>R10</FONT> DETACHED PLASMA V1 MULTIPLIER</A>
    <A HREF="#r11"><FONT CLASS=c1>R11</FONT> DETACHED PLASMA - DETAILED RING SPECIFICATIONS - INNER (JET)</A>
    <A HREF="#r12"><FONT CLASS=c1>R12</FONT> DETACHED PLASMA - DETAILED RING SPECIFICATIONS - OUTER (JET)</A>    
    <A HREF="#absfac"><FONT CLASS=c1>D32</FONT> ABSFAC OR POWER TO TARGETS</A>    
    <A HREF="#sonnnr"><FONT CLASS=c1>G19</FONT> SONNET GRID CHARACTERISTIC SPECIFICATIONS - ASDEX U - CMOD - TEXTOR : NUMBER OF RINGS</A>    
    <A HREF="#sonnnk"><FONT CLASS=c1>G20</FONT> SONNET GRID: NUMBER OF KNOTS</A>    
    <A HREF="#sncutr"><FONT CLASS=c1>G21</FONT> SONNET GRID: CUT RING NUMBER</A>    
    <A HREF="#sncp1"><FONT CLASS=c1>G22</FONT> SONNET GRID: CUT POINT 1</A>    
    <A HREF="#sncp2"><FONT CLASS=c1>G23</FONT> SONNET GRID: CUT POINT 2</A>    
    <A HREF="#snnfla"><FONT CLASS=c1>F05</FONT> SONNET GRID: NUMBER OF FLUID RESULTS IN BACKGROUND PLASMA FILE (NFLA)</A>    
    <A HREF="#rdaux"><FONT CLASS=c1>F06</FONT> READ BACKGROUND PLASMA AUXILIARY INPUT FILE</A>    
    <A HREF="#stgrad"><FONT CLASS=c1>D33</FONT> STGRAD : GRADIENT END-POINT SPECIFIER</A>    

    <A HREF="#sol22">SOL OPTION 22</A>

    <A HREF="#force"><FONT CLASS=c1>201</FONT> FORCING TE=TI</A>    
    <A HREF="#mach0"><FONT CLASS=c1>202</FONT> INITIALLY IMPOSED TARGET MACH NUMBER</A>    
    <A HREF="#dmach"><FONT CLASS=c1>203</FONT> INITIAL MACH NUMBER STEP SIZE</A>    
    <A HREF="#mchres"><FONT CLASS=c1>204</FONT> ULTIMATE MACH NUMBER RESOLUTION</A>    
    <A HREF="#izl"><FONT CLASS=c1>205</FONT> IONIZATION SOURCE LENGTH SWITCH</A>    
    <A HREF="#izbeg"><FONT CLASS=c1>206</FONT> START OF IONIZATION SOURCE</A>    
    <A HREF="#izend"><FONT CLASS=c1>207</FONT> END OR LENGTH OF IONIZATION SOURCE</A>    
    <A HREF="#izfact"><FONT CLASS=c1>208</FONT> DECAY FACTOR OR WIDTH OF IONIZATION SOURCE</A>    
    <A HREF="#radl"><FONT CLASS=c1>209</FONT> LENGTH OF THE RADIATION SOURCE</A>    
    <A HREF="#radlam"><FONT CLASS=c1>210</FONT> DECAY LENGTH OF RADIATION SOURCE</A>    
    <A HREF="#radfrr"><FONT CLASS=c1>211</FONT> SOURCE STRENGTH FRACTION (FRR)</A>    
    <A HREF="#garcha"><FONT CLASS=c1>212</FONT> GARCHING RADIATION MODEL: PARAMETER ALPHA</A>    
    <A HREF="#garcht"><FONT CLASS=c1>213</FONT> GARCHING RADIATION MODEL: TEMPERATURE BASE</A>    
    <A HREF="#garch1"><FONT CLASS=c1>214</FONT> GARCHING RADIATION MODEL: FIRST EXPONENT</A>    
    <A HREF="#garch2"><FONT CLASS=c1>215</FONT> GARCHING RADIATION MODEL: SECOND EXPONENT</A>    
    <A HREF="#gcori"><FONT CLASS=c1>216</FONT> CORRECTION FACTOR TO GAMMA (ION)</A>    
    <A HREF="#gcore"><FONT CLASS=c1>217</FONT> CORRECTION FACTOR TO GAMMA (ELECTRON)</A>    
    <A HREF="#cxpowc"><FONT CLASS=c1>218</FONT> CX POWER COEFFICIENT</A>    
    <A HREF="#recsrc"><FONT CLASS=c1>219</FONT> RECYCLING SOURCE COEFFICIENT</A>    
    <A HREF="#peicor"><FONT CLASS=c1>220</FONT> PEI (EQUIPARTITION) CORRECTION FACTOR</A>    
    <A HREF="#velerr"><FONT CLASS=c1>221</FONT> VELOCITY ERROR SWITCH</A>    
    <A HREF="#powbeg"><FONT CLASS=c1>222</FONT> DISTRIBUTED POWER START POSITION</A>    
    <A HREF="#powend"><FONT CLASS=c1>223</FONT> DISTRIBUTED POWER END POSITION</A>    
    <A HREF="#cgpfr"><FONT CLASS=c1>224</FONT> COMPOUND GPERP - FRACTION OF GPERP IN RECTANGULAR DISTRIBUTION</A>    
    <A HREF="#cgpbeg"><FONT CLASS=c1>225</FONT> COMPOUND GPERP - START OF REGION</A>    
    <A HREF="#cgpend"><FONT CLASS=c1>226</FONT> COMPOUND GPERP - END OF REGION</A>
    <A HREF="#227"><FONT CLASS=c1>227</FONT> Extra Perpendicular Source/Sink Strength</A>
    <A HREF="#228"><FONT CLASS=c1>228</FONT> Range of S-values for Extra Source</A>
    <A HREF="#229"><FONT CLASS=c1>229</FONT> Range of S-values for Extra Sink</A>
    <A HREF="#230"><FONT CLASS=c1>230</FONT> Distance Factor for PP Power Loss re-distribution</A>    
    <A HREF="#e2dik"><FONT CLASS=c1>231</FONT> START KNOT INDEX FOR EDGE2D COMPATIBILITY OPTION</A>    
    <A HREF="#e2dfil"><FONT CLASS=c1>232</FONT> FILL OPTION FOR SKIPPED CELLS IN EDGE2D COMPATIBILITY OPTION 9</A>    
    <A HREF="#qecut"><FONT CLASS=c1>233</FONT> QE TERM - TEMPERATURE CUTOFF (EV)</A>    
    <A HREF="#qidaic"><FONT CLASS=c1>234</FONT> PINQID - ATOMIC IONIZATION - T CUTOFF (EV)</A>    
    <A HREF="#qidmic"><FONT CLASS=c1>235</FONT> PINQID - MOLECULAR IONIZATION - T CUTOFF (EV)</A>    
    <A HREF="#qidrc"><FONT CLASS=c1>236</FONT> PINQID - RECOMBINATION - T CUTOFF (EV)</A>    
    <A HREF="#qidcxc"><FONT CLASS=c1>237</FONT> QI TERM / PINQID - CHARGE EXCHANGE - T CUTOFF (EV)</A>    
    <A HREF="#qidtrf"><FONT CLASS=c1>238</FONT> PINQID - CHARGE EXCHANGE OPTION 1 - REFERENCE TEMPERATURE (EV)</A>    
    <A HREF="#mint"><FONT CLASS=c1>239</FONT> MINIMUM TEMPERATURE ALLOWED IN SOLVER (SOL 22)</A>    
    <A HREF="#maxdt"><FONT CLASS=c1>240</FONT> MAXIMUM ALLOWED TEMPERATURE DROP FRACTION</A>    
    <A HREF="#ml-mult"><FONT CLASS=c1>241</FONT> MOMENTUM LOSS TERM MULTIPLIER</A>    
    <A HREF="#ml-ff"><FONT CLASS=c1>242</FONT> FRICTION FACTOR FOR MOMENTUM LOSS</A>    
    <A HREF="#ml-len"><FONT CLASS=c1>243</FONT> LENGTH OF MOMENTUM LOSS REGION</A>    
    <A HREF="#ml-lam"><FONT CLASS=c1>244</FONT> DECAY LENGTH OF MOMENTUM LOSS</A>    
    <A HREF="#ml-cxr"><FONT CLASS=c1>245</FONT> CORRECTION RATIO OF CX TO IONIZATION EVENTS FOR MOMENTUM TRANSFER</A>    
    <A HREF="#ml-cxc"><FONT CLASS=c1>246</FONT> TE CUT-OFF FOR INCREASED CX MULTIPLIER</A>    
    <A HREF="#ml-cxt"><FONT CLASS=c1>247</FONT> TE LOWER LIMIT CUTOFF FOR CX MULTIPLIER</A>    
    <A HREF="#qemult"><FONT CLASS=c1>248</FONT> PIN Qe (ELECTRON ENERGY LOSS) TERM MULTIPLIER</A>
    <A HREF="#249"><FONT CLASS=c1>249</FONT> Prad Option 3 - (Multiplier for PINQE)</A>
    <A HREF="#rkstep"><FONT CLASS=c1>250</FONT> INITIAL NUMBER OF RUNGE-KUTTA STEPS BETWEEN GRID POINTS</A>    

    <A HREF="#sol22sw">SOL OPTION 22 - SWITCHES</A>

    <A HREF="#swion"><FONT CLASS=c1>251</FONT> IONIZATION OPTION</A>    
    <A HREF="#swioni"><FONT CLASS=c1>252</FONT> INITIAL IONIZATION OPTION:</A>    
    <A HREF="#swionp"><FONT CLASS=c1>253</FONT> PRIVATE PLASMA IONIZATION OPTION</A>    
    <A HREF="#swnvkt"><FONT CLASS=c1>254</FONT> 5/2 NV KT TERM:</A>    
    <A HREF="#swmv3n"><FONT CLASS=c1>255</FONT> 1/2 M V<SUP>3</SUP> N TERM</A>    
    <A HREF="#swprad"><FONT CLASS=c1>256</FONT> PRAD OPTION:</A>    
    <A HREF="#swphlp"><FONT CLASS=c1>257</FONT> PHELPI OPTION:</A>    
    <A HREF="#swpei"><FONT CLASS=c1>258</FONT> PEI OPTION:</A>    
    <A HREF="#swpcx"><FONT CLASS=c1>259</FONT> PCX OPTION:</A>    
    <A HREF="#qid-ai"><FONT CLASS=c1>260</FONT> PINQID - DIVIMP CALCULATED QI - ATOMIC IONIZATION</A>    
    <A HREF="#qid-mi"><FONT CLASS=c1>261</FONT> PINQID - DIVIMP CALCULATED QI - MOLECULAR IONIZATION</A>    
    <A HREF="#qidrec"><FONT CLASS=c1>262</FONT> PINQID - DIVIMP CALCULATED QI - RECOMBINATION</A>    
    <A HREF="#qidcx"><FONT CLASS=c1>263</FONT> PINQID - DIVIMP CALCULATED QI - CHARGE EXCHANGE</A>    
    <A HREF="#264"><FONT CLASS=c1>264</FONT> PP TARGET ELECTRON POWER LOSS REDISTRIBUTION OPTION</A>
    <A HREF="#265"><FONT CLASS=c1>265</FONT> PP TARGET ION POWER LOSS REDISTRIBUTION OPTION</A>
    <A HREF="#swvisc"><FONT CLASS=c1>266</FONT> VISCOSITY OPTION:</A>    
    <A HREF="#swml"><FONT CLASS=c1>267</FONT> MOMENTUM LOSS OPTION:</A>    
    <A HREF="#swmach"><FONT CLASS=c1>268</FONT> ITERATIVE MACH NUMBER OPTION:</A>    
    <A HREF="#swe2d"><FONT CLASS=c1>269</FONT> EDGE 2D DATA COMPATIBILITY OPTION:</A>    
    <A HREF="#swpow"><FONT CLASS=c1>270</FONT> POWER DISTRIBUTION OPTION:</A>    
    <A HREF="#swpowp"><FONT CLASS=c1>271</FONT> PRIVATE PLASMA POWER DISTRIBUTION:</A>    
    <A HREF="#swgprp"><FONT CLASS=c1>272</FONT> GAMMA PERP OPTION:</A>    
    <A HREF="#swpgp"><FONT CLASS=c1>273</FONT> PRIVATE PLASMA GAMMA PERP OPTION:</A>
    <A HREF="#274"><FONT CLASS=c1>274</FONT> Extra Gperp SOURCE/SINK OPTION</A>    
    <A HREF="#swmajr"><FONT CLASS=c1>275</FONT> MAJOR RADIUS OPTION:</A>    
    <A HREF="#swcore"><FONT CLASS=c1>276</FONT> CORE FLUX SOURCE:</A>    
    <A HREF="#swrec"><FONT CLASS=c1>277</FONT> RECOMBINATION SOURCE OPTION</A>    
    <A HREF="#swsmth"><FONT CLASS=c1>278</FONT> SMOOTHING OPTION:</A>    
    <A HREF="#swdet"><FONT CLASS=c1>279</FONT> DETACHED PLASMA PRESCRIPTION OPTION</A>    
    <A HREF="#swerr"><FONT CLASS=c1>280</FONT> ERROR CORRECTION LEVEL</A>    
    <A HREF="#swdef"><FONT CLASS=c1>281</FONT> AUTOMATIC DEFAULT ERROR CORRECTION</A>    
    <A HREF="#soltst"><FONT CLASS=c1>S21</FONT> SOLTEST OPTION:</A>    
    <A HREF="#hrec"><FONT CLASS=c1>D34</FONT> H RECOMBINATION CALCULATION OPTION</A>    
    <A HREF="#hrect"><FONT CLASS=c1>D35</FONT> H RECOMBINATION - LIMITING CUTOFF TEMPERATURE (EV)</A>    

    <A HREF="#extrct">THE DPERP/CHIPERP EXTRACTOR</A>

    <A HREF="#exmeth"><FONT CLASS=c1>C02</FONT> EXTRACTOR METHODS:</A>    
    <A HREF="#exrang"><FONT CLASS=c1>C03</FONT> EXTRACTOR RANGE:</A>    
    <A HREF="#exoutr"><FONT CLASS=c1>C04</FONT> INCLUDE OUTER RING LOSSES:</A>    
    <A HREF="#exconv"><FONT CLASS=c1>C05</FONT> DPERP CONVECTION:</A>    
    <A HREF="#exflux"><FONT CLASS=c1>C06</FONT> 1/2 CELL FLUX CORRECTION:</A>    
    <A HREF="#exav"><FONT CLASS=c1>C07</FONT> CALCULATE AVERAGE COEFFICIENTS:</A>    
    <A HREF="#exmajr"><FONT CLASS=c1>C08</FONT> MAJOR RADIUS CORRECTION:</A>    
    <A HREF="#exgrsm"><FONT CLASS=c1>C09</FONT> GRADIENT SMOOTHING:</A>    
    <A HREF="#exgrad"><FONT CLASS=c1>C10</FONT> GRADIENT CALCULATION METHOD:</A>    
    <A HREF="#exarea"><FONT CLASS=c1>C11</FONT> CROSS-FIELD AREA OPTION:</A>    
    <A HREF="#expow"><FONT CLASS=c1>C12</FONT> POWER LOSS TERMS:</A>    
    <A HREF="#exorth"><FONT CLASS=c1>C13</FONT> NON-ORTHOGONAL CORRECTION:</A>    
    <A HREF="#expei"><FONT CLASS=c1>C14</FONT> PEI CORRECTION FACTOR</A>    
    <A HREF="#exrec"><FONT CLASS=c1>C15</FONT> RECYCLING COEFFICIENT CORRECTION</A>    
    <A HREF="#exrat"><FONT CLASS=c1>C16</FONT> EXTRACTOR DPERP/XPERP RATIO SPECIFICATION</A>    
    <A HREF="#ppspec"><FONT CLASS=c1>P40..P55</FONT> PRIVATE PLASMA (TRAP) SPECIFICATION OPTION INPUTS</A>    
    <A HREF="#rprrn"><FONT CLASS=c1>C17</FONT> VERTICAL RECIPROCATING PROBE - R CROSSING NUMBER</A>    
    <A HREF="#rprrl"><FONT CLASS=c1>C18</FONT> VERTICAL RECIPROCATING PROBE - R LOCATION</A>    
    <A HREF="#rprzn"><FONT CLASS=c1>C19</FONT> HORIZONTAL RECIPROCATING PROBE - Z CROSSING NUMBER</A>    
    <A HREF="#rprzl"><FONT CLASS=c1>C20</FONT> HORIZONTAL RECIPROCATING PROBE - Z LOCATION</A>    
    <A HREF="#crmarf"><FONT CLASS=c1>P56..P59</FONT> INPUT PARAMETERS FOR CORE OPTION 4 AND 5 (MARFE SIMULATION)</A>    
    <A HREF="#tgmodf"><FONT CLASS=c1>D36</FONT> T-GRAD MODIFICATION FACTOR</A>    
    <A HREF="#sol23"><FONT CLASS=c1>300</FONT> SOL 23 INPUT FLAG</A>
    <A HREF="divref-sol23.html">SOL 23 INPUT PARAMETER DOCUMENTATION</A>    
    <A HREF="#nimbin"><FONT CLASS=c1>H14</FONT> NIMBUS NAMELIST INPUT : NIMBIN</A>    
    <P><A HREF="#appa">APPENDIX A: SKELETON DATAFILE FOR DIVMP</A></P>
    </pre>
    </DIV>
    <P>&nbsp;</P>
    <P>&nbsp;</P>
    <P>&nbsp;</P>
        
    <H1>DIVIMP Reference Manual</H1>
    
    <P>&nbsp;</P>
    
    <P>DIVIMP (for DIVertor IMPurity) is a Monte Carlo modelling code that
      follows the series of processes that an impurity ion undergoes during
      transport in a fusion reactor plasma. The following document describes the
      options and selections that can be made in running this code and how to go
      about setting up DIVIMP so that the simulation parameters are specified
      correctly. It also gives a description of what the various parameters are
      intended to do and what function they serve in terms of the model.</P>
    
    <P>This version of DIVIMP is intended to operate using various different
      magnetic geometries from a variety of sources. The currently supported
      geometry files include examples from JET, Asdex, Asdex Upgrade, DIIID,
      Tokamak de Varennes, CMOD and ITER. </P>
    
    <P>DIVIMP requires a background plasma specification in order to model the
      impurity transport. This background can be specified in a number of ways.
      DIVIMP can apply a background plasma to these grids generated by options
      selected in the input file or by reading in a background that has been
      externally generated. Typically, these external backgrounds will have been
      generated by a variety of fluid codes. In the case of JET grids, external
      plasma conditions will have been generated from a run of the fluid code
      EDGE2D. In the case of Asdex or ITER grids the background has most likely
      been generated from a run of B2-EIRENE.</P>
    
    <P>The datafiles required for DIVIMP are as follows :- </P>
    
    <P>The input data file:</P>
    
    <P> The input data file contains a the listing of options and their
      settings for a DIVIMP run. It is the contents of this file that are
      described in detail in the following document. A value for every quantity
      must be specified. Maintaining this file can entail significant work but
      also requires the user to be somewhat familiar with the range of options
      available in DIVIMP. This familiarity will help prevent DIVIMP being run
      with an invalid set of default options. In addition, all of the relevant
      data options are echoed to the output data file from the DIVIMP case. This
      file is usually called &quot;&lt;case name&gt;.dat&quot; and is stored in
      the directory where DIVIMP results are collected. </P>
    
    <P>The equilibrium or grid file:</P>
    
    <P> There is one file that contains virtually all of the required
      information. This is the equilibrium grid file for the shot (generated by
      GRID2D). A variety of information is extracted from this file. The shot
      number and time slice, the co-ordinates of the centre (Ro,Zo),
      co-ordinates of the X point (Rxp,Zxp), Toroidal field BT, and a table of
      (R,Z,BR,BZ) values at each of the grid points defining the shape of the
      plasma are all extracted from this file. In addition the complete
      coordinates (R,Z) of each of the polygons including the centres and
      vertices are also extracted from this file. Finally the values of rho,
      theta, Hrho, Htheta and h used in the calculation of elemental volumes and
      non-orthogonal grid-corrections also come from this file. Note that cgs
      units are converted to SI units for use in DIVIMP. Note also that the
      datafiles contain more information than that required for DIVIMP - the
      reading algorithm searches for keywords identifying the data actually
      needed. This file is attached to FORTRAN unit 4.</P>
    
    <P>An optional background plasma file:</P>
    
    <P> The next file, sometimes called &quot;GHOST&quot; or &quot;.g80&quot;,
      is optional. It contains the results from an EDGE2D or B2 run (the
      background fluid code) and, if the options are set, would be used as the
      source of the background plasma specifications. The typical background
      characteristics specified would include Plasma Density Nb, Drift Velocity
      Vb, Background Ion and Electron Temperatures TiB, TeB, and the Electric
      Field E at each of the grid points. This is typically attached to FORTRAN
      unit 11.</P>
    
    <P>A rarely used XY grid file:</P>
    
    <P> There is another file that is also optional. This is the &quot;GRID&quot;
      or &quot;.grd&quot; file. It contains the specification of a mapping from
      the R,Z bin system to a fixed X,Y grid. This used to be useful for
      tracking neutrals and may still be used for such if the options are set.
      However, it's primary function is for plotting in the OUT program. Since
      it maps the density distributions onto an even XY grid which reduces the
      complexity of the plotting routines. The &quot;GRID&quot; file itself is
      calculated and stored by a DIVIMP/OUT run with the appropriate options
      set, it can be read in later at a considerable savings n computational
      time. This file is now outmoded and rarely if ever used.</P>
    
    <P> Note that the grid points of the three files do not always match, and
      some index shuffling is necessary to extract the results required. This is
      because some additional &quot;dummy&quot; or &quot;virtual&quot; grid
      points are used in the plasma solution of the fluid code (EDGE2D), and
      because the first few rings in the main plasma are not always included in
      these calculations. Any index changes are taken care of automatically in
      DIVIMP. The rings are identified by an index IR and are numbered in
      sequence from 1 to NRS. The first ring is the central mirror in the main
      plasma. Rings 2 through to IRSEP-1 are core plasma rings. Ring IRSEP is
      the first open field line which is taken as the separatrix in DIVIMP.
      Rings IRSEP+1 through to IRWALL are main SOL rings. Ring IRTRAP = IRWALL+1
      is the first private plasma ring. Rings IRTRAP+1 through to NRS are the
      remaining private plasma rings. Note that the last private plasma ring NRS
      strikes the target next to the separatrix IRSEP. The actual values of
      these quantities may vary widely but typical grids will have 20 to 50
      rings. </P>
    
     <P> <A NAME="newopt"></A> This reference manual is maintained on regular basis.
     Entries for new options as well as changes and enhancements will be documented 
     here. However, since development is a continuing process it may happen that 
     an input file will contain undocumented or unlinked input options. In these cases
     please refer to the case print out (the .dat file) and to the iodiv.d6a module since
     both should contain the text describing the options. The ".dat" file contains a 
     descrition of all of the relevant options invoked for the particular case while the 
     iodiv module contains the code that prints all in-code documentation for the various 
     options. Both of these sources should contain valuable information regarding new 
     options that have not yet been externally documented.


     <P> </P> 


    <P><B><FONT SIZE="4">Descriptions of DIVIMP Options and Parameters</FONT></B></P>
    
    <P></P>
    
    <H2><A NAME="title">Title</A></H2>
    
    <P>This entry is composed of two string constants. The first is fixed and
      simply indicates that the first line of the input file is reserved for the
      title of the run. The second string, after leaving a space, (See the
      sample input file), contains a title for the case. Typical
      contents would be the name and series number and perhaps a reference to a
      note or other document that would describe why the case was run. These are
      useful in the future when cross-checking the cases that have been run. The title
      will appear in all print outs and on plots produced from the output of the case.</P>
    
    <P></P>

    <H2><A NAME="a02">Case Description</A></H2>

    <P> This input is another DIVIMP character string value. The first string is an identifier tag 
      and the second string should contain a description of the important features or options 
      for the case. This description will be included in the header information of the .dat/.html
      case file and will be included in the description section of the posted case database. </P>

    <P></P>
    
    <H2><A NAME="grid">Equilibrium Grid File Name</A></H2>
    
    <P>This input line specifies the complete path-inclusive name for the
      equilibrium file that is being used to run the case. This information is
      then passed to PIN/NIMBUS, if it is being run, for its use in loading the
      equilibrium grid. At this time, the information is not directly used by
      DIVIMP itself. DIVIMP relies on the script file to pre-connect the
      equilibrium grid to the appropriate input unit number.</P>
    
    <P>e.g. 'Equil File Name' '/u/progs/div4/shots/g31627.v3'</P>
    
    <P></P>
    
    <H2><a name="opts">Options:</a></H2>
    
    <P></P>
    
    <H3><A NAME="gridop">Grid Option</A></H3>
    
    <P> <B>Grid Option 0</B>: Standard jet grid files</P>
    
    <P> <B>Grid Option 1</B>: Standard Asdex grid files.</P>
    
    <P> As implemented at Juelich (KFA)</P>
    
    <P> <B>Grid Option 2</B>: Standard ITER grid files.</P>
    
    <P> Works with one example of a double null ITER grid - processed at
      Juelich (KFA).</P>
    
    <P> <B>Grid Option 3</B>: Standard Sonnet grid files.</P>
    
    <P> Works with standard Asdex upgrade/B2 grid files. The number of points
      to the cut point and other parameters are entered as parameters in the
      input file. This is also the standard grid type usually used for DIIID,
      TdV and CMOD modeling.</P>
    
    <P></P>
    
    <H3><A NAME="orthop">Non-Orthogonal Option</A></H3>
    
    <P> <B>Non-Orthogonal Opt 0</B>: Standard. All transport and target angles
      are treated as orthogonal. No corrections for non-orthogonality are made.
    </P>
    
    <P> <B>Non-Orthogonal Opt 1</B>: JET. Targets and transport are treated
      using corrections for non-orthogonal grids. Non-orthogonal transport is
      implemented using ancillary information available with JET grids only.
    </P>
    
    <P> <B>Non-Orthogonal Opt 2</B>: Targets only. Target fluxes and other
      factors are corrected for target grid orthogonality in a manner identical
      with option 1. Ion transport is treated as orthogonal with no corrections
      made for grid orthogonality. </P>
    
    <P> <B>Non-Orthogonal Opt 3</B>: Generalized Non-orthogonal treatment.
      Both targets and ion transport are corrected for grid non-orthogonality.
      The non-orthogonal ion transport is implemented by the calculation of an
      additional orthogonal co-ordinate which is held constant when moving
      cross-field. This co-ordinate is calculated based on individual cell
      orthogonal characteristics. (e.g. center angles) and is functionally
      identical to the additional grid information that is available for JET
      grids. </P>
    
    <P></P>
    
    <H3><A NAME="pdopt">Parallel Distance Option</A></H3>
    
    <P> <B>Parallel Dist Opt 0</B>: Cell Centers. This option affects particle
      accounting and ion transport and in addition should be selected in
      combination with cell area option 0. The boundary between cells for
      particle accounting purposes is half-way between the centres of the
      adjacent cells. The S-distances along the field lines are calculated by
      joining the centers of adjacent cells. </P>
    
    <P> <B>Parallel Dist Opt 1</B>: Polygon Boundaries. This option affects
      particle accounting and ion transport and in addition should be selected
      in combination with cell area option 1 and cross-field distance option 1.
      The S-distances along the field lines are calculated by joining the
      mid-points of the ends of the polygon that cross the field line to the
      center point of the cell. The S-coordinates of both the cell center and
      the polygon boundaries are recorded. An ion is in a specific bin if the S 
      position of the ion lies between the S-boundaries for the cell. </P>
    
    <P></P>
    
    <H3><A NAME="cfdist">Cross-field Distance Option</A></H3>
    
    <P> <B>Cross-field Dist Opt 0</B>: Cell centers. This option affects
      particle accounting and ion transport. It should be used in combination
      with area option 0 and parallel distance option 0. A particle is
      considered to have cross-field diffused into the next cell when it crosses
      the half-way point between the cell centers moving inward or outward. </P>
    
    <P> <B>Cross-field Dist Opt 1</B>: Approximate Polygon Boundaries. This
      option affects particle accounting and ion transport. It should be used in
      combination with Area Option 1 and parallel distance option 1. A particle
      is considered to have cross-field diffused into the next cell when it has
      stepped farther than distance of the intersection point of the polygon
      boundary with the line joining the two cell centers of the adjacent cells.
    </P>
    
    <P></P>
    
    <H3><A NAME="rzcalc">R,Z Calculation Option</A></H3>
    
    <P> <B>R,Z Option 0</B> : Cell center R,Z values are used to estimate the
      particle position.</P>
    
    <P> <B>R,Z Option 1</B> : The GETRZ subroutine is used to calculate an
      estimate of the actual R,Z position of the particle. At present this
      estimate only includes the parallel displacement and not the perpendicular
      component because of the difficulties in defining a perpendicular angle
      consistently through-out the cell.</P>
    
    <P></P>
    
    <H3><A NAME="xygrid">XY Grid Option</A></H3>
    
    <P> <B>XY Grid Option 0</B>: Off- XY grids are NOT used to track impurity
      neutrals in DIVIMP. A bin-finding subroutine is used instead. The
      rectangular grid option described later in the code is NOT used. </P>
    
    <P> <B>XY Grid Option 1</B>: On- Use XY grids to track impurity neutrals.
      the rectangular grid option specified later is used to define whether the
      grid will be calculated or loaded.</P>
    
    <P></P>
    
    <H3><A NAME="area">Cell Area Calculation Option</A></H3>
    
    <P> <B>Cell Area Option 0</B>: Approximate. This is the original DIVIMP
      method that calculates cell areas based on the locations of the cell
      centres. It must be used with older grids that do not include the all the
      grid cell information. It is not recommended for use with current polygonal grids.</P>
    
    <P> <B>Cell Area Option 1</B>: Polygonal. This option uses the complete
      cell polygon information, specifically the co-ordinates of the corners, to
      calculate the proper area of each cell on the grid. It can not calculate
      areas for the virtual rings for which complete cell information is not
      available. </P>
    
    <P></P>
    
    <H3><A NAME="bfield">On Axis B-field Value</A></H3>
    
    <P>This quantity is the strength of the on-axis toroidal magnetic field (B<SUB>(</SUB>).
      It is used if a value is NOT specified in the grid geometry file for the
      shot. All JET grids include a value for the on-axis magnetic field while
      SONNET grids generally do not. This quantity is relevant to calculating
      prompt ion deposition losses among other items.</P>
    
    <P></P>
    
    <H3><A NAME="izdata">Ionization Data Source Option</A></H3>
    
    <P> <B>Source Data Option 0</B>: Ionization and radiation data are taken
      from the NOCORONA subroutine package.</P>
    
    <P> <B>Source Data Option 1</B>: Ionization and radiation data are taken
      from the ADAS subroutine package.</P>
    
    <P> <B>Source Data Option 2</B>: B2-FRATRES formatted atomic physics data
      is used. The specific file name must be input using the MC-Filename
      option. This option is used for both ADPAK and STRAHL databases.</P>
    
    <P> <B>Source Data Option 3</B>: INEL formatted atomic physics database.
      The file name must be specified using the MC-Filename option described
      below. </P>
    
    <P></P>
    
    <H3><A NAME="huser">Source Data Option Specifications - UserID for H
      Database</A></H3>
    
    <P>This is a character string specifying the path leading to the ADAS
      database files for the hydrogen data to be used in the case. If a '*' is
      specified this instructs the code to use the ADAS central database whose
      location has been defined by specifying it in the environment variable
      ADASCENT.</P>
    
    <P></P>
    
    <H3><A NAME="hyear">Source Data Option Specifications - H data year</A></H3>
    
    <P>The number entered as input is the year of the data from the specified
      hydrogen database to be used in the DIVIMP calculations. The ADAS database
      may have multiple sets of data for each element from differing years. An
      example would be, 93, which would select the 1993 from the specified
      hydrogen database.</P>
    
    <P></P>
    
    <H3><A NAME="zuser">Source Data Option Specifications - UserID for Z
      (impurity) Database</A></H3>
    
    <P>This is a character string specifying the path leading to the ADAS
      database files for the impurity data to be used in the case. If a '*' is
      specified this instructs the code to use the ADAS central database whose
      location has been defined by specifying it in the environment variable
      ADASCENT.</P>
    
    <P></P>
    
    <H3><A NAME="zyear">Source Data Option Specifications - Z (impurity) data
      year</A></H3>
    
    <P>The number entered as input is the year of the data from the specified
      impurity database to be used in the DIVIMP calculations. The ADAS database
      may have multiple sets of data for each element from differing years. An
      example would be, 89, which would select the 1989 from the specified
      impurity database.</P>
    
    <H3><A NAME="frates">Name of file containing ADPAK/INEL atomic database</A></H3>
    
    <P>MC-Filename Option. This line takes a character string entry that gives
      the complete path for the atomic ionization data that is to be used for
      Atomic Data Options 2 and 3 (INEL, ADPAK and STRAHL).</P>
    
    <P></P>
    
    <H3><A NAME="izopt">Ionization</A></H3>
    
    <P> <B>Ionization opt 0</B> : rates from S(z,Te) data. Ions not followed
      after state Z (given)</P>
    
    <P> <B>Ionization opt 1</B> : rates from S(z,Te) data. Ionization disabled
      after state Z (given)</P>
    
    <P> <B>Ionization opt 2</B> : rates taken as MAX (S(z,Te)). Ionization
      disabled after state Z (given)</P>
    
    <P> <B>Ionization opt 3</B> : rates from Abels van Maanen with E-I REC.
      Ions not followed after state Z (given)</P>
    
    <P> <B>Ionization opt 4</B> : rates from Abels van Maanen. Ions not
      followed after state Z (given)</P>
    
    <P> <B>Ionization opt 5</B> : rates from Abels van Maanen with E-I REC.
      Ionization disabled after state Z (given)</P>
    
    <P> <B>Ionization opt 6</B> : rates from Abels van Maanen. Ionization
      disabled after state Z (given)</P>
    
    <P></P>
    
    <H3><A NAME="coll">Collision</A></H3>
    
    <P> <B>Collision option 0</B> : </P>
    
    <P> <IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"> </P>
    
    <P> <B>Collision option 1</B> : <IMG SRC="images/divref-92.gif" WIDTH="23" HEIGHT="33">
      = infinity, no diffusion outside of given Kspec only. Elsewhere reverts to
      collision option 0.</P>
    
    <P> <B>Collision option 2</B> : </P>
    
    <P><IMG SRC="images/divref-93.gif" WIDTH="310" HEIGHT="70"></P>
    
    <P> where Zeff given outside of given Kspec only.</P>
    
    <P> Elsewhere reverts to collision option 0.</P>
    
    <P> <B>Collision option 3</B> : </P>
    
    <P> <IMG SRC="images/divref-94.gif" WIDTH="348" HEIGHT="70"> </P>
    
    <P> Time between K diff steps = tau para outside of given Kspec only.
      Elsewhere Time between Y diff steps = DeltaT</P>
    
    <P> <B>Collision option 4</B>: </P>
    
    <P> <IMG SRC="images/divref-95.gif" WIDTH="376" HEIGHT="70"></P>
    
    <P> when Ti &gt; Tb.Mi/Mb and</P>
    
    <P> for rings &gt;= given ring no. </P>
    
    <P> Elsewhere reverts to collision option 0.</P>
    
    <P> Time between S diff steps = tau para</P>
    
    <P> for rings &gt;= given ring no. Elsewhere</P>
    
    <P> Time between Y diff steps = DeltaT</P>
    
    <P> <B>Collision Option 5</B>: Parallel velocity diffusion</P>
    
    <P> <IMG SRC="images/divref-96.gif" WIDTH="111" HEIGHT="68"></P>
    
    <P> </P>
    
    <P><IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"></P>
    
    <P> diffusion occurs if : </P>
    
    <P> 0 &lt; (random) &lt; dt/<IMG SRC="images/divref-92.gif" WIDTH="23" HEIGHT="33"></P>
    
    <P> <B>Collision Option 6</B>: Parallel velocity diffusion</P>
    
    <P> <IMG SRC="images/divref-97.gif" WIDTH="166" HEIGHT="71"> </P>
    
    <P> deltav = sqrt(8kti/pi.Mi)* sqrt( dt / (tau para))</P>
    
    <P> at every time step </P>
    
    <P> </P>
    
    <P> <IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"> </P>
    
    <P><B>Collision Option 7</B>: </P>
    
    <P> <IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"></P>
    
    <P> diffusive steps in the direction</P>
    
    <P> opposite of the particles velocity</P>
    
    <P> reverse the sign of that v. </P>
    
    <P> For rings greater than IRSPEC-1:</P>
    
    <P> (Unless special plasma parameter = 0)</P>
    
    <P> time between s diff steps = (t</P>
    
    <P> Elsewhere:</P>
    
    <P> time between s diff steps = taupara</P>
    
    <P> <B>Collision Option 8</B>: </P>
    
    <P> <IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"></P>
    
    <P> S diffusive steps are based on:</P>
    
    <P><IMG SRC="images/divref-98.gif" WIDTH="123" HEIGHT="68"></P>
    
    <P> Otherwise as Coll Opt 0. </P>
    
    <P> <B>Collision Option 9</B>:</P>
    
    <P> <IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"></P>
    
    <P> S diffusive steps are based on:</P>
    
    <P> <IMG SRC="images/divref-98.gif" WIDTH="123" HEIGHT="68"></P>
    
    <P> For IR &lt; IRSPEC:</P>
    
    <P> time between s diff steps = <IMG SRC="images/divref-92.gif" WIDTH="23" HEIGHT="33"></P>
    
    <P> Elsewhere:</P>
    
    <P> time between s diff steps = (t</P>
    
    <P> <B>Collision Option 10</B>: Parallel velocity diffusion</P>
    
    <P> <IMG SRC="images/divref-99.gif" WIDTH="113" HEIGHT="68"></P>
    
    <P> <IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"></P>
    
    <P> </P>
    
    <P> diffusion occurs if : </P>
    
    <P> 0 &lt; (random) &lt; (t /<IMG SRC="images/divref-92.gif" WIDTH="23" HEIGHT="33"></P>
    
    <P> <B>Collision Option 11</B>: Parallel velocity diffusion</P>
    
    <P> <IMG SRC="images/divref-100.gif" WIDTH="168" HEIGHT="71"></P>
    
    <P> at every time step </P>
    
    <P> <IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"></P>
    
    <P> </P>
    
    <P> <B>Collision Option 12</B>: Parallel velocity diffusion</P>
    
    <P> <IMG SRC="images/divref-101.gif" WIDTH="203" HEIGHT="71"></P>
    
    <P> at every time step </P>
    
    <P> where </P>
    
    <P> <IMG SRC="images/divref-102.gif" WIDTH="271" HEIGHT="38"></P>
    
    <P> x1,x2 are uniform on [0,1] </P>
    
    <P> <IMG SRC="images/divref-91.gif" WIDTH="348" HEIGHT="70"></P>
    
    <P> <B>Collision Option 13</B>: Parallel velocity diffusion</P>
    
    <P> <IMG SRC="images/divref-101.gif" WIDTH="203" HEIGHT="71"></P>
    
    <P> at every time step</P>
    
    <P> where </P>
    
    <P> <IMG SRC="images/divref-102.gif" WIDTH="271" HEIGHT="38"></P>
    
    <P> x1,x2 are uniform on [0,1] </P>
    
    <P> <IMG SRC="images/divref-103.gif" WIDTH="460" HEIGHT="70"></P>
    
    <P> <B>Collision Option 14</B>: Parallel Velocity Diffusion </P>
    
    <P> Exactly the same as Option 13 EXCEPT that velocity diffusion is turned
      off (DELTAV=0.0) for S &gt; FACTOR * SMAX for the ring, from each target.
      FACTOR is specified by the S<SUB>tgrad</SUB> parameter.</P>
    
    <P></P>


    <H3><A NAME="t03">Reiser Parallel Force Calculation Option</A></H3>


    <P> <B>Reiser option 0</B> : </P>

    <P> Reiser coulomb collison option for calculating the parallel forces is turned off.</P>   


    <P> </P>     

    <P> <B>Reiser option 1</B> : </P>

    <P> Reiser coulomb collison option for calculating the parallel forces is turned on.
      The regular DIVIMP collison and friction options are not used. The Reiser coefficients
      are constant for each cell.</P>   

    <P> </P>     

    <P> <B>Reiser option 2</B> : </P>

    <P> Reiser coulomb collison option for calculating the parallel forces is turned on.
      The regular DIVIMP collison and friction options are not used. The Reiser transport
      coeffcients are recalculated at every time step based on the local conditions and
      impurity particle location along the field line. Background profiles are interpolated
      between cell centers. This may incur a significant computational cost.</P>   

    <P> </P>     

    <H3><A NAME="fric">Friction</A></H3>
    
    <P> <B>Friction option 0</B> : </P>
    
    <P> <IMG SRC="images/divref-104.gif" WIDTH="523" HEIGHT="106"></P>
    
    <P> <B>Friction option 1</B> : Tau<SUB>stop</SUB> = infinity outside of
      given Kspec only. Elsewhere reverts to friction option 0.</P>
    
    <P> <B>Friction option 2</B> : Tau<SUB>stop </SUB>= Tau<SUB>||</SUB>
      outside of given Kspec only. Elsewhere reverts to friction option 0</P>
    
    <P> <B>Friction option 3</B> : </P>
    
    <P> <IMG SRC="images/divref-105.gif" WIDTH="490" HEIGHT="106"></P>
    
    <P> when Ti &gt; Tb.Mi/Mb and</P>
    
    <P> for rings &gt;= given ring no. Elsewhere</P>
    
    <P> reverts to friction option 0.</P>
    
    <P> <B>Friction option 4</B> : </P>
    
    <P> <IMG SRC="images/divref-104.gif" WIDTH="523" HEIGHT="106"></P>
    
    <P> </P>
    
    <P> The friction goes to zero for a cell whose mean free path is less than
      the distance to the target.</P>
    
    <P></P>
    
    <H3><A NAME="heat">Heating</A></H3>
    
    <P> <B>Heating option 0</B> : </P>
    
    <P> <IMG SRC="images/divref-106.gif" WIDTH="416" HEIGHT="70"></P>
    
    <P> <B>Heating option 1</B> : Tau<SUB>HEAT</SUB> = infinity outside of
      given Kspec only. Elsewhere reverts to heating option 0.</P>
    
    <P> <B>Heating option 2</B> : Tau<SUB>HEAT</SUB> = zero outside of given
      Kspec only. Elsewhere reverts to heating option 0.</P>
    
    <P> <B>Heating option 3</B> : </P>
    
    <P> <IMG SRC="images/divref-107.gif" WIDTH="356" HEIGHT="115"></P>
    
    <P> outside of given Kspec only. Elsewhere reverts to heating option 0</P>
    
    <P></P>
    
    <H3><A NAME="inj">Injection</A></H3>
    
    <P> <B>Injection opt *</B> : Disregarded when NEUT control switch not 0</P>
    
    <P> <B>Injection opt 1</B> : Inject ions at given (r,z) with given v0</P>
    
    <P> <B>Injection opt 2</B> : Inject uniformly on a given ring between
      INJ1*SMAX and INJ2*SMAX relative to both plates. Given V0.</P>
    
    <P> <B>Injection opt 3</B> : Inject uniformly on a <A HREF="#injir">given
        ring</A> between <A HREF="#inj1">INJ1</A>*SMAX and <A HREF="#inj2">INJ2</A>*SMAX.
      Given V0.</P>
    
    <P> <B>Injection opt 4</B> : Neutral impurity ionization profiles taken
      from a nimbus/pin run are used to generate a probability map for ion
      injection. The initial ion energy is taken from the nimbus/pin results.</P>
    
    <P> <B>Injection opt 5</B> : Inject uniformly on a <A HREF="#injir">given
        ring</A> between <A HREF="#inj1">INJ1</A>*SMAX and <A HREF="#inj2">INJ2</A>*SMAX
      relative to both plates. </P>
    
    <P> Initial velocity is calculated from:</P>
    
    <P> vinit = rg * v0'</P>
    
    <P> where rg = sqrt(-2*ln(x1))* cos(2pi*x2)</P>
    
    <P> x1,x2 are uniform on [0,1] </P>
    
    <P> and the value for V0 is given.</P>
    
    <P> <B>Injection opt 6</B> : Inject uniformly on a <A HREF="#injir">given
        ring</A> between <A HREF="#inj1">INJ1</A>*SMAX and <A HREF="#inj2">INJ2</A>*SMAX.
    </P>
    
    <P> Initial velocity is calculated from:</P>
    
    <P> vinit = rg * v0'</P>
    
    <P> where rg = sqrt(-2*ln(x1))* cos(2pi*x2)</P>
    
    <P> x1,x2 are uniform on [0,1] </P>
    
    <P> and the value for V0 is given.</P>
    

    <P> <B>Injection opt 7</B> : Based on FLUID CODE results.</P>

    <P> Neutral impurity ionization source profiles taken from a FLUID CODE run are
      used to generate a probability map for ion injection. The initial ion energy is')
      also taken from the FLUID CODE data.</P>

    <P></P>
    
    <H3><A NAME="sol">SOL</A> </H3>
    
    <P> <B>SOL option -1</B> : SOL1a (fl,fs) values given (N344)</P>

    <P>Background velocity and electric field are specified by formulae. See the 
    sol.d6a source code module for a detailed description of the formulae.</P>
    
    <P> <B>SOL option 0</B> : SOL0 </P>
    
    <P>Background velocity and electric field are set to zero everywhere.</P>
    
    <P> <B>SOL option 1</B> : SOL1</P>

    <P>Background velocity and electric field are specified by formulae. See the 
    sol.d6a source code module for a detailed description of the formulae.</P>

    <P> <B>SOL option 2</B> : SOL2</P>

    <P> The velocity is set to Cs * (1-S/SMAX) while the electric field is set to -Te/SMAX.</p>
    
    <P> <B>SOL option 3</B> : SOL3</P>

    <P>Background velocity and electric field are specified by formulae. See the 
    sol.d6a source code module for a detailed description of the formulae.</P>
    
    <P> <B>SOL option 4</B> : SOL4</P>

    <P>Background velocity and electric field are specified by formulae. See the 
    sol.d6a source code module for a detailed description of the formulae.</P>
    
    <P> <B>SOL option 5</B> : SOL5</P>

    <P>Background velocity and electric field are held constant in the SOL with
    appropriate changes in sign for the different ends of the flux tube. The values
    assigned to the <a href="#vhyout">velocity</a> and <a href="#eyout">electric field</a>
    are entered separately in the input file.</P>

    <P> <B>SOL option 6</B> : Efield = constant.</P>    
    
    <P> Vb is set to three discrete constant values in three separate regions.
      The actual values assigned are controlled by the <A HREF="#sol67">SOL
        option 6 and 7 parameters</A> specified later.</P>
    
    <P> <B>SOL option 7 </B>: Efield = constant.</P>
    
    <P> Vb is split into three linearly ramping regions with Vb going to zero
      at SMAX/2.0. Vb varies linearly across each region from the value
      specified at one boundary to the value specified for the next. The actual
      values assigned are controlled by the SOL option 6 and 7 parameters
      specified later.</P>
    
    <P> <B>SOL option 8</B> : Not used</P>
    
    <P> <B>SOL option 9</B> : SOL9 similar to SOL2 (N327)</P>
    
    <P>The velocity is set to the sound speed everywhere with appropriate sign for each
     half flux tube. The electric field is set to -Te/SMAX where Te is the temperature in
     the current cell and SMAX is the field line length from target to target.</p> 
    
    
    <P> <B>SOL option 10</B> : <A HREF="#solprm">SOL10 fRM, fRmin, fRmax,
        Kin, Kout and (fl,fs)</A> values given (N353)</P>
    
    <P> <B>SOL option 12</B> : SOL12 - Pseudo self consistent</P>
    
    <P> Overrides Tgrad options. Electron and ion heat transport are equal. Te,
      Ti, Nb, Vh and E are calculated from the following equations. The value
      for <A HREF="#k0">K<SUB>0</SUB></A> is the same for both electrons and
      ions.</P>
    
    <P> <IMG SRC="images/divref-16.gif" WIDTH="421" HEIGHT="323"></P>
    
    <P> <B>SOL option 13</B> : SOL13 - Pseudo self consistent Overrides Tgrad
      options. Electron and ion heat transport are independent. Te, Ti, Nb, Vh
      and E are calculated from the following equations. The value of K<SUB>0</SUB>
      differs for <A HREF="#k0">electrons</A> and <A HREF="#k0i">ions</A>.</P>
    
    <P> <IMG SRC="images/divref-17.gif" WIDTH="421" HEIGHT="410"></P>
    
    <P> <B>SOL option 14</B> : SOL14 - Pseudo self consistent Overrides Tgrad
      options in the SOL. Calculates Ti, Te, Nb, Vh and E from the following
      equations involving both heat conduction and convection.</P>
    
    <P> <IMG SRC="images/divref-18.gif" WIDTH="383" HEIGHT="298"></P>
    
    <P> <B>SOL option 15</B> : SOL15 - Pseudo self consistent Overrides Tgrad
      options. Electron and ion heat transport are independent. Te, Ti, Nb, Vh
      and E are calculated from the following equations. The value of K<SUB>0</SUB>
      differs for <A HREF="#k0">electrons</A> and <A HREF="#k0i">ions</A>.</P>
    
    <P> <IMG SRC="images/divref-19.gif" WIDTH="421" HEIGHT="408"></P>
    
    <P> <B>SOL option 21</B> : <A HREF="#det">Detached Plasma Prescription</A>.</P>
    
    <P>The regions may be defined either in terms of SMAX or PMAX. This is
      controlled by the <A HREF="#detlsw">length switch</A>. The following
      description uses SMAX as an example. </P>
    
    <P>Three regions: </P>
    
    <P> A: 0 &lt; SMAX * <A HREF="#detl1r">L1</A></P>
    
    <P> B: <A HREF="#detl1r">L1</A> * SMAX &lt; <A HREF="#detl2r">L2</A> *
      SMAX</P>
    
    <P> C: S &gt; SMAX * <A HREF="#detl2r">L2</A></P>
    
    <P> A: Te at outer edge of A : Te0 * <A HREF="#detter">TeR1</A></P>
    
    <P> A: Ti at outer edge of A : Te0 * <A HREF="#dettir">TiR1</A></P>
    
    <P> A: Ne at outer edge of A: Ne0 * <A HREF="#detner">NR1</A></P>
    
    <P> Te increases linearly in A to Te0*TR1 at SMAX*L1</P>
    
    <P> Ti increases linearly in A to Te0*TR1 at SMAX*L1</P>
    
    <P> Ne increases linearly in A to Ne0*NR1 at SMAX*L1</P>
    
    <P> Velocity in A: v(s)=N0V0/n(s) </P>
    
    <P> B: T=(T1**3.5+7/2<A HREF="#k0">K0</A>*(Q0(s-L1) +
      1/2(s-L1)^2*(Qrad/Lrad)))**(2/7)</P>
    
    <P> B: Radiated power in B (Qrad): Q0*<A HREF="#detqr">QR</A></P>
    
    <P> C: T=(T2**3.5+7/2<A HREF="#k0">K0</A>*(Qtot(s-L2)))**(2/7)</P>
    
    <P> Qtot = Q0 + Qrad</P>
    
    <P> B,C: N(s) = N1 * (T(s)/T1)**(-1) </P>
    
    <P> Velocity linearly-&gt;0 at SMAX*<A HREF="#detlvr">VR1</A></P>
    
    <P> <B>SOL Option 22</B> : <A HREF="#sol22">SOL Option 22 is a
        multi-parameter OSM</A> (Onion Skin Model) that uses a Runge-Kutta based
      solver to numerically evaluate the one-dimensional fluid equations.
      Starting from given target conditions and including a wide variety of
      effects, the option generates a complete background plasma solution for
      density, ion and electron temperature, parallel flow velocity and parallel
      electric field. The solutions represent what appears to be a reasonable
      approximation to the conditions found in the edge. As such, they should be
      a useful research tool in examining the behaviour of impurities as well as
      the hydrogenic species behaviour in the reactor and especially for
      comparing predicted observables to actual experimental results. It is
      important to verify that the solution generated, for a given set of target
      conditions, appear to be reasonable. The code can not definitively
      evaluate the legitimacy of a given background solution - this requires
      that the user look at the solution generated and evaluate it in the
      context of the physical situation being modelled. This SOL option has a
      large number of sub-options that are specified in a block at the bottom of
      the input file and are documented later in this manual. The equations that
      are solved are listed below - the solver can find solutions for Te=Ti or
      for Te and Ti evolving independently.</P>
    
    <P><IMG SRC="images/divref-20.gif" WIDTH="653" HEIGHT="53"></P>
    
    <P><IMG SRC="images/divref-21.gif" WIDTH="695" HEIGHT="53"></P>
    
    <P><IMG SRC="images/divref-22.gif" WIDTH="281" HEIGHT="60"></P>
    
    <P><IMG SRC="images/divref-23.gif" WIDTH="483" HEIGHT="36"></P>
    
    <P><IMG SRC="images/divref-24.gif" WIDTH="236" HEIGHT="28"></P>
    
    <P> <B>SOL option 23</B> : SOL option 23 aolves the 1D fluid equations in a DIVIMP context. More
      deatil is provided in the <a href="divref-sol23.html">sol23 specific documentation</a>.</P>
    
    <P> <B>SOL option 98</B> : Read data from DIVIMP generated background
      plasma file - this option must be used in combination with plasma decay
      option 98.</P>
    
    <P> <B>SOL option 99</B> : Read data from file - B2 or Edge2D depending on
      grid.</P>
    
    <P></P>
    
    <H3><A NAME="corepl">Core Plasma Options</A></H3>
    
    <P> <B>Core Option -1</B> : Ignore. This option will cause all of the core
      processing options to be bypassed. Any values set for the core plasma
      either initially or by routines other than the core plasma code section
      will be used for the core plasma. The values for the core will be either
      those specified in the INITPLASMA routine or some values applied through
      other options in the code. </P>
    
    <P> <B>Core Option 0</B> : Normal. This has been the standard DIVIMP
      option in the past. The temperature and density are constant on each core
      ring around it's length and increase by a specified step for each ring
      inside the separatrix ring. These quantities are specified by TebIn, TibIn
      and NbIn. The flow velocity is always zero in the core. </P>
    
    <P> <B>Core Option 1</B> : <A HREF="#cordat">Core Conditions Specified.</A>
      The quantities, Te, Ti and Nb are specified for each ring in the core
      separately. The values are constant along each ring.</P>
    
    <P> <B>Core Option 2</B> : Core Marfe Option.<A HREF="#cordat"> The
        values of Te, Ti, Ne, Vb at the X-point are specified for each ring.</A>
      These ramp up linearly along the core ring to the standard DIVIMP values
      (specified as in option zero) at the inner and outer mid-planes.</P>
    
    <P> <B>Core Option 3</B> : Core Marfe Option. <A HREF="#cordat">The
        values of Te, Ti,---, and Vb at the X-point are specified</A> (Note that
      the density is NOT specified in this option). These ramp up linearly from
      the X-point along the core ring to the standard DIVIMP values for that
      core ring (specified as in option zero) at the inner and outer mid-planes.
      The density along the ring is calculated by applying pressure
      conservation. A number must be supplied for the density in the input but
      it is ignored.</P>
    
    <P> <B>Core Option 4</B> : Core Marfe Option. <A HREF="#cordat">The
        values of Te, Ti,---, and Vb near the X-point are specified.</A> (Note
      that the density is NOT specified in this option). In addition,
      <A HREF="#crmarf">location factors</A> are also specified for the
      temperature and velocity. The temperature and velocity ramp up linearly
      from the first location along the core ring to the standard DIVIMP values
      for that core ring (specified as in option zero) at the second location
      specified. The density along the ring is calculated by applying pressure
      conservation. A number must be supplied for the density in the input but
      it is ignored.</P>
    
    <P> e.g. </P>
    
    <P> V -&gt; 0 for S &lt; Vf1 * SMAX </P>
    
    <P> V -&gt; Vb specified above for S = Vf1 * SMAX</P>
    
    <P> V ramps linearly from Vb down to zero </P>
    
    <P> for Vf1 * SMAX &lt; S &lt; Vf2 * SMAX </P>
    
    <P> V -&gt; 0 for S &gt; Vf2 * SMAX</P>
    
    <P> Te,Ti -&gt; Tex,Tix for S =&lt; Tf1 * SMAX</P>
    
    <P> Te,Ti ramp up linearly to the standard values</P>
    
    <P> for Tf1 * SMAX &lt; S &lt; Tf2 * SMAX</P>
    
    <P> Te,Ti -&gt; Standard for S&gt; Tf2 * SMAX</P>
    
    <P> </P>
    
    <P> <B>Core Option 5</B> : This option is exactly the same as option 4
      except that instead of using the standard option for calculating the base
      conditions on each core ring - this information is expected to be entered
      on a ring by ring basis in <A HREF="#probei">the data input block used to
        specify the plasma background for the SOL</A>. See plasma decay option
      7. Use of this option does NOT require that plasma decay option 7 be
      specified - only that the data be entered in the appropriate portion of
      the input file. This allows alternative methods of specifying target
      conditions to be used while reading in the core conditions and simulating
      a Marfe. </P>
    
    <P></P>
    
    <H3><A NAME="plasma">Plasma decay</A> </H3>
    
    <P> <B>Plasma decay 0</B> : Standard method (N309)</P>
    
    <P> <B>Plasma decay 1</B> : <A HREF="#temps">Exponential decay</A>
      outboard using the distance along the target from the separatrix strike
      point as the distance for the decay.</P>
    
    <P> <B>Plasma decay 2</B> : <A HREF="#probei">Temperature and density
        taken from input data for rings in the SOL</A>. </P>
    
    <P> <B>Plasma decay 3</B> : Temperature and density taken from input data
      for rings in the SOL. <A HREF="#probei">Inner</A> and <A HREF="#probeo">Outer</A>
      plates may differ.</P>
    
    <P> <B>Plasma decay 4</B> : Temperature and density taken from input data
      for rings in the <B>SOL and Trap</B>. <A HREF="#probei">Inner</A> and
      <A HREF="#probeo">Outer</A> plates may differ.</P>
    
    <P> <B>Plasma decay 5</B> : <A HREF="#temps">Exponential Decay Outboard</A>
      using the straight-line distance of the target point from the separatrix
      strike point as the distance for the decay. </P>
    
    <P> <B>Plasma decay 6</B> : <A HREF="#temps">Exponential Decay Outboard</A>
      as in option 5 except that different exponential decay factors are
      specified for the main SOL and Private Plasma target regions. </P>
    
    <P> <B>Plasma decay 7</B> : Temperature and density taken from input data
      for rings in the main SOL, Private Plasma and the Core. <A HREF="#probei">Inner</A>
      and <A HREF="#probeo">Outer</A> plates may differ.</P>
    
    <P> <B>Plasma decay 90</B> : Compound Background Plasma Option. The
      background plasma is created by using different options for different
      half-rings throughout the plasma. <A HREF="#pwbg">The specific input
        lines are described below.</A> The plasma solution can be iterated
      through several PIN iterations. Option 90 uses an EDGE2D or other fluid
      code solution as the basis and overlays the other specified pieces of the
      solution over the different segments of the grid.</P>
    
    <P> <B>Plasma decay 91 </B>: Compound Background Plasma Option.
      <A HREF="#pwbg">This option also creates a piece wise assembled
        background plasma</A> by allowing a great deal of flexibility in what
      options are allowed for each half-ring. This option uses the given input
      values for the regular SOL options combined with an assumed plasma decay
      option of 4 to generate a base background plasma. The specified pieces are
      then overlaid on top of this.</P>
    
    <P> <B>Plasma decay 98 </B>: Read data from a DIVIMP formatted plasma
      transfer file written by a previous DIVIMP run. A plasma file can be
      created on any DIVIMP run by setting the print option equal to 10. </P>
    
    <P> <B>Plasma decay 99</B> : From data file.</P>
    
    <P><B>Note:</B> Most Plasma Decay options (e.g. 3 and 4) may be used to
      assign uniform values to the entire plasma region and not just at the
      targets. Other temperature gradient options may then take these values
      that have been assigned to the entire plasma and change them. For example,
      SOL option 13 will use the values entered through these options as target
      specifications. Temperature gradient option 1 on the other hand will
      interpret values entered through using plasma option 3 or 4 as the
      mid-plane temperatures and densities.</P>
    
    <P></P>
    
    <H3><A NAME="pwbg">Piece-Wise Background Plasma Option Inputs</A></H3>
    
    <P>These input lines describe the options to be overlaid onto various
      pieces of the background plasma. For example, this can be used to allow
      for detachment of only a few rings at the inside target while solving for
      all the rest of the half-rings normally. The input consists of two values.
      I line indicating the number of lines of input - or pieces to be overlaid
      on the base background. This is followed by the specifications of options
      to be used for each piece including the rings to which those options
      should be applied.</P>
    
    <P> e.g. </P>
    
    <P> </P>
    
    <P><CODE> ' ' 'BG PLASMA Options by Ring (PlasDec Opts 90 &amp; 91) '</CODE></P>
    
    <P><CODE> ' R1,R2,Sect, PlasDec, SOL, Teg, Tig, Core, Efield ' 2 </CODE></P>
    
    <P><CODE> 1 16 3 4 0 0 0 1 3 </CODE> </P>
    
    <P><CODE> 17 28 2 4 21 0 0 0 3 </CODE> </P>
    
    <P>The input specifications are as follows. R1 to R2 represent the range of
      rings to be affected. In this case 1 to 16 and 17 to 28 respectively. The
      next integer represents the section of the ring to be affected. Section 1
      = the first section of the ring (IK=1 to the midpoint) or the OUTER target
      for JET grids (INNER target for SONNET grids). Section 2 = the second
      section of the ring (IK = midpoint to NKS(IR)) or the INNER half of the
      ring for JET Grids (OUTER half for SONNET grids). Section 3 = the entire
      ring. PlasDec is the Plasma Decay option to be applied to the specified
      region. SOL is the SOL option for the specified region. Teg and Tig are
      the temperature gradient options to be applied. Finally, Core and E-field
      are the core and e-field options to be applied to the specified region. If
      the region is not a core ring, the core option will be ignored. Similarly,
      the SOL options will have no effect if a core ring region is being
      calculated. </P>
    
    <P></P>
    
    <H3><A NAME="e2dbg">Read FLUID CODE (e.g. EDGE2D/UEDGE) Background for Reference</A></H3>
    
    <P><B>Edge2D Reference Option 0</B>: OFF- An Edge2D background will not be
      read.</P>
    
    <P><B>Edge2D Reference Option 1</B>: ON- An Edge2D background - whose name
      was specified to the DIVIMP execution script - will be read in and stored
      for comparison to the calculated DIVIMP background plasma. </P>
    
    <P><B>Edge2D Reference Option 2</B>: ON - SONNET based (i.e. B2 or UEDGE)
      background plasma is read in for reference.</P>
    
    <P><B>Note:</B> The purpose of this option is to allow easy comparison
      between DIVIMP calculated background plasma results and equivalent Edge2D
      results. The values read in are passed to the OUT program and are then
      plotted on the same graph with the DIVIMP values in order to provide a
      direct method of comparison. </P>
    
    <P> </P>
    
    <H3><A NAME="e2dtar">Fluid Code Target Condition Usage Option</A></H3>
    
    <P> This option will read the target conditions from an EDGE2D case using
      one of five different methods and make them available to the DIVIMP SOL
      background routines. It also allows these conditions to be extracted and
      passed to NIMBUS. </P>
    
    <P><B>FLUID CODE Target Opt 0</B>: OFF. FLUID CODE data that has been read in not
      used to assign the initial target conditions.</P>
    
    <P><B>FLUID CODE Target Opt 1</B>: ON. 

     <P>EDGE2D data is read using the standard
      method and is applied as the target conditions. The standard EDGE2D method uses
      the following formulae</P>
    
    <P> N-target = N-centre-of-first-cell </P>
    
    <P> Ti-target= Ti-centre-of-first-cell</P>
    
    <P> Te-target= Te-centre-of-first-cell</P>
    
    <P> V-target = E2D-mach-number * Cs </P>

    <P>For UEDGE or other B2 like codes the data is read using the standard
      method and is applied as the target conditions. The standard UEDGE method uses
      the following formulae</P>
    
    <P> N-target = N-centre-of-first-cell </P>
    
    <P> Ti-target= Ti-guard-cell</P>
    
    <P> Te-target= Te-guard-cell</P>
    
    <P> V-target = V-cell-edge (for each target)
    
    <P><B>EDGE2D Target Opt 2</B>: ON. EDGE2D data is read from the plasma
      file. In addition the EDGE2D down fluxes MUST be supplied so that the
      target conditions can be properly extracted.</P>
    
    <P> V-target,Te-target and Ti-target as option 1. </P>
    
    <P> N-target = G-target/V-target </P>
    
    <P><B>EDGE2D Target Opt 3</B>: ON. EDGE2D target values are calculated as
      in option 1. However, the EDGE2D down fluxes are also loaded and are
      passed to NIMBUS as the target fluxes for each segment. The target
      conditions and fluxes will not necessarily agree. </P>
    
    <P><B>EDGE2D Target Opt 4</B>: ON. EDGE2D data read for target. EDGE2D
      down fluxes are also read. </P>
    
    <P> N-target,Te-target and Ti-target as option 1. </P>
    
    <P> V-target = G-target/N-target</P>
    
    <P><B>EDGE2D Target Opt 5</B>: ON. EDGE2D data read for
      target. EDGE2D down fluxes for both particles and power are also
      read. The target conditions are calculated as described in option
      2.</P>

    <P><B>EDGE2D Target Opt 6</B>: ON. EDGE2D data read for
      target. This is the same as option 1 except that the velocity is 
      explicitly set to the sound speed based on the extracted target
      conditions rather than being based on the EDGE2D mach number. </P>

    <P></P>
    
    <H3><A NAME="cxrec">CX Recomb</A></H3>
    
    <P> <B>CX Recomb option 0</B> : No charge exchange recombination</P>
    
    <P> <B>CX Recomb option 1</B> : Nh = <A HREF="#nho">Nho</A> (constant)
      and Vcx = sqrt(2Tb/Mb) where Nho given.</P>
    
    <P> <B>CX Recomb option 2</B> : Nh = <A HREF="#nho">Nho</A> (constant)
      with constant <A HREF="#vcx">Vcx</A> (given) where Nho given.</P>
    
    <P> <B>CX Recomb option 3</B> : Nh = <A HREF="#nhc">Nhc</A>, Constant in
      core.</P>
    
    <P> Nh = <A HREF="#nho">Nho</A> * exp( -S/<A HREF="#lamhx">lamhx</A>),
      Exponential decay from the plates in the SOL.</P>
    
    <P> where Nho, Nhc and lamhx are given. S is the distance from the plates
      along the field lines.</P>
    
    <P> <B>CX Recomb option 4</B> : Nh from PIN with Vcx = sqrt(2 Tb / Mb)</P>
    
    <P> <B>CX Recomb option 5</B> : Nh from PIN with constant <A HREF="#vcx">Vcx.</A></P>
    
    <P> <B>CX Recomb option 6</B> : Nh from PIN with Charge exchange
      Coefficient Data (CCD) taken from ADAS.</P>
    
    <P> <B>CX Recomb option 7</B> : ADPAK/INEL CX rates. CX rates are
      extracted from B2-FRATES or INEL formatted atomic information database. Nh
      is supplied either by PIN or by loading as an auxiliary quantity to the
      background plasma specification.</P>
    
    <P> <B>CX Recomb option 8</B> : Nh from PIN. &lt;SIGMA V&gt; cx rates have
      been taken from the PhD thesis of C.F.MAGGI and have been fitted to a
      three parameter exponential by Tom Rognlien (LLNL).</P>

    <P> <B>CX Recomb option 9</B> : Nh from PIN. &lt;SIGMA V&gt; cx rates have
      been taken from the PhD thesis of C.F.MAGGI and have been fitted to a
      modified three parameter exponential by Tom Rognlien (LLNL) The modified 
      coefficients reduce the CX recombination rates extrapolated from the Maggi data for
      low temperature conditions.</P>
    
    <P> </P>
    
    <H3><A NAME="fdiff">First diffusion</A></H3>
    
    <P> <B>First diffusion 0</B> : instant</P>
    
    <P> <B>First diffusion 1</B> : after randomly generated time interval</P>
    
    <P> <B>First diffusion 2</B> : after ion has existed for time = Tau
      parallel</P>
    
    <P></P>
    
    <H3><A NAME="dpopt">Dperp option</A></H3>
    
    <P> <B>Dperp option 0</B> : constant</P>
    
    <P> <B>Dperp option 1</B> : Dperp = Dperp0.Nb0/Nb in SOL&amp;Trap</P>
    
    <P> Constant Dperp0 in Main</P>
    
    <P> <B>Dperp option 2</B> : Dperp is held constant along the reference
      line at knot number NKS(IRSEP)/2 +1. Cross-field transport elsewhere is
      based on moving particles in proportion to their equivalent cross-field
      position on the reference line. Transport in the Private Plasma is mapped
      relative to the adjacent cell on the separatrix at the IK=1 index which is
      then mapped back to the reference line. </P>
    
    <P> <B>Dperp option 3</B> : <B>UNTESTED</B>. Spatially varying Dperp. The
      value of Dperp in each cell is allowed to changed so that the number of
      Dperp steps required to cross a cell remains consatnt along a field line.
      The Private Plasma Dperp is set to match the corresponding cells on the
      separatrix. The actual cross-field steps are done proportional to cell
      sizes so that a particle taking a step from one cell to the next can step
      back to its starting position despite the differing Dperp values in the
      adjacent cells. </P>
    
    <P> <B>Dperp option 4</B> : <B>UNTESTED</B>. As option 3 except that the
      private plasma Dperp values are varied to try to try to keep the number of
      steps consistent instead of matching the Dperp on the separatrix.</P>
    
    <P> </P>
    
    <H3><A NAME="perpst">Perpendicular Step Option</A> </H3>
    
    <P> <B>Perp. Step Opt 0</B> : Constant - The probability of inward and
      outward cross-field diffusive steps is constant everywhere at a value of
      0.5 </P>
    
    <P><B>Perp. Step Opt 1</B> : Geometrically Varying for Core Only - The
      probability of making an inward or outward cross-field diffusive step
      within the core region is equal to the ratio of the lengths of the sides
      parallel to the field lines of a small cell located at the current
      particle position. In the SOL and private plasma the probability of a
      cross-field step is as calculated in option 0. </P>
    
    <P><B>Perp. Step Opt 2</B> : Geometrically Varying for the entire grid -
      The probability of making an inward or outward cross-field diffusive step
      in all regions is equal to the ratio of the lengths of the sides parallel
      to the field lines of a small cell located at the current particle
      position.</P>
    
    <P><B>Perp. Step Opt 3</B> : Geometrically Varying for the entire grid -
      The probability of making an inward or outward cross-field diffusive step
      in all regions is equal to the ratio of the lengths of the sides parallel
      to the field lines of a small cell located at the current particle
      position. This is calculated for each half-cell independently. </P>
    
    <P> </P>
    
    <H3><A NAME="pinch">Pinch Velocity Option</A></H3>
    
    <P> <B>Pinch Velocity Opt 0</B> : OFF. No Pinch Velocity Applied.</P>
    
    <P><B>Pinch Velocity Opt 1</B> : ON. Pinch Velocity is applied at the
      <A HREF="#vpinch">specified value</A> everywhere on the grid. </P>
    
    <P><B>Pinch Velocity Opt 2</B> : ON. Pinch Velocity is applied at the
      <A HREF="#vpinch">specified value</A> only in the main SOL.</P>

    <P><B>Pinch Velocity Opt 3</B> : ON. Pinch Velocity is applied with the
      <A HREF="#vpinch">value specified</A> at the separatrix. The pinch is only
       applied in the core and is scaled proportional to the square of the poloidal
       field line length
       as a particle moves deeper into the core.</P>
    
    <P> </P>
    
    <H3><A NAME="tegrad">TeB Gradient option</A></H3>
    
    <P> <B>TeB Gradient 0 </B>: Linear, from <A HREF="#temps">TeB0</A>.<A HREF="#grads">feBt</A>
      at Target to TeB0</P>
    
    <P> at feBL.Smax, then constant</P>
    
    <P> <B>TeB Gradient 1</B> : Linear from <A HREF="#temps">Teb0</A>*<A HREF="#grads">Febt</A>
      at target to TeB0*Febt2</P>
    
    <P> at Febl*Smax to TeB at Febl2*Smax, then constant.</P>
    
    <P> <B>TeB Gradient 2</B> : P/A driven gradients. <A HREF="#powden">P/A</A>
      and <A HREF="#k0">K0</A> are given</P>
    
    <P> <B>TeB Gradient 3</B> : P/A driven gradients. <A HREF="#k0">K0</A>
      given. Based on input data/ring.</P>
    
    <P> <IMG SRC="images/divref-114.gif" WIDTH="240" HEIGHT="40"></P>
    
    <P> <B>TeB Gradient 4</B> : P/A driven gradients. <A HREF="#k0">K0</A>
      given. P/A calculated as above. The input data for inner and outer plates
      may differ. A factor of 7/4 is assumed in the heat transport equation.</P>
    
    <P> <B>TeB Gradient 5</B> : P/A driven gradients. K0 given. The input data
      for inner and outer plates may differ. A factor of 7/4 is assumed in the
      heat transport equation.</P>
    
    <P> <IMG SRC="images/divref-115.gif" WIDTH="175" HEIGHT="40"></P>
    
    <P> <B>TeB Gradient 6</B> : Identical to option 4 except a factor of 7/2
      is assumed in the heat transport equation.</P>
    
    <P> <B>TeB Gradient 7</B> : Identical to option 5 except a factor of 7/2
      is assumed in the heat transport equation.</P>
    
    <P> <B>TeB Gradient 98</B> : Read data from DIVIMP generated background
      plasma file - this option must be used in combination with plasma decay
      option 98.</P>
    
    <P> <B>TeB Gradient 99</B> : Read from file.</P>
    
    <P> </P>
    
    <P> </P>
    
    <H3><A NAME="tigrad">TiB Gradient option</A> </H3>
    
    <P> <B>TiB Gradient 0</B> : Linear, from <A HREF="#temps">TiB0</A>.<A HREF="#grads">fiBt
      </A>at Target to TiB0</P>
    
    <P> at fiBL.Smax, then constant</P>
    
    <P> <B>TiB Gradient 1</B> : Linear from <A HREF="#temps">Tib0</A>*<A HREF="#grads">Fibt</A>
      at target to TiB0*Fibt2</P>
    
    <P> at Fibl*Smax to TiB at Fibl2*Smax, then constant.</P>
    
    <P> <B>TiB Gradient 2</B> : P/A driven gradients. <A HREF="#powden">P/A</A>
      and <A HREF="#k0">K0</A> are given</P>
    
    <P> <B>TiB Gradient 3 </B>: P/A driven gradients. K0 given. Based on input
      data/ring.</P>
    
    <P> <IMG SRC="images/divref-27.gif" WIDTH="308" HEIGHT="50"></P>
    
    <P> <B>TiB Gradient 4</B> : P/A driven gradients. K0 given. P/A calculated
      as above. The input data for inner and outer plates may differ. A factor
      of 7/4 is assumed in the heat transport equation.</P>
    
    <P> <B>TiB Gradient 5</B> : P/A driven gradients. <A HREF="#k0i">K0<SUB>i</SUB></A>
      given. The input data for inner and outer plates may differ. A factor of
      7/4 is assumed in the heat transport equation.</P>
    
    <P> <IMG SRC="images/divref-28.gif" WIDTH="221" HEIGHT="50"></P>
    
    <P> <B>TiB Gradient 6</B> : Identical to option 4 except a factor of 7/2
      is assumed in the heat transport equation.</P>
    
    <P> <B>TiB Gradient 7</B> : Identical to option 5 except a factor of 7/2
      is assumed in the heat transport equation.</P>
    
    <P> <B>TiB Gradient 98 </B>: Read data from DIVIMP generated background
      plasma file - this option must be used in combination with plasma decay
      option 98.</P>
    
    <P> <B>TiB Gradient 99</B> : Read from file</P>
    
    <P> </P>
    
    <H3> <A NAME="tegcoe">TeB Grad Coeff option</A></H3>
    
    <P> <B>TeB Grad Coeff 0</B> : alphae = 0</P>
    
    <P> <B>TeB Grad Coeff 1</B> : alphae = 0.71 Zi.Zi</P>
    
    <P> <B>TeB Grad Coeff 2</B> : alphae = 1.5(1-0.6934(1.3167**-Zi))Zi.Zi</P>
    
    <P> <B>TeB Grad Coeff 3</B> : alphae = 0.71 Zi.Zi</P>
    <P> Feg is set to zero for S values as measured from either target that are 
        greater than the <a href="#stgrad"> specified value</a>. </p>

    <P> </P>
    
    <H3> <A NAME="tigcof">TiB Grad Coeff option</A></H3>
    
    <P> <B>TiB Grad Coeff 0</B> : betai = 0</P>
    
    <P> <B>TiB Grad Coeff 1</B> : betai=-3(1-mu-5.Zi.Zi.sqrt(2mu)mu(1.1mu-
      0.35))/(2.6-2mu+5.4mu.mu), mu=mi/(mi+mb)</P>
    
    <P> <B>TiB Grad Coeff 2</B> : betai=H(ZO)Zi.Zi/(ZO+sqrt(0.5(1+mb/mi)))</P>
    
    <P> where H(ZO)=1.56(1+1.41ZO)(1+0.52ZO)/ ((1+2.65ZO)(1+0.285ZO))</P>
    
    <P> where <A HREF="#zo">ZO</A> given.</P>

    <P> <B>TiB Grad Coeff 3</B> : betai=-3(1-mu-5.Zi.Zi.sqrt(2mu)mu(1.1mu-
      0.35))/(2.6-2mu+5.4mu.mu), mu=mi/(mi+mb)</P>
    <P> Feg is set to zero for S values as measured from either target that are 
        greater than the <a href="#stgrad"> specified value</a>. </p>

    <P> </P>
    
    <H3><A NAME="flattg">Forced Flat Temperature Gradient Option</A> </H3>
    
    <P> <B>Flatten Gradient Opt 0</B>: OFF. Temperature profiles are not
      flattened. </P>
    
    <P> <B>Flatten Gradient Opt 1</B>: ON. Temperature profiles are flattened
      at their current values for S or (SMAX-S) &gt; SMAX * F<SUB>cut</SUB></P>
    
    <P> <B>Flatten Gradient Opt 2</B>: ON. Temperature profiles for S &gt;
      SMAX * F<SUB>cut</SUB> are limited to a maximum of the value at the
      position SMAX * F<SUB>cut</SUB>.</P>
    
    <P> </P>
    
    <H3><A NAME="tegfcu">Te Gradient Cut-off for Flattening Option</A></H3>
    
    <P> This is the F<SUB>cut</SUB> factor that will be used for the Electron
      Temperature profile flattening. If this value is specified as 0.0 then no
      flattening or cutting off of the temperature rise will occur. </P>
    
    <P> </P>
    
    <H3><A NAME="tigfcu">Ti Gradient Cut-off for Flattening Option</A> </H3>
    
    <P> This is the F<SUB>cut</SUB> factor that will be used for the Ion
      Temperature profile flattening. If this value is specified as 0.0 then no
      flattening or cutting off of the temperature rise will occur. </P>
    
    <P> </P>
    
    <H3><A NAME="tgfmod">Temperature Gradient Force - Modification Option</A></H3>
    
    <P> <B>T-Grad Mod Opt 0</B> : Off - the temperature gradient forces are
      not modified from their values calculated on the basis of fluid
      assumptions. (i.e. a sufficiently collisional plasma). The modification
      array is set to 1.0 everywhere. </P>
    
    <P> <IMG SRC="images/divref-29.gif" WIDTH="156" HEIGHT="31"></P>
    
    <P> </P>
    
    <P> <B>T-Grad Mod Opt 1</B> : On - the temperature gradient forces are
      modified by a multiplicative factor which is an attempt to include kinetic
      effects in the underlying force equations. The following formula is taken
      from the correction term used in the UEDGE code. </P>
    
    <P> <IMG SRC="images/divref-30.gif" WIDTH="300" HEIGHT="103"></P>
    
    <P> </P>
    
    <P><A HREF="#tgmodf"> <IMG SRC="images/divref-31.gif" WIDTH="241" HEIGHT="28"></A></P>
    
    <P> <IMG SRC="images/divref-32.gif" WIDTH="138" HEIGHT="31"></P>
    
    <P> <IMG SRC="images/divref-33.gif" WIDTH="295" HEIGHT="63"></P>
    
    <P> <IMG SRC="images/divref-34.gif" WIDTH="468" HEIGHT="33"></P>
    
    <P> <B>T-Grad Mod Opt 2</B> : On - This is identical to option 1 except
      that the value for F<SUB>T-grad-mod</SUB> is equal to 0.0 for the ion
      temperature gradient force when within one ion mean free path length of
      the target.</P>
    
    <P><B> T-grad Mod Opt 3</B> : On - the temperature gradient forces are
      modified by a multiplicative factor which is an attempt to include kinetic
      effects in the underlying temperature gradient calculations. This option
      is based on the methods used in the Garching-B2 code with an additional
      parameter to provide the ability to change the magnitude of the effect to
      allow for which specific mean-free path is to be used. This option limit
      the temperature gradient directly as opposed to generating a 
      multiplicative factor that modifies the final calculated force. The
      temperature gradients are found using the following relation. (Applied to
      both electrons and ions.)</P>
    
    <P> <IMG SRC="images/divref-35.gif" WIDTH="260" HEIGHT="63"></P>
    
    <P><A HREF="#tgmodf"> <IMG SRC="images/divref-36.gif" WIDTH="408" HEIGHT="28"></A></P>
    
    <P> <IMG SRC="images/divref-37.gif" WIDTH="420" HEIGHT="28"></P>
    
    <P> <IMG SRC="images/divref-38.gif" WIDTH="203" HEIGHT="71"></P>
    
    <P> </P>
    
    <P> <B>T-grad Mod Opt 4</B> : On - This is identical to option 1 except
      that the value for F<SUB>T-grad-mod</SUB> is equal to 0.0 for both the
      ion and electron temperature gradient force when within one ion mean free
      path length of the target.</P>
    
    <P> </P>
    
    <H3><A NAME="traptg">Trap Tgrad option</A></H3>
    
    <P> <B>Trap Tgrad 0</B> : Off. Tgrad options are not applied in the
      trapped plasma. Temperature and density are constant.</P>
    
    <P> <B>Trap Tgrad 1</B> : On. The specified temperature gradient or SOL
      option are applied to the trap region as if they were a standard SOL ring.</P>
    
    <P> <B>Trap Tgrad 2</B> : On. The Private Plasma Conditions are completely
      specified by two (x,f(x)) points for each of density, electron
      temperature, ion temperature and velocity. Each quantity is constant out
      to the mid-plane at the value of the second point. <A HREF="#ppspec">The
        specific input parameters defining these points are described later in
        this document.</A> </P>
    
    <P> <B>Trap Tgrad 3</B> : On. Plasma conditions in the private plasma
       region are calculated from experimental Thomson measurements. All data
       for each flux tube are averaged and this value is then assigned to all 
       cells on the flux tube. The target conditions are taken from the input
       Langmuir probe values. </p>

    <P> <B>Trap Tgrad 4</B> : On. Plasma conditions in the private plasma
       region are calculated from experimental Thomson measurements. All data
       for each flux tube are averaged and this value is then assigned to all 
       cells on the flux tube. The target conditions are then set to equal the
       flux tube values. </p>

    <P> </P>
    
    <H3><A NAME="contsw">Control switch</A></H3>
    
    <P> <B>Control switch 0</B> : NEUT on: follow atoms to ionization
      positions</P>
    
    <P> <B>Control switch 1</B> : NEUT off: inject ions as &quot;initial state&quot;
      option</P>
    
    <P> </P>
    
    <H3> <A NAME="launch">Launch</A></H3>
    
    <P> <B>Launch option 0</B> : Distributed launch along target</P>
    
    <P> <B>Launch option 1</B> : At given (<A HREF="#initrz">R</A>,<A HREF="#initrz">Z</A>)</P>
    
    <P><B>Launch option 2</B> : Homogeneously along walls - different wall
      definitions are possible.</P>
    
    <P><B>Launch option 3</B> : Distributed launch along Target due to
      hydrogenic ion impact utilizing PIN/NIMBUS data.</P>
    
    <P><B>Launch option 4</B> : Distributed launch along &quot;Wall&quot;
      surfaces due to hydrogen ATOM impact utilizing PIN/NIMBUS data for wall
      fluxes and wall definitions. Walls are defined as all vessel surfaces
      including the target segments. Wall coordinates are passed to DIVIMP from
      NIMBUS.</P>
    
    <P><B>Launch option 5</B> : <A HREF="#2dva">2D Distributed Launch</A>.
      Neutral particles are launched from a selection of cell centres on the
      grid. The probability of launch from a given cell centre is taken from an
      externally supplied distribution function. The only currently supported
      distribution function is the Carbon neutral recombination rate that has
      been imported from some UEDGE modelling of DIIID.</P>
    
    <P> </P>
    
    <H3><A NAME="vaflag">Vel/angle flag</A></H3>
    
    <P> <B>Vel/angle flag 0</B> : theta =+/-asin($), $ in (0,1)</P>
    
    <P> Vin=sqrt(2Ebd/(Mi.(1/sqrt($)-1))), $ in (0,1)</P>
    
    <P> <B>Vel/angle flag 1</B> : theta = atan(tan(beta)cos(phi))</P>
    
    <P> Vin=sqrt(2Ebd/Mi.(1/sqrt($)-1)) $ &lt; $max</P>
    
    <P> *sqrt(|cos(beta)**2+sin(beta)**2.cos(phi)**2|)</P>
    
    <P> <B>Vel/angle flag 2</B> : theta = atan(tan(beta)cos(phi))</P>
    
    <P> Vin=sqrt(2Tg/Mi).sqrt(abs(ln(1-$))), $ in(0,1)</P>
    
    <P> Gas temperature given</P>
    
    <P> <B>Vel/angle flag 3</B> : theta =+/-asin(sqrt($)), $ in (0,1)</P>
    
    <P> Vin = sqrt(2Ein/Mi), Initial energy Ein given</P>
    
    <P> <B>Vel/angle flag 4</B> : theta = atan(tan(beta)cos(phi))</P>
    
    <P> Vin=sqrt(2Ebd/Mi.(1/sqrt($)-1)) $ &lt; $max</P>
    
    <P> *sqrt(|cos(beta)**2+sin(beta)**2.cos(phi)**2|)</P>
    
    <P> Emax-factor given</P>
    
    <P> <B>Vel/angle flag 5</B> : theta =+/-asin(sqrt($)), $ in (0,1)</P>
    
    <P> Vin = sqrt(2Ebd/Mi.(1/sqrt($)-1)) $ &lt; $max</P>
    
    <P> Emax-factor given</P>
    
    <P> <B>Vel/angle flag 6</B> : theta = 0</P>
    
    <P> Vin = sqrt(2Ein/Mi), Initial energy Ein given</P>
    
    <P> <B>Vel/angle flag 7</B> : theta=+/-acos((1-$)**1/3), $ in (0,1) &quot;Free
      Jet&quot;</P>
    
    <P> Vin = sqrt(2Ein/Mi), Initial energy Ein given</P>
    
    <P> <B>Vel/angle flag 8</B> : theta = 2pi$, $ in (0,1) &quot;Isotropic&quot;</P>
    
    <P> Vin = sqrt(2Ein/Mi), Initial energy Ein given</P>
    
    <P> <B>Vel/angle flag 9</B> : theta =+/-asin(sqrt($)), $ in (0,1)</P>
    
    <P> Vin = sqrt(2Ein/Mi), where two given values</P>
    
    <P> are used alternately for Ein</P>
    
    <P> <B>Vel/angle flag 10</B> : beta = acos((1-$)**1/3) &quot;3D Free Jet&quot;</P>
    
    <P> psi = 2pi$, $ in (0,1)</P>
    
    <P> Vin = sqrt(2Ein/Mi), Initial energy Ein given</P>
    
    <P> <B>Vel/angle flag 11</B> : theta=+/-acos((1-$)**1/3) 0&lt;$&lt;1 &quot;2.5D
      Free Jet&quot;</P>
    
    <P> P0 assigned randomly in range (-Pmax,Pmax)</P>
    
    <P> Vin = sqrt(2Ein/Mi), Initial energy Ein given</P>
    
    <P> <B>Vel/angle flag 12</B> : Emission at a constant energy specified by
      the input quantity EIN (CTEM1) into a cos**N distribution where N is also
      a specified input.</P>
    
    <P> <B>Vel/angle flag 13</B> : Emission at a temperature (Tg) into a
      cos**N distribution. Tg is specified by the same input quantity (CTEM1) as
      in V/A flag 12. N is also a specified input as in V/A flag 12.</P>
    
    <P> <B>Vel/angle flag 14</B> : theta = atan(tan(beta)cos(phi))</P>
    
    <P> Vin=sqrt(2Etarg/Mi.) * VMULT * </P>
    
    <P> *sqrt(|cos(beta)**2+sin(beta)**2.cos(phi)**2|)</P>
    
    <P> Where VMULT = input multiplication factor. </P>
    
    <P> <B>Vel/angle flag 15 </B>: theta = 2pi$, $ in (0,1) &quot;Isotropic&quot;</P>
    
    <P> Vin = sqrt(Ti/Mi) * VVMULT , Ti = local ion temperture. VMULT = input
      multiplication factor. </P>
    
    <P> </P>
    
    <H3><A NAME="suplau">Supplementary Launch option</A></H3>
    
    <P> These are identical to the possible <A HREF="#launch">launch options</A>
      and apply to any supplementary neutral launches.</P>
    
    <P> </P>
    
    <P> <B>Sup. Launch opt -1</B> : Set value to the same as the primary
      launch option.</P>
    
    <P> </P>
    
    <H3><A NAME="supva">Supplementary Velocity/Angle flag</A></H3>
    
    <P> These are identical to the possible <A HREF="#vaflag">V/A flag</A>
      options and apply to any supplementary neutral launches.</P>
    
    <P> <B>Sup. V/A flag opt -1</B> : Set value to the same as the primary V/A
      flag option.</P>
    
    <P> </P>
    
    <H3><A NAME="initva">Initial Neutral Velocity/Angle Flag</A></H3>
    
    <P> These are identical to the possible <A HREF="#vaflag">V/A flag</A>
      options and apply to any the initial group of neutral launches only. This
      allows such for simulations of a free-space neutral pellet ablation
      followed by regular self-sputtering. Each of which has quite different
      characteristic Velocity/Angle source distributions.</P>
    
    <P><B> Init. Neut. V/A opt -1</B>: Set value to the same as the primary
      V/A flag option.</P>
    
    <P> </P>
    
    <H3><A NAME="extra2d">Extra 2D Neutral Launch Option</A></H3>
    
    <P> <B>2D Neut. Launch Opt 0</B> : OFF. No 2D neutral source is used.</P>
    
    <P> <B>2D Neut. Launch Opt 1</B> : ON. A 2D source of impurity neutrals -
      equivalent to launch option 5 is launched in addition to all other
      specified impurity sources. Each source is weighted according to its
      relative production strength. This option is required in order to allow
      for both wall and target particle sources as well as 2D distributed
      impurity neutral sources. This could be either modelling recombined
      impurities or modelling a puff of some description in addition to regular
      target production. </P>
    
    <P> </P>
    
    <H3><A NAME="2dva">2D Neutral Launch - Velocity/Angle flag option</A></H3>
    
    <P> This takes the same options as those described in the <A HREF="#vaflag">Velocity/Angle
        flag</A> above. This Velocity/Angle flag is applied to any particles
      launched using the 2D Neutral Launch described in the previous option.
    </P>
    
    <P> </P>
    
    <H3><A NAME="physpd">Physical Sputter Data - Source Option</A></H3>
    
    <P> <B>Sputter Data Option 1</B>: Data is taken from earlier publications.</P>
    
    <P> <B>Sputter Data Option 2</B>: Data is taken from Eckstein (1993)</P>
    
    <P> <B>Sputter Data Option 3</B>: Data is based on Eckstein (1993) with
      small changes to H,D,T coefficients taken from Garcia-Rosales and
      Roth(1996)</P>
    
    <P> <B>Sputter Data Option 4</B>: Specified CONSTANT yield value.</P>

    <P> <B>Sputter Data Option 5</B>: Data is based on Eckstein (1993) with
      small changes to H,D,T coefficients taken from Garcia-Rosales and
      Roth(1996). A customized routine has been created for the W sputtering
      values and is used instead of the Eckstein values for this option.</P>
    
    <P> </P>
    
    <H3><A NAME="chspd">Chemical Sputter Yield Option</A></H3>
    
    <P> <B>Chemical Sputter Opt 1</B>: DIVIMP implementation - yield formulae
      from Garcia-Rosales/Roth (1994)</P>
    
    <P><B>Chemical Sputter Opt 2</B>: DIVIMP implementation - yield formulae
      from Garcia-Rosales/Roth (1996)</P>
    
    <P><B>Note:</B> Options 3 to 7 correspond exactly to chemical sputtering
      options 1 through 5 as they are implemented in NIMBUS. The identical code
      for calculating these yields has been incorporated into DIVIMP. </P>
    
    <P><B>Chemical Sputter Opt 3</B>: NIMBUS option 1 - Garcia-Rosales/Roth
      (EPS'94)</P>
    
    <P><B>Chemical Sputter Opt 4</B>: NIMBUS option 2 - Pospieszczyk (EPS'95)</P>
    
    <P><B>Chemical Sputter Opt 5</B>: NIMBUS option 3 - Vietzke</P>
    
    <P><B>Chemical Sputter Opt 6</B>: NIMBUS option 4 - Haasz</P>
    
    <P><B>Chemical Sputter Opt 7</B>: NIMBUS option 5 - Garcia-Rosales/Roth
      (1996)</P>
    
    <P><B>Chemical Sputter Opt 8</B>: NIMBUS option 6 - Haasz (1997) - (Brian
      Mech PhD)</P>
    
    <P> <B>Chemical Sputter Opt 9</B>: Specified CONSTANT yield value.</P>
    
    <P> <B>Chemical Sputter Opt 10</B>: Based on Haasz (1997) - (Brian
      Mech PhD Thesis).  Modified to reduce the yield to 1/5 of its value as the
      temperature drops from 10eV to >5eV. Constant at 1/5 below 5eV.</p>

    <P> </P>
    
    <H3><A NAME="sput">Sputter Option</A></H3>
    
    <P> <B>Sputter option 0</B> : Sputtering by background ions (Mb,Zb) only</P>
    
    <P> Eimp=Tb(2+3Zb) Emax=Eimp.gamma(1-gamma)-Ebd</P>
    
    <P> <B>Sputter option 1</B> : Sputtering by specified ion type only</P>
    
    <P> Eimp=Tb(2+3Zimp) Emax=Eimp Zimp given</P>
    
    <P> <B>Sputter option 3</B> : Initial sputtering by background ions only.</P>
    
    <P> Eimp=Tb(2+3Zb) Emax=Eimp.gamma(1-gamma)-Ebd</P>
    
    <P> <B>Sputter option 4 </B>: Initial sputtering by background ions only.</P>
    
    <P> Eimp=Tb(2+3Zb) Emax=Eimp.gamma(1-gamma)-Ebd</P>
    
    <P> The maximum energy of the distribution of self-sputtered particles
      resulting from the use of this option is multiplied by the EMAX-FACTOR
      described later (CEMAXF). Velocity/Angle flag 1 will be used for any
      self-sputtered particles. </P>
    
    <P> <B>Sputter option 5</B> : Initial Chemical Sputtering Source. The
      formula used to calculate the chemical sputtering is specified using the
      Chemical Sputtering Source Option defined above. The surface temperatures
      of the walls and the target can be specified separately and are defined
      later in this document. </P>
    
    <P> <B>Sputter option 6</B> : Initial COMBINED physical and chemical
      sputtering. Two groups of atoms are launched. The first is PHYSICALLY
      SPUTTERED using the Velocity/Angle flag specified by the Initial Neutral
      V/A flag option. The second group is CHEMICALLY SPUTTERED and uses a
      Velocity/Angle flag of 3 with the characteristic energy specified in the
      input. The ratio of particles launched through each mechanism is
      proportional to the total (BG FLUX) * (YIELD) for each sputter source.
    </P>
    
    <P> </P>
    
    <P> </P>
    
    <P><B>Note</B>: In previous versions of DIVIMP - sputter options of 3 or
      more were used to indicate that self-sputtering would be active. This is
      no longer the case. A separate switch has been added to turn
      self-sputtering On or Off. Thus there is some duplication of definition in
      the various sputter options.</P>
    
    <P> </P>
    
    <H3><A NAME="secspu">Secondary Sputter Option (TN1209)</A></H3>
    
    <P> These are identical to the possible <A HREF="#sput">Sputter options</A>
      listed above and apply to any supplementary neutral launches.</P>
    
    <P> </P>
    
    <P><B> Sup. Sputter opt -1</B>: Set value to the same as the primary
      sputter option.</P>
    
    <P> </P>
    
    <H3><A NAME="selfsp">Self Sputtering Option</A></H3>
    
    <P> <B>Self-Sputter Opt 0</B> : OFF. Self-sputtering cascade does not
      occur.</P>
    
    <P> <B>Self-Sputter Opt 1</B> : ON. Self-sputtering cascades are followed
      as usual based on the maximum number of generations of self-sputtering
      allowed to be followed, the minimum specified threshold yield allowed, and
      the calculated actual yield based on the particle impact energy for
      self-sputtering. </P>

    <P> <B>Self-Sputter Opt 2</B> : ON. Self-sputtering cascades are followed
      as usual based on the maximum number of generations of self-sputtering
      allowed to be followed and the minimum threshold yield. The yield for each
      segment is set at a separately specified fixed value. The energy of
      emitted sputter fragments is also fixed. This option was implemented to 
      allow for modelling of prompt re-emission of impurity species ions (particularly
      carbon) as they strike a target surface through mechanisms other than physical 
      sputtering</P>

    <P> </P>
    
    <H3><A NAME="normal">Normal</A></H3>
    
    <P> <B>Normal option 0</B> : Measure theta from surface normal</P>
    
    <P> <B>Normal option 1</B> : Measure theta from T degrees to X=0,
      <A HREF="#theta">T given</A></P>
    
    <P> Apply to primary neutrals only.</P>
    
    <P> <B>Normal option 2 </B>: Measure theta from T degrees to X=0,
      <A HREF="#theta">T given</A></P>
    
    <P> Apply to primary and self-sputtered neutrals.</P>
    
    <P></P>
    
    <H3><A NAME="neutsp">NEUT spreading</A></H3>
    
    <P> <B>NEUT spreading 0 </B>: OFF (Launch at meshpoints only)</P>
    
    <P> <B>NEUT spreading 1 </B>: NOT SUPPORTED ... (ON -Launch with variation
      in Y0)</P>
    
    <P> </P>
    
    <H3><A NAME="inionv">Initial Ion Velocity Option</A></H3>
    
    <P> <B>Initial ion Vel 0</B> : Vn=0.0</P>
    
    <P> <B>Initial ion Vel 1</B> : +/-0.5Vn along S</P>
    
    <P> <B>Initial ion Vel 2</B> : Vn along S away from Target</P>
    
    <P> <B>Initial ion Vel 3</B> : +/-sqrt($).Vn along S, $ in (0,1)</P>
    
    <P> </P>
    
    <H3><A NAME="ionwal">Ion Wall Option</A></H3>
    
    <P> The Ion Wall options specify the boundaries for ion transport in the
      DIVIMP code. This option is combined with the target option to define the
      region of allowed ion transport. This option applies to both the main SOL
      outer wall and private plasma outer wall definitions for ion transport.
    </P>
    
    <P> Ion Wall Option 0 : Ion walls mid-way between the center points of the
      outermost two rings on the grid. The outermost ring on both JET and Sonnet
      based grids is virtual and is used only to anchor the fluid solutions. As
      such, the plasma space mapped by the grid only extends to the midpoint
      between this virtual ring and the last real ring contained within it.</P>
    
    <P><B> Ion Wall Option 1</B> : Ion walls are at the outermost ring of the
      SOL. The center points of the virtual ring are used to define the ion wall
      position. </P>
    
    <P> <B>Ion Wall Option 2</B> : Ion walls are located at the polygon edge
      of the outermost complete ring of polygons defining the plasma region.
      This is almost equivalent to option 0 except that it uses the actual
      polygon definition of the last real ring to construct the outer wall for
      ion transport. Option 0 was the original option for DIVIMP grids that
      contained only the centre points and not the compete polygonal description
      of the grid. </P>
    
    <P> </P>
    
    <H3><A NAME="neutwa">Neutral Wall Option</A></H3>
    
    <P> The Neutral Wall options specify the boundaries for neutral transport
      in the DIVIMP code. In all cases the different neutral wall options link
      to the target and private plasma wall options to define a vessel boundary
      for neutral transport. This definition applies to the neutral walls
      bordering the main SOL region. The private plasma wall region for neutrals
      is defined in the next option.</P>
    
    <P> <B>Neut Wall Option 0</B> : Neutral walls are half-way between the
      center points of the outermost two rings on the grid.</P>
    
    <P> <B>Neut Wall Option 1</B> : Neutral walls are created by joining the
      center points of the outermost (virtual) ring.</P>
    
    <P> <B>Neut Wall Option 2</B> : Neutral walls are specified by a set of
      coordinates entered in the input file. </P>
    
    <P> <B>Neut Wall Option 3</B> : Neutral walls are specified by a set of
      points that have been hard-coded for specific JET grids in the subroutine
      loadgeo - located in the pindiv.d4a module. This option is old and has
      been superseded by options 4 and 5 - however, it may prove useful if it is
      ever necessary to often use a specific grid for which pre-generated wall
      data is either unavailable or inaccurate. </P>
    
    <P> <B>Neut Wall Option 4</B> : Neutral walls are specified by the vessel
      coordinates that are specified in the GRID2D geometry file that is read-in
      by DIVIMP.</P>
    
    <P> <B>Neut Wall Option 5</B> : Neutral walls are read-in from the
      PIN/NIMBUS transfer file. Although, the position of the walls is the same
      as in the GRID2D file, PIN/NIMBUS generally sub-divides the vessel surface
      for its own purposes in calculating data - as such it is necessary to load
      the PIN/NIMBUS version of the wall specification when using PIN/NIMBUS
      wall data in conjunction with DIVIMP. Use of this option requires that
      PIN/NIMBUS be run from within DIVIMP.</P>
    
    <P> <B>Neut Wall Option 6</B> : This option deals with walls whose
      segments are ordered counter-clockwise. It will invert the ordering of
      these wall segments so that they conform to the clockwise standard
      required by DIVIMP. This option then sets the neutral wall option to be
      option 4. This option should ONLY be used for VERY old JET grids where
      this is known to be a problem. </P>

    <P> <B>Neut Wall Option 7</B> : The main wall for neutrals is located at the outermost
      polygon edge of the last real (non-boundary) ring of the grid. </p>
    
    <P> </P>
    
    <H3><A NAME="trapwa">Trap Wall Option</A></H3>
    
    <P> <B>Trap Wall Option 0</B> : The wall for neutrals in the trap region
      is midway between the outermost two rings. </P>
    
    <P> <B>Trap Wall Option 1</B> : The wall for neutrals in the trap region
      is at the outermost ring. </P>
    
    <P> <B>Trap Wall Option 2</B> : The wall for neutrals in the trap region
      is created by joining the private plasma end-points of the two plates with
      a straight line. The end-points are defined to be midway between the
      outermost two rings of the private plasma region in order to remain
      compatible with PIN. </P>
    
    <P> <B>Trap Wall Option 3</B> : The neutral wall in the trap region is
      specified by a series of line segments entered in the data file just after
      the entry for the outer wall specification. These points are joined to the
      end/corner points of the target to form a continuous outer boundary for
      neutrals.</P>
    
    <P> <B>Trap Wall Option 4</B> : The private plasma wall for neutrals is
      specified by a set of additional coordinates for the vessel wall taken
      from the GRID2D geometry file. </P>
    
    <P> <B>Trap Wall Option 5</B> : The private plasma wall for neutrals is
      read from the PIN/NIMBUS transfer file. </P>

    <P> <B>Trap Wall Option 7</B> : The private plasma wall for neutrals is located at the outermost
      polygon edge of the last real (non-boundary) ring of the grid. </p>
    
    
    <P> </P>
    
    <H3><A NAME="vesdef">Vessel Wall Re-Definition Option</A></H3>
    
    <P> The purpose of this option is to instruct DIVIMP to include any baffles
    that may be specified in the grid file as part of the vessel wall. The code
    follows the main vessel wall until a section where a baffle comes very close 
    to the wall is found. The code then redefines the wall by following around the
    outside of the baffle until it rejoins the wall. This option is only meaningful 
    in conjunction with <A href="#neutwa"> wall option 4 </A> and/or 
    <a href="#trapwa">trap wall option 4</a>. If trap or wall option 5 are specified,
    in which the wall definition is taken from the PIN/NIMBUS output, then the 
    wall will automatically be redefined if baffles are present. </P>
    
    <P><B>Vessel Redef Option 0</B> : OFF - Vessel will not be redefined.
  
    <P><B>Vessel Redef Option 1</B> : ON - Vessel will be redefined to include adjacent baffles. 
  
    <P></P>
  
    <H3><A NAME="impvty">Impurity Neutral Velocity Type Option</A></H3>
    
    <P> <B>Velocity Type Opt 0</B> : OFF. Impurity neutrals will have a
      constant speed from creation until final removal. </P>
    
    <P> <B>Velocity Type Opt 1</B> : ON. Impurity neutral speed will change as
      the particle moves across the grid. The impurity neutral is assigned a
      speed based on the local plasma ion temperature. This speed changes as the
      neutral enters a new cell on the grid and is adjusted to match the local
      temperature.</P>
    
    <P> <B>Velocity Type Opt 2</B> : ON. Impurity neutral speed may change as
      the particle moves. The neutral will be assigned a new speed based on the
      local plasma ion temperature and the impurity mass whenever a Momentum
      Transfer Collision is calculated to take place. </P>
    
    <P> </P>
    
    <H3><A NAME="neuref">Neutral Reflection Option</A></H3>
    
    <P> <B>Reflection Opt 0</B> : Off - Impurity neutrals striking the walls
      are recorded. They do not cause self-sputtering nor are they reflected.</P>
    
    <P> <B>Reflection Opt 1</B> : On - Impurity neutrals striking the wall are
      reflected specularly retaining the same energy as they had before impact.
      They do not cause sputtering at wall impact. This may be a poor approximation
      for most carbon-wall collisions. It might not be too bad for inert gas
      collisions.</P>

    <P> <B>Reflection Opt 2</B> : On - Impurity neutrals striking the wall are
      reflected with a cosine angular distribution 
      retaining the same energy as they had before impact.
      They do not cause sputtering at wall impact. This may be poor approximation
      for most carbon-wall collisions. It might not be too bad for inert gas
      collisions.</P>
    
    <P> </P>
    
    <H3><A NAME="folrec">Follow Recombined Impurity Neutral Option</A> </H3>
    
    <P> <B>Follow Recombined Neutrals Opt 0</B> : OFF. Recombined Impurity
      neutrals are not-followed.</P>
    
    <P> <B>Follow Recombined Neutrals Opt 1 </B>: ON. Recombined Impurity
      neutrals are followed in the neutral state until re-ionization or removal
      from the system by some other mechanism. The re-ionized neutral is then
      followed as an ion. The recombined neutral is given the poloidal plane
      component of a projected 3D isotropic velocity calculated based on the
      temperature of the recombining ion. Unless over-ridden by the neutral
      velocity type option.</P>
    
    
    <P> </P>
    
    <H3><A NAME="mtcopt">Impurity Neutral Momentum Transfer Collision Option</A>
    </H3>
    
    <P> <B>Momentum Transfer Collision Opt 0</B>: OFF. Neutrals travel in
      straight lines from creation until ionization. </P>
    
    <P> <B>Momentum Transfer Collision Opt 1</B>: ON. Neutrals will undergo 90
      degree changes in flight path based on the probability calculated for the
      occurrence of a momentum transfer collision. The collision frequency is
      given by the following expression.</P>
    
    
    <P></P>
    
    <P> <IMG SRC="images/divref-119.gif" WIDTH="381" HEIGHT="63"></P>
    
    <P> </P>
    
    <H3><A NAME="mtc1">Momentum Transfer Collision - First Coefficient
      (kelighi)</A></H3>
    
    <P> Probability coefficient for a momentum transfer collision with a
      background ion. </P>
    
    <P> </P>
    
    <H3><A NAME="mtc2">Momentum Transfer Collision - Second Coefficient
      (kelighg)</A></H3>
    
    <P> Probability coefficient for a momentum transfer collision with a
      background neutral particle. </P>
    
    <P> </P>
    
    <H3><A NAME="prodep">Prompt Deposition Option</A></H3>
    
    <P><B> Ion Prompt Dep. Opt 0</B>: OFF. Ion prompt deposition does not
      occur. </P>
    
    <P> <B>Ion Prompt Dep. Opt 1</B>: ON. Ion prompt deposition is allowed to
      occur. If an ion is created within a larmor radius of the target surface
      OR if it is created within the Magnetic Pre-Sheath thickness of the
      asociated target segment then it is assumed to promptly redeposit on the
      target surface. The ion's impact energy for self-sputtering purposes is
      calculated based on the ion's creation energy and it's precise location of
      ionization relative to the Magnetic Pre-Sheath. The impact energy is 
      reduced appropriately for ionization occurring within the MPS. </P>
    
    <P> </P>
    
    <H3><A NAME="tarpos">Target Position Option</A></H3>
    
    <P> <B>Target Option 0</B> : Target is located at second grid points on
      the SOL and trap rings. Virtual points are discarded.</P>
    
    <P> <B>Target Option 1</B> : Target is located mid-way between the centre
      points of the virtual cell and first real cell on the SOL and trap rings.
      Virtual cell centers are then discarded.</P>
    
    <P> <B>Target Option 2</B> : Target is specified by a set of points
      entered in the data file. One point for each end of each ring. Virtual
      points are discarded.</P>
    
    <P> <B>Target Option 3</B> : Target is specified by a set of points that
      are hard-coded. One point for each end of each ring. The set of points is
      selected by the geometry option. The virtual points are discarded.</P>
    
    <P> <B>Target Option 4</B> : Target is located at the center of the first
      (virtual) cell on the SOL and trap rings. </P>
    
    <P> <B>Target Option 5</B> : Target is specified by a set of points
      entered in the data file. One point for each end of each ring.</P>
    
    <P> Virtual points are not discarded.</P>
    
    <P> <B>Target Option 6</B> : Target is specified by the polygon boundaries
      of the last of the real plasma cells on each ring. The virtual cells are
      discarded. This option should be the one used with all grids for which
      complete polygon information is available since the target in these cases
      should correspond exactly with the polygon edges.</P>
    
    <P> </P>
    
    <H3><A NAME="tarmir">Target Mirror Option</A></H3>
    
    <P> <B>Target Mirror Opt 0</B>: OFF. Target is treated normally.</P>
    
    <P> This option was implemented for testing purposes and to look at some
      specific transport physics problems. It should normally be turned OFF.</P>
    
    <P> <B>Target Mirror Opt 1</B>: ON. The target reflects all ions striking
      it. Both position and velocity are reflected. If the particle at position
      A makes a parallel step of length B that would carry it into the target
      located at the position X=0 (B&gt;A and towards the target) then the ion's
      velocity is changed in sign and the position of the particle is adjusted
      to &quot;|B-A|&quot;. Self-sputtering does not occur and particles can not
      be removed from the system at the target. </P>

    <P> <B>Target Mirror Opt 2</B>: ON. The target reflects all ions striking
      it. Only the position and not the velocity is reflected. If the particle at position
      A makes a parallel step of length B that would carry it into the target
      located at the position X=0 (B&gt;A and towards the target) then the ion's
      velocity is unchanged and the position of the particle is adjusted
      to &quot;|B-A|&quot;. Self-sputtering does not occur and particles can not
      be removed from the system at the target. </P>
    
    <P> </P>
    
    <H3><A NAME="oldgeo">Geometry Selection Option</A></H3>
    
    <P> <B>Geometry Option -1</B> : Wall and Target position data are to be
      read from the input file for the target and wall options specified above
      if such action is appropriate. </P>
    
    <P> <B>Geometry Option 0</B> : Shot 24719 (one specific grid). Hard-coded
      target and wall data are available for the appropriate target and wall
      options.</P>
    
    <P> <B>Geometry Option 1</B> : Shot 26308 (one specific grid). Hard-coded
      target and wall data are available for the appropriate target and wall
      options. </P>
    
    <P> </P>
    
    <H3><A NAME="periph">Ion Periphery Option</A></H3>
    
    <P> <B>Ion Periphery Opt 0</B> : Hard wall - ions are immediately removed
      at wall impact.</P>
    
    <P> <B>Ion Periphery Opt 1</B> : Reflecting wall - ions are always
      reflected at wall impact. The only loss mechanisms are recombination and
      target plate impact.</P>
    
    <P> <B>Ion Periphery Opt 2 </B>: No wall - ions are allowed to cross-field
      diffuse indefinitely. However they are always associated with the
      outermost ring of the grid system. Thus plots using this option could be
      invalid because this effectively increases the volume of the outermost
      ring - thus influencing density calculations.</P>
    
    <P> <B>Ion Periphery Opt 3 </B>: <A HREF="#fpwid">Far periphery model at
        wall.</A> The ion enters a region where there are three loss mechanisms
      invoked and governed by three parameters. First, the ion can
      <A HREF="#fpdiff">diffuse</A> back to the plasma - it enters at the point
      where it left. Second, it can be lost to the far periphery target region
      with a <A HREF="#fptarl">specified characteristic loss time</A>. Finally,
      it can diffuse to the &quot;wall&quot; which is <A HREF="#fpwid">specified
        to be a constant distance</A> from the outermost ring of the grid. In
      addition, the diffusion coefficient in the far periphery can be specified
      independently of the value in the SOL and main plasma.</P>
    
    <P> <B>Ion Periphery Opt 4 </B>: Special debugging wall option. The main
      wall is treated as a hard surface for particle loss. All ions striking the
      main wall are removed from the system. The private plasma wall is treated
      as a mirror. All particles striking the private plasma wall are reflected
      back into the plasma. The purpose of this option is to facilitate testing
      of the various Dperp options. If the ony sink is the outside wall then it
      should be possible to reach a condition where the density is constant
      inboard of the location of ion injection - if the Dperp and parallel
      transport are spatially uniform. This option is used in conjunction with
      the mirror target option. </P>
    
    <P> </P>
    
    <H3><A NAME="perrec">Periphery Recycle Option</A></H3>
    
    <P> <B>FP Recycle Option 0</B>: Ions are lost and removed from the system
      upon far periphery target or wall impact.</P>
    
    <P> <B>FP Recycle Option 1</B>: Ions lost to the far periphery target and
      walls are relaunched from the edge of the nearest target.</P>
    
    <P> </P>
    
    <H3><A NAME="poldrf">Poloidal Drift option</A></H3>
    
    <P> <B>Poloidal Drift 0</B> : Off - No poloidal drift velocity imposed.</P>
    
    <P> <B>Poloidal Drift 1</B> : On - <A HREF="#polv">Additional poloidal
        drift velocity given.</A> (This velocity is actually imposed along the
        field lines and NOT directly poloidally.) The poloidal velocity is 
        only applied over <a href="#t18>a specified range of S values</a>.</P>
        

    <P> <B>Poloidal Drift 2</B> : On - <A HREF="#polv">Additional "background plasma" poloidal
        drift velocity is given.</A> The velocity is added to the background plasma velocity and
        is coupled to the impurities through the force of friction.(This velocity is actually imposed along the
        field lines and NOT directly poloidally.) The poloidal velocity is 
        only applied over <a href="#t18>a specified range of S values</a>.</P>
    
    <P> </P>
    
    <H2><A NAME="rspec">Special plasma parameter - Rspec</A></H2>
    
    <P> To define where any special collision, friction and heating options are
      to apply in DIVIMP enter a ring number &gt; 0 here, and then the special
      options will apply for ring numbers greater than or equal to the value
      given. Typically, the ring no. of the separatrix will be entered, so that
      for example Collision option 3 applies just to the SOL and Trapped Plasma,
      reverting to Collision option 0 in the Main plasma. This parameter has no
      effect on the Velocity Diffusion collision options 12 and 13. If selected,
      these options apply to particle transport through-out the plasma. In
      general, this should be set to 0 so that the selected options will apply
      to the entire plasma. </P>
    
    <P> </P>
    
    <H2><A NAME="ircore">Ring Location of Core Mirror - IRCORE</A></H2>
    
    <P> This quantity allows the core ring, which will be used as the core
      mirror for impurity ion transport, to be specified. Any ions reaching this
      ring will be reflected. </P>
    
    <P> </P>
    
    <H2><A NAME="mb">Mass of plasma ions - Mb</A></H2>
    
    <P> Defines the plasma background material. Note that this can be
      overridden for purposes of sputtering if required (see later). The mass
      can be given to the nearest whole number, e.g. 2.0 for Deuterium. It can
      also be given as a fractional value, e.g. 2.5, if one wants quantities
      that are based on average ion mass to be calculated assuming a 50/50 DT
      plasma mixture.</P>
    
    <P> </P>
    
    <H2><A NAME="zb">Charge on plasma ions - Zb</A></H2>
    
    <P> Again, defines the plasma background. Enter an integer value here, e.g.
      1 for deuterium.</P>
    
    <P> </P>
    
    <H2><A NAME="temps">Temperatures</A></H2>
    
    <H2>TeB0,TeBP,TeBout,TeBin,TeBt,TiB0,TiBP,TiBout,TiBin,TiBt</H2>
    
    <P> The &quot;standard&quot; plasma temperature and density profiles are
      described in Note 336. The subscript &quot;e&quot; refers to electrons,
      and &quot;i&quot; refers to ions. In plasma decay option 1, the quantities
      TeBout,TiBout and NBout are assumed to be characteristic decay lengths,
      and are used to determine an exponential decay along the Reference Line
      for the SOL. When plasma option 99 is used, these values are all ignored
      and the temperature and density profiles are read in from a file. These
      values are also ignored - except for the trap values - when various plasma
      decay and/or temperature gradient options are specified. Furthermore,
      these values can be used in conjunction with plasma decay options that
      read values from the input data file and temperature gradient options to
      generate a variety of background plasma profiles. </P>
    
    <P>The meaning of the parameters are (equivalent for &quot;e&quot; and &quot;i&quot;
      and similar for density (n) ):</P>
    
    <P>TeB0 : Temperature of electrons at the mid-point of the field line. For
      options which use this quantity. May be read using some Plasma Decay
      Options as an alternative.</P>
    
    <P>TeBP : Temperature of electrons at the targets. May be read using some
      Plasma Decay Options as an alternative.</P>
    
    <P>TeBout : Outboard step for scaling electron temperature. In some cases
      it will be a linear step in eV and in other cases it might represent a
      decay length or e-folding distance for electron temperature across the
      target into the main SOL.</P>
    
    <P>TeBin : Electron temperature step per ring moving inboard from the
      separatrix into the core plasma. This may be over-ridden by some of the
      plasma decay or core options. </P>
    
    <P>TeBt : Electron temperature of the trapped plasma - when a constant trap
      temperature option is in use.</P>
    
    <P>TeBouP: Step for scaling electron temperature at the target into the
      private plasma region. Used for exponential decay only. (at this time).</P>
    
    <P> </P>
    
    <H2> <A NAME="grads">Gradient parameters</A> </H2>
    
    <H2>feBL1,feBL2,feBt,feB2,fiBL1,fiBL2,fiBt,fiB2</H2>
    
    <P> Several temperature gradient options are available, as described in
      notes 351 and 388 and later. The gradients can be switched off by setting
      feBt,feB2,fiBt and fiB2 to 1.0. The temperature gradient options should be
      set to 99 when file data is being used. Similar to the temperature
      parameters - these will only be used when the appropriate gradient options
      are specified. The parameters labeled &quot;L1&quot; and &quot;L2&quot;
      specify distances along the field line in units of SMAX. The Bt and B2
      quantities are multiplication factors that modify the &quot;base&quot;
      temperature for the ring. The plasma values assigned to each cell are
      linearly interpolated (depending on the temperature gradient options
      selected) between these points.</P>
    
    <P>The meaning of the parameters is (the same for e and i):</P>
    
    <P>feBt: Target multiplier factor. The temperature at the target is (feBt *
      Specified Upstream Temperature). The upstream temperature is either
      specified as TeB0 or may be entered using a plasma decay option that
      specifies a different value for each ring. </P>
    
    <P>feBL1: This is the first length factor. At a distance of (feBL1 * SMAX)
      from the target the temperature will rise to a value of (feB2 * Specified
      Upstream Temperature). </P>
    
    <P>feB2: Multiplication factor for distance (feBL1 * SMAX)</P>
    
    <P>feBL2: This is the second length factor. At a distance of (feBL2 *
      SMAX), the temperature rises to the value specified for the Upstream
      Temperature and remains constant from this point until the mid-point of
      the ring - where it will meet the specification coming from the other
      target.</P>
    
    <P>This mechanism provides a way of imposing a two section linear gradient
      for the background temperature profile. In many cases, this might be a
      good first approximation to an unknown experimental background plasma.
    </P>
    
    <P> </P>
    
    <H2><A NAME="dens">Densities</A> </H2>
    
    <H2>NB0,NeBP,NBout,NBin,NBt,NBouP</H2>
    
    <P> See Note 336. When plasma option 1 is used the value of NBout is
      assumed to be the decay length and is plugged into an exponential decay
      formula along the reference line. As with the previously specified
      temperature options, these values may be overridden by the plasma decay
      and SOL options which set plasma density either based on plate specified
      values or in conjunction with a SOL model. The base density inboard is
      then calculated from the average density at the midpoint of the separatrix
      ring equidistant from both plates. This does cause some discontinuities in
      density profiles far from the plate, however the effects of this seem to
      be minor. See the description above of the temperature related quantities
      for more details - the density quantities are treated equivalently.</P>
    
    <P> </P>
    
    <H2><A NAME="langsw">Langmuir Probe Data Switch</A></H2>
    
    <P> This option specifies the form of the data entered in the Langmuir
      Probe Data input described below. </P>
    
    <P> Probe Switch Option 0: The third column is interpreted as target
      densities. (in m<SUP>-3</SUP>)</P>
    
    <P> Probe Switch Option 1: The third column is interpreted as target
      saturation currents. (Isat in A/m<SUP>2</SUP>)</P>
    
    <P> </P>
    
    <H2><A NAME="prmuli">INNER/Both Target Data Multipliers</A></H2>
    
    <P> This input item is a set of three numbers on the one line separated by
      spaces. These numbers are used to multiply the input data entered in the
      Langmuir Probe Data entry. This allows the input data to be quickly and
      easily modified. This is especially useful for cases where it may be
      suspected that Ti is not equal to Te. The order of the three multipliers
      is Te multiplier, Ti multiplier, Nb multiplier</P>
    
    <P>The following should be the default value of this input. </P>
    
    <P>'INNER target data multipliers (Ti,Te, Nb) : ' 1.0 1.0 1.0 </P>
    
    <P> </P>
    
    <H2><A NAME="probei">Langmuir Probe Data Input - Inner/Both plate</A></H2>
    
    <P> This section is used to specify a set of data to be used as the base
      temperature and density for each specified ring. Both the ion and electron
      temperatures as well as the density can be independently specified for
      each ring. The data should be entered in ascending ring number order. The
      format of a line of data is as follows:</P>
    
    <P> </P>
    
<PRE>
     ' ' 'Probe data at inner plate (opt 4) or both(opt 3)' 
     ' Ring TeBP TiBP NBP : Number of rows - ' 3 
         9   30.0   30.0   1.0e19
        10   15.0   20.0   8.1e18 
        11    5.0   14.5   1.93e18 
</PRE>
    
    <P>For rings in the SOL for which a line of data is not specified, the
      values for the next inward - i.e. lower numbered ring are used. These
      values will be assigned to all bins on the specified ring - depending on
      the plasma decay option specified. Variations in temperature and density
      will be caused by imposed temperature gradient options ... or by various
      SOL options which apply a SOL model to calculate the values throughout the
      SOL based on the plate input data provided here. The values specified here
      are initially assigned to the respective halves of the grid up to the
      mid-plane for the inner and outer targets respectively.</P>
    
    <P> </P>
    
    <H2><A NAME="prmulo">OUTER Target Data Multipliers</A></H2>
    
    <P> This is equivalent to the INNER/Both target data multiplier described
      above. It applies to the OUTER target data that is entered after it.</P>
    
    <P> </P>
    
    <H2><A NAME="probeo">Langmuir Probe Data Input - Outer plate</A></H2>
    
    <P> See above. Provides input data for the outer plate for cases where it
      differs.</P>
    
    <P> </P>
    
    <H2><A NAME="cordat">Core Plasma Input Data</A></H2>
    
    <P> This section is used to specify a set of data for the temperature,
      density, and velocity used by the various core plasma options. These
      values will either specify the temperatures and densities to apply to the
      entire ring in the case of core option 1 - or they specify the values of
      temperature and velocity (and density) that apply at the X-point in the
      case of the other core options. Core Options 2 to 5 are used to simulate
      an X-point Marfe within the core plasma. The density is ignored for core
      option 3 to 5. It is calculated by applying conservation of pressure along
      the field line. When core options 2, 3 and 4 are in use, the base
      temperatures for the core rings are calculated using the standard core
      specification procedures. For core option 5, the base values of
      temperature and density for the core rings must be entered in the tables
      for Langmuir Probe Data described above; indexed by their core ring
      numbers.</P>
    
    <P>The format of a line of data is as follows - the data should be entered
      in ascending ring number order.</P>
    
    <P></P>
<PRE>    
     ' ' 'CORE Plasma data - for Core Options 1 and 2'
     ' Ring TeBP TiBP NBP Vb : Number of rows - ' 3
          4   5.0   10.0   1.0e19      0.0
          5   3.0    3.0   5.0e19    200.0
          6   2.0    2.0   1.0e20   2000.0
</PRE>
    
    <P>In the case of core option 1 - for rings in the CORE for which a line of
      data is not specified, the values for the next inward - i.e. lower
      numbered ring are used. These values will initially be assigned to all
      bins on the specified ring. For the other core options, the data are
      applied ONLY to the specified rings.</P>
    
    <P> </P>
    
    <H2><A NAME="dperpv">Cross-field Diffusion Rate - Dperp (m*m/s)</A></H2>
    
    <P> The basic perpendicular diffusion coefficient is specified for the
      whole model space. The values for Dperp can be 0.0, 0.5, 1.0, 3.0, etc. as
      desired. </P>
    
    <P> </P>
    
    <H2><A NAME="dperpp">Cross-field Diffusion Rate for Private Plasma Region
      - Dperpt (m*m/s)</A></H2>
    
    <P> This option allows a different cross-field transport rate for the
      private plasma to be specified. It was needed to mimic some effects in
      EDGE2D.</P>
    
    <P> </P>
    
    <H2><A NAME="vpinch">Perpendicular Pinch Velocity - CVPINCH (m/s)</A></H2>
    
    <P> Value of the perpendicular pinch velocity. At every time-step it will
      act on ions to move them cross-field. A positive velocity is used to
      designate inward motion toward the core or into the private plasma region.
    </P>
    
    <P> </P>
    
    <H2><A NAME="mi">Mass of impurity ions - Mi</A></H2>
    
    <P> This item is always given and defines the impurity type. Mass, in
      general, need only be given to the nearest whole number, e.g. 12.0 for
      Carbon. However, for some heavier materials like Chlorine (35.5) or Argon
      (39.9) a more accurate mass is required for the NOCORONA package to work
      correctly.</P>
    
    <P> </P>
    
    <H2><A NAME="zi">Atomic number of impurity ions - Zi</A></H2>
    
    <P> Again to define the impurity, an integer value, e.g. 6 for Carbon.</P>
    
    <P> </P>
    
    <H2><A NAME="ebd">Characteristic energy Ebd (eV)</A></H2>
    
    <P> This item is used for NEUT cases where Vel/ang flag is 0,1,4 or 5.
      Typically one would use 8.3 (7.3*) for Carbon impurity. Reference: Note
      41. This value may change as research defines the value more precisely. In
      the meantime, one can either enter a desired value from the literature or
      enter a value of 0.0. In the case of zero, the code reads the value from a
      hard-coded table taken from the literature.</P>
    
    <P> </P>
    
    <H2><A NAME="zeff">Z effective (self) - Zeff</A></H2>
    
    <P> This item is only required for collision option 2, otherwise it is
      ignored. Typically 1.0, 2.0, 4.0, etc. See note 103.</P>
    
    <P> </P>
    
    <H2><A NAME="tem1">Initial temperature - Tem1 (eV)</A></H2>
    
    <P> Initial temperature of ions, neutrals, gas, etc. can all be defined
      with this parameter. Replaces Tin, Ein, Tg quantities in LIM3. This value
      is converted to injection velocity for the case of ion injection. </P>
    
    <P>The formula used for this conversion is V = 9.79e3 X Sqrt (Tem1 / Mi).</P>
    
    <P> </P>
    
    <H2><A NAME="tem2">Initial temperature (2) - Tem2 (eV)</A></H2>
    
    <P> For use with Vel/ang9.</P>
    
    <P> </P>
    
    <H2><A NAME="initrz">Initial R,Z position of impurity</A></H2>
    
    <P> These two items are used with injection option 2, and with neutral
      launch option 1. They specify the initial position of the impurity neutral
      or ion.</P>
    
    <P> </P>
    
    <H2><A NAME="initiz">Initial ionization state of impurity ions</A></H2>
    
    <P> This quantity must be specified for non-NEUT cases where ions are
      injected straight into the plasma. Normally it will be 1, so that singly
      ionized ions are injected, but it can be greater than 1 if desired. For
      NEUT cases, this value is set to 1 internally. </P>
    
    <P> </P>
    
    <H2><A NAME="nhc">Neutral hydrogen density parameter - Nhc (m**-3)</A></H2>
    
    <P> The next few items refer to cases where Charge Exchange Recombination
      has been requested. It is not available for all impurities and should
      normally only be used in conjunction with a hydrogenic plasma. It can be
      used with other plasma types, but a warning message will be issued by the
      program. The parameters here are described in Note 89. The standard value
      for Nhc is 1.0E15. </P>
    
    <P> </P>
    
    <H2><A NAME="nho">Nho (m**-3)</A></H2>
    
    <P> Also for CX-Recombination. Standard value 3.0E18.</P>
    
    <P> </P>
    
    <H2><A NAME="lamhx">Lamhx (m)</A></H2>
    
    <P> Also for CX-Recombination. Standard value 0.02.</P>
    
    <P> </P>
    
    <H2><A NAME="lamhy">Lamhy (m)</A></H2>
    
    <P> Also for CX-Recombination. Standard value 0.11.</P>
    
    <P> </P>
    
    <H2><A NAME="vcx">Constant for CX Recomb option 2 - Vcx (m/s)</A></H2>
    
    <P> Also for CX-Recombination option 2 only. For the usual case (option1)
      Vcx is calculated as sqrt(2Tb/Mb) and varies with Tb(x). For this option
      we set Vcx to a constant value, typically 2.4E4. See Note 173.</P>
    
    <P> </P>
    
    <H2><A NAME="near">For average density &quot;near&quot; target xnear,ynear</A></H2>
    
    <P> These two items are ignored in DIVIMP.</P>
    
    <P> </P>
    
    <H2><A NAME="theta">Measure theta from T degrees for launch</A></H2>
    
    <P> Note on definition of theta: in DIVIMP, theta = 0.0 in the positive R
      direction, and is measured anti-clockwise. Hence an angle of -90.0 degrees
      might be used for launch uniformly about the -Z direction.</P>
    
    <P> </P>
    
    <H2><A NAME="vhyin">Inboard plasma flow velocity - Not supported - Vhyin
      (m/s)</A></H2>
    
    <P> NOT SUPPORTED IN DIVIMP. For most cases we only have flow of the
      background plasma for the SOL, in which case this item should be set to
      0.0. However, to allow for plasma flow inboard this item can be set to a
      constant value. Note that this option only applies to the inboard region
      and does not affect the SOL. This item described for LIM in Note 118.</P>
    
    <P> </P>
    
    <H2><A NAME="eyin">Inboard electric field - Not supported - Eyin (V/m)</A></H2>
    
    <P> NOT SUPPORTED IN DIVIMP. Again, generally set to 0.0. A positive value
      gives an inboard electric field.</P>
    
    <P> </P>
    
    <H2><A NAME="vhyout">Outboard plasma flow vel (SOL 5,6 &amp; 7) -
      Vhyout(m/s)</A></H2>
    
    <P> Required when SOL 5, 6 or 7 has been selected, otherwise set this value
      to 0.0. For details of SOL5 see Note 123. This also sets the base velocity
      for use in SOL options 6 and 7.</P>
    
    <P> </P>
    
    <H2><A NAME="eyout">Outboard electric field (SOL 5,6 &amp; 7) - Eyout
      (V/m)</A></H2>
    
    <P> Required when SOL 5, 6 or 7 has been selected, otherwise set this value
      to 0.0. This also sets the base velocity for use in SOL options 6 and 7.</P>
    
    <P> </P>
    
    <H2><A NAME="zenh">Collision Enhancement Factor - Zenh</A></H2>
    
    <P> This item is used in every case and should normally be set to 1.0. It
      is a modifying factor used in calculating the collision times, heating
      times and slowing times and can be set to, for example, 2.0, 4.0, 8.0 to
      obtain modified plasma characteristics. Defined in Note 121. </P>
    
    <P> </P>
    
    <H2><A NAME="setti">Set Ti = max(Ti,Tb) when reaching state (0 off)</A></H2>
    
    <P> This item is rarely used and should normally be 0 for &quot;off&quot;.
      Entering a value higher than 0 indicates an ionization state which, when
      reached, results in an ion being instantaneously heated (or cooled) to the
      local plasma background temperature at that point. For example, if this
      item is set to 2, then any ion ionizing to 2+ or recombining to 2+ has the
      plasma temperature at its current position assigned to it. Described in
      Note 121.</P>
    
    <P> </P>
    
    <H2> <A NAME="thresh">Threshold yield for self-sputtering (eV)</A></H2>
    
    <P> Required for cases using proper self-sputtering. The impact energies of
      ions returning to the targets are calculated, and these are then used to
      calculate Yields &quot;Ys&quot; using a specified set of sputtering data
      that includes self-sputtering yields. If Ys is greater than the threshold
      yield given here, then a fraction Ys of a neutral is sputtered off and
      followed until it too is eventually removed. If it ionizes and returns to
      the target then a new value of Ys is calculated and may result in a
      smaller fraction Ys1*Ys2 of a neutral being sputtered off again. A typical
      value for this parameter is 0.1. See Note 87.</P>
    
    <P> </P>
    
    <H2><A NAME="zimp">Bombarding ion charge state - Zimp</A></H2>
    
    <P> This item is required for NEUT sputter options 1 and 2, which provide a
      simple method for modeling self-sputtering (not the same as the proper
      self-sputtering method, option 3). The ion species bombarding the limiter
      is defined using this item and the following item &quot;bombion&quot;. For
      example, if &quot;bombion&quot;=5 and this item =4, then we are simulating
      the bombardment of the limiter with C4+ ions. See Notes 38 and 144. </P>
    
    <P> </P>
    
    <H2><A NAME="bombi">Bombion (0-Mb 1-H 2-D 3-T 4-He4 5-C 6-Mi 7-O)</A></H2>
    
    <P> This item again required for NEUT sputter option 1. There are two
      special cases :- Setting this flag to 0 indicates that the bombarding ion
      type is the plasma background ion Mb, but of course the value of Zimp
      could be specified as different to Zb; setting this flag to 6 indicates
      that the bombarding ion type is the impurity ion Mi, ie the limiter
      material itself, with an appropriate value for Zimp. The remaining values
      for this flag allow a variety of other ion types to bombard the limiter.
      Note: the subscript &quot;imp&quot; is always used to mean &quot;impact&quot;,
      while the subscript &quot;i&quot; is always used to indicate &quot;impurity&quot;.
      See Note 144. </P>
    
    <P> </P>
    
    <H2><A NAME="irf">Ionization rate factor for neutrals - IRF</A></H2>
    
    <P> Adjustment factor applied to the ionization rate of the neutrals only.
      Is only required for NEUT cases, and normally is set to 1.0. Entering a
      value such as 0.2 would reduce the ionization rate of the neutrals.
      Reference: Note 146.</P>
    
    <P> </P>
    
    <H2><A NAME="sef">Sputtering Enhancement Factor - SEF</A></H2>
    
    <P> This is a correction factor applied to the calculation of Z effectives,
      etc. Normally it would be set to 1.0. Any other value causes the &quot;total
      primary integrated flux*yield&quot; to be adjusted by this factor prior to
      being used in the Z effectives formula. Reference: Note 152. </P>
    
    <P> </P>
    
    <H2><A NAME="solef">SOL Enhancement Factor - Electric Field - SOLEF</A></H2>
    
    <P> To allow selective switching on/off of the electric force, for use with
      any SOL option. Normally set this value to 1.0, or set to 0.0 to switch
      off electric field.</P>
    
    <P> </P>
    
    <H2><A NAME="solvf">SOL Enhancement Factor - Drift Velocity - SOLVF</A></H2>
    
    <P> Similarly, allows switching on/off of drift velocity - set to 0.0 or
      1.0</P>
    
    <P> </P>
    
    <H2><A NAME="solprm">SOL parameters fl,fs,fRM,kin,kout,fRmin,fRmax</A></H2>
    
    <P> For use with SOL options 1a and 10. See notes 344, 353 for description.</P>
    
    <P> </P>
    
    <H2><A NAME="sol67">SOL Parameters for SOL options 6 and 7</A>.</H2>
    
    <P> These quantities VbL1, VbM1, VbL2, and VbM2 control how the velocity is
      calculated in SOL options 6 and 7. In option 6, the Velocity is the Base
      Value entered previously out to VbL1 * SMAX then it takes the value VbM1 *
      Vhout until VbL2 * SMAX and then finally it is VbM2 * Vhout for S &gt;
      VbL2 * SMAX and S &lt; SMAX/2. The velocity is symmetric from each target
      except for a change in sign. SOL option 7 is similar except each of the
      values (0.0 , vhout) , (VbL1*SMAX, VbM1*vhout), (VbL2*SMAX, VbM2*vhout),
      (SMAX/2.0 , 0.0) are all linked by linear ramps from one point to the
      next, giving significant flexibility in assigning background flow
      velocities. (Including approximations to flow reversed situations.) </P>
    
    <P> </P>
    
    <H2><A NAME="mode">DIVIMP mode (1 impulse, 2 steady state, 0 both)</A></H2>
    
    <P> Most DIVIMP analyses look at the steady state results and operate with
      mode 2. The standard version of the program does not cater for the other
      modes. The &quot;big&quot; DIVIMP version allows the use of mode 1, where
      time dependent results are recorded, and mode 0, where both time dependent
      and steady state results are recorded. This allows analysis of the spatial
      distributions of each charge state at a series of specified times after
      launch. Neither the 0 or the 1 mode has been used in recent development
      work and care should be taken if one is trying to run in mode 0 or 1 that
      erroneous effects do not enter into the results.</P>
    
    <P> </P>
    
    <H2><A NAME="maxiz">Maximum ionization state</A></H2>
    
    <P> This item gives the maximum charge state of interest. There are both
      time and storage advantages in restricting the number of charge states
      with this parameter. It should be used in conjunction with the &quot;ionization
      option&quot; above. For options 0,3 and 4, ions are allowed to ionize
      beyond the maximum charge state given here, but they are then recorded as
      having &quot;ionized beyond limit&quot; and ignored. For options 1,2,5 and
      6, ions are just not allowed to ionize beyond the maximum state given
      here, so any ion reaching this state remains until it is removed. Note
      that if option 5 is used (which allows electron-ion recombination), ions
      which are &quot;stuck&quot; in the highest allowed ionization state are
      still able to recombine to lower states. Any singly-ionized ions which
      recombine are recorded and ignored. One special use of this item is in
      doing a neutral analysis only - if the maximum charge state is set to 0
      then any ions created are immediately recorded as &quot;ionized beyond
      limit&quot;, without being tracked. If the maximum state is given as the
      atomic number of the ion, then of course there are no restrictions on
      ionization or recombination.</P>
    
    <P> </P>
    
    <H2><A NAME="num">Number of impurity ions to be followed</A></H2>
    
    <P> This item has two different meanings: for non-NEUT cases, it gives the
      number of impurity ions to be injected; for NEUT cases, it gives the
      number of neutrals to be launched. In the latter case the actual number of
      impurity ions generated will normally be less than this value, assuming
      some neutrals reach the wall or the centre and are removed, or befall some
      other fate. The number is restricted by the MAXIMP parameter in the PARAMS
      common block. At the present moment this is set to 100,000. Normally 2000
      to 5000 ions are followed. (The restriction to 100,000 applies only to
      cases run in Toronto. On the Cray the maximum limitation is approximately
      10,000, while at JET the number was typically limited to 25,000. As with
      most of these parameters, maximum ionization state, maximum number of
      particles, maximum number of factors for X and Y resolution, maximum
      number of bins..., by adjusting the parameters in the common block PARAMS,
      it is possible to maximize one parameter while balancing the cost in the
      other parameters - the only restrictions are machine memory and CPU time
      requirements.)</P>
    
    <P> </P>
    
    <H2><A NAME="numsup">Number of supplementary particles to be followed</A></H2>
    
    <P> This quantity specifies a number of additional particles to be launched
      using the supplementary launch and velocity/angle flag options. At present
      only neutrals may be injected in this fashion. Although it was designed
      with the primary purpose of allowing both target and wall neutral launches
      in the same case, it can be used to launch two different groups of primary
      neutrals from the targets.</P>
    
    <P> </P>
    
    <H2><A NAME="fsrate">Quantum iteration time in NEUT - Fsrate (s)</A></H2>
    
    <P> This is the timestep to be used in following all neutrals. It is not
      required for non-NEUT cases. Generally, a value of 1.0E-8 has been found
      appropriate. The &quot;time spent following neutrals&quot; is printed at
      the end of a DIV run - if this is unreasonable then the quantum iteration
      time can be adjusted. </P>
    
    <P> </P>
    
    <H2><A NAME="qtim">Quantum iteration time in DIV - Qtim (s)</A></H2>
    
    <P> This is the basic timestep to be used in following all ions of whatever
      charge state. In cases where the ions never travel far from the targets a
      value of 1.0E-8 could be used, but in cases where ions spend a lot of time
      inboard and reach the higher ionization states values closer to 1.0E-6
      will be required. Note that the CPU time required for a DIVIMP case is
      related to the quantum iteration time, so that for example using a
      timestep of 2.0E-7 in place of 1.0E-7 results in a time saving of around
      50%. At the end of a run the &quot;time spent following ions&quot; is
      printed to help gauge the suitability of the chosen timestep. It is
      important in the selection of the time step to make it significantly less
      than characteristic time scales of the system. For example, if the mean
      collision or ionization time is 5.0e-7, then a value of 3.0e-7, although
      less, might cause a problem and a value of 1.0e-6 would definitely be in
      error. The conclusion is that the value for this parameter must be chosen
      wisely. It has been found that values around 1.0e-7 seconds tend to be
      adequate for most simulations and in many cases 2.0e-7 to 5.0e-7 are also
      adequate. </P>
    
    <P> </P>
    
    <H2><A NAME="cpu">CPU Time Limit (s)</A></H2>
    
    <P> This quantity specifies the maximum time in seconds before the program
      starts to self-terminate. It will stop following ions and finish with any
      secondary neutrals. Error messages are written indicating that the
      statistics may not be reliable. However, all of the program finish
      processing is performed.</P>
    
    <P> </P>
    
    <H2><A NAME="avdwel">AVERAGE DWELL TIMES (s) for each charge state</A></H2>
    
    <P> This is an introductory line to the time dependent data. If time
      dependence is not being used (ie DIV mode = 2) then the &quot;number of
      dwell times given&quot; on the following line should be set to 0.
      Otherwise, enter the number of dwell times given followed by the actual
      dwell times, one per line, starting with the dwell time for NEUTRALS,
      followed by dwell times for charge states 1,2,3,...up to the maximum
      charge state specified earlier. The dwell times themselves are not easily
      predicted and may have to be obtained by first running the same DIV case
      with mode 2 (steady state) and only a few ions (say 500), and the results 
      analyzed to find the dwell times. For neutrals, this will be the average
      time to ionization. For the ions, it is the minimum of the average time to
      ionization and the average time to absorption for each state. The LIM
      program can then be re-run with the correct mode (0 or 1). </P>
    
    <P> Example of entering dwell time factors :-</P>
    
    <P></P>
    
<PRE>
    'Number of dwell times given below :-' 4
       1.0E-7
       1.5E-5
       1.0E-4
       3.0E-4
</PRE>
    
    <P>This specifies Tdwell for neutrals, and charge states 1 through 3. See
      Note 128 for full description of time dependent cases.</P>
    
    <P> </P>
    
    <H2><A NAME="dweltf">DWELL TIME FACTORS for time dependent analysis</A></H2>
    
    <P> Once we have obtained the dwell times, we wish to record the spatial
      distributions of each charge state at a series of times indicated by the
      factors below. For non time dependent cases, there is no need to give any
      factors and the &quot;number of factors&quot; can be set to 0. The maximum
      number of time factors is 20. </P>
    
    <P>An example follows for a time dependent case :-</P>
    
    <P></P>

<PRE>    
    Number of dwell time factors :-' 8
       0.05
       0.1 
       0.2 
       0.5 
       1.0 
       2.0 
       5.0 
      10.0
</PRE>
    
    <P>For this example, spatial distributions are recorded at the following 8
      times :- 0.05, 0.1, 0.2,0.5, 1.0, 2.0, 5.0, 10.0 of Tdwell for each charge
      state.</P>
    
    <P> </P>
    
    <H2><A NAME="mxdwel">Maximum Dwell time for Steady State</A></H2>
    
    <P> This value specifies the maximum time in seconds (in terms of ion
      lifetime, not CPU time) that an ion will be followed for before it is
      discarded. If it exists in the plasma for longer than this period it is
      considered to be in the plasma at the cutoff time and is recorded as such.
      This parameter reduces the chance that trapped particles prevent a case
      from finishing.</P>
    
    <P> </P>
    
    <H2><A NAME="yldmod">Set of Yield Modifiers for Primary, Secondary and
      Chemically sputtered neutrals</A> </H2>
    
    <P> One must specify here a set of yield multipliers that will be applied
      to physical and chemically sputtered particle yields originating from
      energetic ion impact on the targets and the vessel walls. In addition, one
      specifies a yield multiplier for self-sputtered particles that originate
      from the target - self-sputtering is not supported from other vessel
      surfaces. The last item on the line is a value for the reflection coefficient
      for neutral particles, with a value between 0.0 and 1.0. </P>

    <P>The &quot;targets&quot; are defined by the grid segments at the
      ends of the rings in the SOL and Private Plasma. The &quot;vessel walls&quot;
      are defined by a set of joined line segments which connect the outer
      corners of the INNER and OUTER targets together. This set of line-segments
      approximates the geometry of the actual vessel wall. Normally, set the &quot;number
      of rows of data&quot; to 1 and enter the following values on the following
      line: </P>
    
<pre>
' ' 'Set of Yield Modifiers for Primary, Secondary neutrals'  
'      Number of rows of (X,Mpt,Mst,Mct,Mpw,Mcw,Refl) data-'  4 
         0.0   0.0    1.0     1.0    0.3    1.0    0.3    0.0
        36.0 130.0    1.0     1.0    0.3   15.0   15.0    0.0
       165.0 166.0    1.0     1.0    0.3    1.0    0.3    0.0
       167.0 177.0    1.0   -99.0    1.0    1.0    1.0   -1.0
</pre>
    
    <P>The leading two numbers are wall indices which specify the range of wall
    segments to which the specified yield and reflection modifiers will apply.
    If the first line contains an element labelled as 0.0 as it's first element then 
    this set of values is taken to be the default set for the entire wall and is applied
    first, before later table entries change the values for specific ranges of wall sections. 
    If there is an overlap in range of segments specified for two regions then the set 
    of yield modifiers later in the list is the one used for any segments that overlap earlier
    specifications. <p>
    
    <P> There are six values specified on each line in addition to the segment indices. Each 
    of these numbers is interpreted in different contexts depending on it's value. In order the 
    six numbers represent the following quantities.</P>
    
    <UL>
    	<LI> Modifier for Physical Sputtering on Target Segments
    	<P> This option multiplies the calculated yield for physical sputtering on the specified wall
    	element if it is a part of a target. A value
    	of 1.0 is usually used unless there is a reason to suspect a change in the 
    	effectiveness of the physical sputtering process.</P>
        
    	<LI> Modifier for Self-Sputtering
    	<P> Self-sputtering multiplier. A positive value will multiply the calculated self-sputtering
    	yield. A negative value in the range of [-50.0,0.0) will be used as an actual value for the
    	yield of the fragment on the surface. Thus a value of -2.0 will result in a fixed yield
    	value of 2.0 being used for this segment no matter what the nature of the impacting particle
    	or it's energy. A value in the range of -99.0 to -100.0 will activate an ion reflection/prompt
    	thermal re-emission mechanism by which the impacting ion will be neutralized and 
    	relaunched as a neutral particle with a given fixed energy specified in the input file 
    	and with it's trajectory selected from a cosine distribution. A value of -99.0 represents 
    	a probability of ion reflection of 1.0. A value of -100.0 is a ion reflection 
    	probability of 0.0.</P>
    
   	<LI> Modifier for Chemical Sputtering on Target Segments
    	<P> This option multiplies the calculated yield for chemical sputtering on the specified wall
    	element if it is a part of a target. A value less than 1.0 (often in the range of 0.3 to 0.5)
    	may be used as a method of modelling the quick break-up and prompt redeposition of methane
    	fragments. This may be particularly true for target segments which may have significant 
    	plasma contact.</P>
    	   	
    	<LI> Modifier for Physical Sputtering on Wall Segments
    	<P> This option multiplies the calculated yield for physical sputtering on the specified wall
    	element if it does NOT form part of a target. A value
    	of 1.0 is usually used unless there is a reason to suspect a change in the 
    	effectiveness of the physical sputtering process.</P>
    	
    	<LI> Modifier for Chemical Sputtering on Wall Segments
    	<P> This option multiplies the calculated yield for chemical sputtering on the specified wall
    	element if it is NOT a part of a target.</P>

    	<LI> Reflection Coefficient for Neutral Impact on Segments
	<P> If the neutral reflection option is active then this quantity allows each element of
	the vessel wall/target to have a different reflection coefficient. A value of 0.0 will 
	deactivate reflection for the given element, even if the refection option is turned on.
	A negative value for this quantity results in a prompt thermal re-emission mechanism 
	being employed instead of normal reflection. In PTR the emission energy of the neutrals
	coming from the specific wall segment with a negative yield is specified in the input file
	by the input energy quantity. Otherwise the energy of the neutral is retained during 
	a surface reflection</P>
	

    </UL>
    
    <P> </P>
    
    <H2><A NAME="fixyld">Specified Fixed Yield Value for Sputter Data Option 4</A></H2>
    
    <P> When Sputter Data Option 4 is in use the yield for all sputtering events is set
    to a fixed value. This input line specifies the value that will be used for that fixed
    value of the yield. </P>
    
    <P></P>   
    
    <H2><A NAME="targt">Target Temperature in K</A></H2>
    
    <P> This value is used in the chemical sputtering yield options for
      calculating the total chemical sputtering yield from each target segment.
      (Units of Kelvin)</P>
    
    <P> </P>
    
    <H2><A NAME="wallt">Wall Temperature in K</A></H2>
    
    <P> The wall temperature is used in the same manner as the target
      temperature. It is a factor in the chemical sputtering yield formulae and
      is used in calculating the yield for each vessel wall segment. (Units of
      Kelvin)</P>
    
    <P> </P>
    
    <H2><A NAME="ppwt">Private Plasma Wall Temperature</A> </H2>
    
    <P> The private plasma wall temperature is used in the same manner as the
      wall or target temperature. It is a factor in the chemical sputtering
      yield formulae and is used in calculating the yield for each vessel wall
      segment. (Units of Kelvin)</P>
    
    <P> </P>
    
    <H2><A NAME="wsegt">Specific Wall Segment Temperatures</A></H2>
    
    <P> This input contains a list of wall element index numbers and a
      temperature to be associated with each wall element. A different
      temperature can be specified for every element of target, wall and private
      plasma wall. Temperatures may be specified for any range of elements. If a
      temperature is not specified for a specific element - the temperature for
      that element is determined by the overall wall, target, and private plasma
      wall temperatures described previously. </P>
    
    <P>The format for this input is as follows:</P>
    
    <P></P>
<pre>    
    ' ' 'TN1450 Wall Temperatures in K for Specific segments'
    'Number of Segment Ranges (Index1 Index2 Temp):' 3
        35    40    800
       103   107   1000
       116   116   1200
</pre>
    
    <P>Each line contains a range of wall element indices followed by a
      temperature that should be applied to those indices. The actual index
      numbers that should be used can be obtained by running a case using the
      appropriate grid and wall options and then looking in the output &quot;.dat&quot;
      file for the wall element listing. This listing contains the location and
      the index numbers of each element of the vessel wall. </P>
    
    <P> </P>
    
    <H2><A NAME="debugn">Debug NEUT (0 off, &gt;0 on)</A></H2>
    
    <P> Generally set this value (and the next) to 0. Setting this value to 1
      generates some debugging information in the neutrals part of the program.
      It generates a complete history of each neutral followed, consisting of
      one line of output indicating the launch parameters for the neutral,
      followed by one line of output after each neutral timestep, and ending
      with a line indicating the fate of the neutral (e.g. ionised, hit wall,
      etc.). Hence a great deal of output is generated if the timestep is small!
      Setting this value to (say) 100 generates the first and last lines plus an
      extra line after every 100th timestep, similarly values of 1000, 10000
      etc. could be given here. </P>
    
    <P> </P>
    
    <H2><A NAME="debugd">Debug DIV (0 off, &gt;0 on)</A></H2>
    
    <P> Generates histories of ions tracked by DIV. Again, a value of 0
      switches the option off, a value of 1 produces copious output, and values
      of 100, 1000, 10000 etc. are often more helpful. Note: when variable
      timesteps are in use, the printed lines of debug are unlikely to occur at
      exactly the specified intervals. They might occur at 101.7, 215.3, 306.4
      instead of 100, 200, 300 for example. A variable timestep feature is not
      currently implemented in DIVIMP. The purpose of such a feature is to
      transport the ions more quickly, in terms of CPU time (i.e. ion
      iterations) in regions where events are occurring very slowly relative to
      the base timestep, as may be the case with the core plasma rings.</P>
    
    <P> </P>
    
    <H2><A NAME="debugv">Debug Ion Velocity (0 off, &gt;0 on)</A></H2>
    
    <P> This option will generate debugging information about the ion velocity
      distribution. The variables used for this are declared in the common block
      DIAGVEL. Among other things, this option will generate a distribution of
      the particle velocities as a multiple of the impurity ion sound speed at
      the inner target on the separatrix ring. This can be used for debugging
      collision options based on parallel velocity diffusion. This option will
      also generate average diffusive step size information for the spatial
      diffusion options. The value used to turn the option on is not significant
      at this time. Any value greater than zero will suffice.</P>
    
    <P> </P>
    
    <H2><A NAME="seed">Random number seed (0 generate new seed)</A></H2>
    
    <P> The random number generator is reset to a seed dependent on the time
      and date before starting any DIVIMP run if this item is left as 0.
      Occasionally it may be desirable to try and reproduce a case exactly (for
      debugging perhaps) when the random number seed can be read from the
      printout of the previous run and inserted here for the new run. In this
      case the given seed is used in place of any generated seed. </P>
    
    <P> </P>
    <H2><A NAME="pinseed">PIN/NIMBUS Random number seed (0 generate new seed)</A></H2>
    
    <P> The random number generator is reset using a specific seed value before 
    starting any PIN/NIMBUS. A value of 0 will generate a new seed for each PIN/NIMBUS
    run based onthe current date and time. A value of -1 will use the PIN/NIMBUS 
    default seed value of 1 for all runs. A value greater than 0 will use the specified 
    number for the PIN/NIMBUS seed. Occasionally it may be desirable to try and
    reproduce a case exactly (for debugging perhaps) when the random number 
    seed can be read from the
      printout of the previous run and inserted here for the new run. In this
      case the given seed is used in place of any generated seed. Historically, PIN/NIMBUS
      has been run using a fixed seed value that does not vary between runs.</P>
    
    <P> </P>
    
    <H2><A NAME="print">Print option (0 reduced, 1+)</A></H2>
    
    <P> This option provides a means of selecting the types of printouts. The
      reduced printout (enter 0 here) is enough for most cases. The various
      other printouts give additional information on various aspects of the
      simulation. Option 1 includes extra print-outs on bin sizes, ionization
      rates, characteristic times, and other items and is occasionally required.
      Other values that are used in the code are 2, 3, 4, and 9. These supply
      different print-outs and may be used for debugging. Print option 10
      requests the code to write out the calculated DIVIMP plasma background in
      a DIVIMP specific format. This plasma background may be read in by using
      plasma decay option 98.</P>
    
    <P><B>Print Option 0</B> : Standard DIVIMP print out. Adequate for most
      cases.</P>
    
    <P><B>Print Option 1</B> : Standard print out plus the following:</P>
    
    <P>- <A HREF="#extrct">Dperp Extractor</A> Print Out</P>
    
    <P>- <A HREF="#rprrn">Fast Scanning Probe</A> Data</P>
    
    <P>- Private Plasma Impurity Content Data</P>
    
    <P> <B>Print Option 2</B> : Standard Print out plus the following:</P>
    
    <P>- Detailed core leakage and source description information.</P>
    
    <P> <B>Print Option 3</B> : Standard Print out plus the following:</P>
    
    <P>- Debug - Additional Geometric Data about grids, targets and walls</P>
    
    <P> <B>Print Option 4</B> : Standard Print out plus the following:</P>
    
    <P>- Additional debug information about EDGE2D target conditions</P>
    
    <P> <B>Print Option 5</B> : Standard Print out plus the following:</P>
    
    <P>- Additional information about the background plasma conditions</P>
    
    <P>- Some extra characteristic times data</P>
    
    <P>- Retention predictor values</P>
    
    <P> <B>Print Option 6</B> : Standard Print out plus the following:</P>
    
    <P>- Writes the grid information to a separate file in a SONNET style </P>
    
    <P>format.</P>
    
    <P> <B>Print Option 7</B> : Standard Print out plus the following:</P>
    
    <P>- Extra PIN related data for debugging.</P>
    
    <P> <B>Print Option 9</B> : Standard Print option plus all other possible
      print-outs. This option is the same as turning on ALL print options from 1
      to 8. It is not recommended for use unless necessary since it generates a
      great deal of output. </P>
    
    <P> <B>Print Option 10</B>: Standard Print out plus the following: </P>
    
    <P>- Writes the finalized background plasma to a DIVIMP specific format
      that can be read in using Plasma Decay option 98. </P>
    
    <P> </P>

    <H2><A NAME="pinpr">PIN/NIMBUS Print option (0 regular, 1 more data)</A></H2>
    
    <P> This option provides a means of selecting enhanced print outs for a 
    PIN/NIMBUS run. Option 0 will result in a regular PIN/NIMBUS print out while 
    option 1 will cause additional information on the PIN/NIMBUS run to be
    included in the output files. Option 0 is all that is required for most purposes.</p>

    <P></P>
    
    <H2><A NAME="divitr">Number of Iterations</A></H2>
    
    <P> Usually this item will be set to 1. Further iterations can be made with
      new collision times, plasma density calculated from results of the
      previous iteration, with the ultimate aim of achieving a Self-Consistent
      Plasma. See Note 207. This option has not been used recently and may need
      to be debugged in conjunction with some of the later code additions.</P>
    
    <P> </P>
    
    <H2><A NAME="folcor">Stop following ions reaching Main Plasma 0no 1yes</A></H2>
    
    <P> This item has been used for testing SOL processes without using too
      much CPU time. Any ions reaching the main plasma are noted and their
      trajectories stopped.</P>
    
    <P> </P>
    
    <H2><A NAME="rectgr">Rectangular grid for neutrals 0calculate 99file</A></H2>
    
    <P> This option is NOT needed anymore, unless the <A HREF="#xygrid">XY-grid
      </A>option mentioned earlier in this document has been turned on. The XY
      grid was an older method for efficiently determining the grid element
      which an ion currently occupied. It was used originally because the cell
      polygon corner information was not available to DIVIMP and grid
      positioning was based on the closest cell center. Now that this
      information is generally available and used by DIVIMP, the XY grids are no
      longer required. This option remains in order to maintain compatibility
      with older grids. </P>
    
    <P>This option should be set to 0 whenever some new shot data is first used
      in order to create a set of index arrays relating the (ik,ir) grid to a
      straightforward rectangular (ix,iy) grid used for following neutrals. This
      calculation can be quite time consuming, especially if a fairly fine
      rectangular grid of say 201 by 200 elements is being used. Once the file
      has been created, set this option back to 99 for all subsequent runs using
      the same geometry data and connect the file to Unit number 13. In general,
      it has become preferable to use the grid position routine that uses the
      actual coordinates of the bin vertices to determine which bin a particle
      is in. This may require slightly more computational time while processing
      the particles, but it is more than compensated for by the greater accuracy
      in assigning the initial bin of the particles. Furthermore, for larger
      grids, it had become necessary to use XY grids with resolutions exceeding 
      1000 by 501 elements. Index arrays of this size require a significant
      amount of storage and CPU time to compute. Note, however, that the XY
      grids are still used in the OUT program for mapping the results onto an
      even XY grid for passing to the plot routines. As before, the indexing
      arrays are calculated only once and are then reused for subsequent runs.
      If one wishes to return to the previous system, it is necessary to adjust
      the values of parameters in the PARAMS, DIVXY and OUTXY common blocks.</P>
    
    <P> </P>
    
    <H2><A NAME="zo">Temperature Gradient Coefficient parameter - ZO</A></H2>
    
    <P> For use with <A HREF="#tegcoe">TeB</A> and <A HREF="#tigcof">TiB</A>
      gradient coefficient option 2. See note 412 for details.</P>
    
    <P> </P>
    
    <H2><A NAME="lostir">Lost SOL ring option</A></H2>
    
    <P> <B>Lost SOL Rings 0</B> : Plasma Set to minimum values</P>
    
    <P> <B>Lost SOL Rings 1</B> : Plasma Set to outer ring value</P>
    
    <P> </P>
    
    <H2><A NAME="vmultf">Velocity Multiplication Factors - for data read from
      files</A></H2>
    
    <P> This section specifies a block of data that defines factors to multiply
      the background velocity. The format of the input is as follows:</P>
    
    <P></P>
<pre>    
    ' ' ' Edge1D/2D Deuterium drift vel. mult. factor VMF '
    ' Number of VMF blocks ' 0 
    ' Ring range :- ' -20  -30
    ' J0 and J1 :-  '   5    5
    ' VMF0,1,2 :-   '  1.0  1.0  1.0
</pre>    
    <P>The meaning of the various quantities is...</P>
    
    <P>Number of VMF blocks. Defines the number of different sets of VMF data
      that will be entered. Each set of data consists of the three data lines
      listed above. Note that even when 0 sets of data are specified - at three
      lines of data must appear even though the information they contain is
      ignored. One reason for this is to keep the data entry format as part of
      the data file since the input format is somewhat cryptic. The ring range
      specifies the set of rings over which the data will be applied. These can
      be actual ring numbers, if such are known, or a set of symbolic negative
      numbers that specify specific rings. The negative numbers correspond to
      the following rings:</P>
    
    <P> Ring No. &lt; 1 1 (First main plasma ring)</P>
    
    <P> -10 IRSEP -1 (Last main plasma ring)</P>
    
    <P> -20 IRSEP (Separatrix - or first SOL ring)</P>
    
    <P> -30 IRWALL (Wall ring - or last SOL ring)</P>
    
    <P> -40 irwall+1 (Trap wall - or first trap ring)</P>
    
    <P> -50 NRS (Last ring - innermost trap ring)</P>
    
    <P>The quantities J0 and J1 define the number of bins from each end of the
      ring over which the multipliers will be applied. So, values of 5 and 5
      define the first 5 bins as region 0 and the last 5 as region 2. The three
      VMF factors specify the velocity multiplier that will be applied in each
      of these regions. In region 0 and 2 the value scales linearly up to the
      quantity in region 1 which will in turn apply over the central region.</P>
    
    <P> </P>
    
    <H2><A NAME="ilosst">Ion Loss Time</A></H2>
    
    <P> This quantity defines an arbitrary ion removal function with the
      characteristic time defined by this value. The probability of an ion being
      eliminated on any specific time step is QTIM/LOSSTIME. A value of 0.0
      entered for this will turn this function off. (This would be the
      equivalent of an infinite loss time.) </P>
    
    <P><B>NOTE:</B> It is very important to keep in mind the nature of random
      number generators when using this and other similar functions in a Monte
      Carlo code or any code that depends on random numbers. As an example,
      assume a characteristic loss time of one second was specified, then the
      probability of elimination on any time step would be 10<SUP>-7</SUP>.
      Unfortunately, the spectrum of many simple random number generators yield
      a maximum of ~1/32500 or at best - a probability division of 10<SUP>-5</SUP>.
      If the condition test range is 0 &lt;= ran &lt; prob, then usually the
      result is obtained with a probability of ~ 10<SUP>-5</SUP> since the
      value 0.0 is usually a part of the spectrum of these simple random number
      generators. This can skew the likelihood of low probability events and in
      addition can be very difficult to discover.</P>
    
    <P> </P>
    
    <H2><A NAME="powden">Power Density - P/A</A></H2>
    
    <P> This specifies the power flow along the field lines for
      <A HREF="#tegrad">Temperature gradient </A>option 2.</P>
    
    <P> </P>
    
    <H2><A NAME="k0">Parallel heat conduction coefficient - K0</A></H2>
    
    <P> This is the conduction coefficient used for both electrons and ions in
      <A HREF="#tegrad">Temperature gradient</A> options 2,3,4 and 6, and
      exclusively for electrons in options 5 and 7 as well as other SOL options.</P>
    
    <P> </P>
    
    <H2><A NAME="k0i">Parallel ion heat conduction coefficient - K0i</A></H2>
    
    <P> This is the conduction coefficient used for ions in <A HREF="#tigrad">Temperature
        gradient</A> options 5 and 7 as well as other SOL options.</P>
    
    <P> </P>
    
    <H2><A NAME="efield">Electric field option - overrides other E-field
      options or data</A></H2>
    
    <P> This option allows the behaviour of the electric field to be specified
      - including over-riding any electric field read in from a background
      plasma file. </P>
    
    <P> <B>Electric field 0</B> : Electric field as read from file is used.</P>
    
    <P> <B>Electric field 1</B> : Electric field is set to zero everywhere.</P>
    
    <P> <B>Electric field 2</B> : For use with simple SOL options. E -&gt; 0
      for S &gt; a specified fraction of SMAX.</P>
    
    <P> <B>Electric field 3</B> : Electric field calculated using the standard
      formula based on pressure and temperature gradients is used everywhere.
      This replaces any other electric field that has been read in or specified.
      Note that in the following formula - T is in eV and P=NT where T is again
      in eV. Thus there are several instances where the factor e (the electronic
      charge) cancels out.</P>
    
    <P> <IMG SRC="images/divref-120.gif" WIDTH="269" HEIGHT="56"></P>
     
    <P> <B>Electric field 4</B> : The formula from option 3 is used for
      half-rings that are deemed to be &quot;collisional&quot;. For half-rings
      that are not &quot;collisional&quot;, the following formula is used. </P>
    
    <P> <IMG SRC="images/divref-117.gif" WIDTH="253" HEIGHT="58"></P>
    
    <P> &quot;Collisionality&quot; is determined by an ad hoc method. If the
      electron temperature at the midpoint of the ring is less than a certain
      multiple of the target Te then the half-ring is deemed to be
      non-collisional. The value of this multiplier is entered in the input data
      file as the second entry after this option. </P>
    
    <P> The source length used above is also arbitrary. The value for the
      initial source length is given as a multiplier of SMAX for a given ring.
      This is also described below. If PIN has been run then the value of Lequiv
      (the source equivalent length) that is calculated after PIN has been run,
      is used instead of this specified Lsource value. </P>
    
    <P> </P>
    
    <H2><A NAME="ef4-1">Electric Field Option 4 - Source Length Specifier</A></H2>
    
    <P> This value specifies the length of the source to be used on the first
      iteration of the overriding E-field option. If PIN has been run then the
      calculated values of the ion source equivalent length at each end of each
      flux tube are used instead of this imposed value.</P>
    
    <P> </P>
    
    <H2><A NAME="ef4-2">Electric Field Option 4 - Collisional Determination
      Factor</A></H2>
    
    <P> This value is used to decide whether a particular half flux tube is to
      be treated as if it was non-collisional. If the electron temperature at
      the midpoint is less than this value times the target electron temperature
      then this half flux tube will be treated as non-collisional for the
      purposes of this E-field option. The logical oddity arises from the fact
      that most of the background plasmas to which this option will be applied
      will have been calculated with the basic fluid assumption that the
      background is collisional throughout the range of solution.</P>
    
    <P> </P>
    
    <H2><A NAME="s12-ls">Ionization Source-characteristic length- SOL12 to 15
      - Ls</A></H2>
    
    <P> This quantity defines the characteristic length for the
      <A HREF="#s12-iz">ionization source options</A> used in the SOL models in
      SOL options 12 to 15 as a proportion of the total length of the SOL.</P>
    
    <P> </P>
    
    <H2><A NAME="s12-l2">Ionization Source- Second characteristic length - L<SUB>2</SUB></A></H2>
    
    <P> This defines the second characteristic length for <A HREF="#s12-iz">ion
        source options</A> 4 and 5 which involve a combination of linear and
      exponential functions superimposed.</P>
    
    <P> </P>
    
    <H2><A NAME="s12-fi">Ionization Source- Source Fraction - Fi</A></H2>
    
    <P> This quantity specifies the ratio of source strengths between the two
      discrete ionization sources that are superimposed in <A HREF="#s12-iz">ionization
        options</A> 4 and 5.</P>
    
    <P> </P>
    
    <H2><A NAME="s12-lr">Radiation Source-characteristic length- SOL12 to 15 -
      Lr</A></H2>
    
    <P> This quantity defines the characteristic length for the
      <A HREF="#s12rad">radiative source options</A> used in the SOL models in
      SOL options 12 to 15 as a proportion of the total length of the SOL.</P>
    
    <P> </P>
    
    <H2><A NAME="s12-pa">Radiative Power Constant - SOL12 to 15 - Pr/A (W/m<SUP>2</SUP>)</A></H2>
    
    <P> This defines the radiative loss constant used in the power loss model
      for SOL options 12 to 15.</P>
    
    <P> </P>
    
    <H2><A NAME="s12frr">Radiation Source strength fraction - Frr</A></H2>
    
    <P> This quantity is used in <A HREF="#s12rad">radiation options</A> 2 and
      3 to specify the radiation source strength relative to the total power at
      the plates. The exact description is in the equations under the respective
      radiation options.</P>
    
    <P> </P>
    
    <H2><A NAME="s12-iz">Ionization Source Option - SOL12 to 15</A></H2>
    
    <P> <B>Ionization opt 0</B> : Ionization constant over 0 &lt; s &lt; Ls *
      SMAX</P>
    
    <P> With S<SUB>0</SUB> = - N<SUB>0</SUB> X V<SUB>0</SUB></P>
    
    <P> <B>Ionization opt 1</B> : Exponential decay described by:</P>
    
    <P> <IMG SRC="images/divref-42.gif" WIDTH="320" HEIGHT="196"></P>
    
    <P> Options 2 and 3 are equivalent to the Ionization source options that
      can be initially specified, except that they only apply to PIN ionization
      data and because of this can not be specified initially since PIN data is
      not immediately available.</P>
    
    <P><B>Ionization opt 2</B> : The PIN ionization data for each ring is
      normalized so that the total ionization (to the midplane) is equal to the
      outflow at the plate. </P>
    
    <P><B>Ionization opt 3</B> : The PIN ionization data is utilized in an
      unnormalized form so over/under ionization on each flux tube is allowed
      and other effects arising from the background ionization distribution can
      be realized. (e.g.Flow recirculation).</P>
    
    <P> In addition, the following normal ionization source options have been
      added, in conformance with TN740.</P>
    
    <P> <B>Ionization opt 4 </B>: Combination of two constant sources of the
      type shown in option 0. The combination is described by the following
      equation.</P>
    
    <P> <IMG SRC="images/divref-43.gif" WIDTH="276" HEIGHT="293"></P>
    
    <P> <B>Ionization opt 5</B> : Combination of a constant source (as in
      option 0) and an exponential source (as in option 1). The combination is
      described by the following </P>
    
    <P> equations.</P>
    
    <P> <IMG SRC="images/divref-44.gif" WIDTH="275" HEIGHT="166"></P>
    
    <P> </P>
    
    <H2><A NAME="s12rad">Radiative Source Option - SOL12 to 15</A></H2>
    
    <P> <B>Radiative opt 0</B> : Constant over 0 &lt; s &lt; Lr * SMAX</P>
    
    <P> With Pr/A given previously.</P>
    
    <P> <B>Radiative opt 1</B> : Exponential decay described by:</P>
    
    <P> <IMG SRC="images/divref-45.gif" WIDTH="276" HEIGHT="53"></P>
    
    <P> With Pr0/A given previously.</P>
    
    <P> <B>Radiative opt 2</B> : Constant over 0 &lt; s &lt; Lr * SMAX with
      the constant value given by the following equation.</P>
    
    <P> <IMG SRC="images/divref-46.gif" WIDTH="123" HEIGHT="76"></P>
    
    <P> </P>
    
    <P> Where F<SUB>rr</SUB> is the radiative source strength fraction that is
      defined previously.</P>
    
    <P> <B>Radiative opt 3</B> : Exponential decay of source described by the
      following equations.</P>
    
    <P> <IMG SRC="images/divref-47.gif" WIDTH="208" HEIGHT="53"></P>
    
    <P> <IMG SRC="images/divref-48.gif" WIDTH="373" HEIGHT="103"></P>
    
    <P> Where F<SUB>rr</SUB> is the radiative source strength fraction that is
      defined previously.</P>
    
    <P> </P>
    
    <H2><A NAME="s12img">Imaginary Root Option</A></H2>
    
    <P> This option is another flag that is applicable only to SOL options 12
      to 15. Some of the equations that are solved for the background plasma
      involve a square root. The quantities in the square root can become
      imaginary. This is representative of a transition from sub-sonic to
      super-sonic flow. There are two options available here. Option 0 ... the
      flow is not restricted and any imaginary quantities are set to zero.
      Option 1 ... the local velocity is capped at the sound speed and the
      equation that involves the calculation of the square root is not utilized
      if it will involve an imaginary result.</P>
    
    <P> </P>
    
    <H2><A NAME="s12flu">Flux Recirculation Option - SOL 12 to 15</A></H2>
    
    <P> This flag turns flux recirculation in SOL options 12 to 15 on and off.
      Flux recirculation is allowed for via over and under ionization on each
      flux tube. The source characteristics when the flux recirculation option
      is on are specified by the next entry. Note that if a multiplication
      factor of 1.0 is used, this is equivalent to no flux recirculation since
      the ionization on the ring is equal to the net influx. However, it does
      allow the following entry to be used to specify different source
      characteristics for each ring.</P>
    
    <P> <B>Flux Recirculation Option 0</B>: Flux Recirculation Off</P>
    
    <P> <B>Flux Recirculation Option 1</B>: Flux Recirculation ON</P>
    
    <P> </P>
    
    <H2><A NAME="s12fss">Flux Recirculation - Source Specifications</A></H2>
    
    <P> The first line contains the description of the entry. The second line
      has headings and then the number of lines to follow in the table of flux
      recirculation data. The contents of the table are:</P>
    
    <P>Ring number Flux multiplication factor Source Length Source Decay Length</P>
    
    <P>These specify the characteristics of the ion source for each ring. The
      Flux multiplication factor represents the quantity of over/under
      ionization to be found on that ring/flux-tube. A value of 1.0 for this
      results in no flux recirculation. (i.e. outflux=ionization) A value of 0.5
      means that there will be 1/2 as much ionization on the flux-tube as there
      is flux to the plates and a factor 2.0 will result in twice as much
      ionization. This results in flow reversal or increased flow to the plates
      occurring in the calculation of the background velocities in SOL 12 to 15.
      The Source Length and Source Decay Length are the same as are generally
      specified except that they can be customized for each flux tube.</P>
    
    <P> </P>
    
    <H2><A NAME="zlim">Z-Limit for divertor</A></H2>
    
    <P> Defines an arbitrary Z-point above which is considered the divertor
      influenced region. This is useful in calculating some quantities that are
      later plotted. One example is the density decay in the outermost SOL rings
      which is affected by the behaviour near the plates. In essence this
      quantity is used to define (very roughly) a near divertor region.</P>
    
    <P> </P>
    
    <H2><A NAME="injir">Ring number for ion injection -injection option
      2,3,5,6 - INJIR</A></H2>
    
    <P> Specifies the ring number for ions to be injected on for <A HREF="#inj">injection
        option</A> 2.</P>
    
    <P> </P>
    
    <H2><A NAME="inj1">Injection region -Lower Bound-injection option 2,3,5,6
      - INJ1</A></H2>
    
    <P> Lower bound injection multiplier. The ions will be injected between
      INJ1*SMAX and INJ2*SMAX symmetrically from both plates. Thus values of .15
      and .2 will result in ion injection in the two regions 0.15 * SMAX to 0.2
      * SMAX and 0.80 * SMAX to 0.85 * SMAX. For options 3 and 5, the particles
      will be injected between INJ1*SMAX and INJ2*SMAX, wherever that may be,
      including values of INJ1, INJ2 &gt; 0.5 and &lt; 1.0.</P>
    
    <P> </P>
    
    <H2><A NAME="inj2">Injection region -Upper Bound-injection option 2,3,5,6
      - INJ2</A></H2>
    
    <P> Upper bound as described above.</P>
    
    <P> </P>
    
    <H2><A NAME="fpwid">Far Periphery Width definition</A></H2>
    
    <P> This defines the &quot;width&quot; in meters of the <A HREF="#periph">far
        periphery region model</A>. Ions must diffuse cross-field this far in
      order to be considered as striking the walls. Different values for the
      OUTER and INNER halves of the main plasma may be specified. The other loss
      mechanisms from the far periphery region include diffusing back into the
      main plasma and far periphery loss to the target plates with a
      characteristic time specified by the following quantity.</P>
    
    <P>e.g. 'TN443 X-max for Far Periphery Region (Outer/Inner)' 0.1 0.1</P>
    
    <P> </P>
    
    <H2><A NAME="fptarl">Far Periphery Target Loss - characteristic time</A></H2>
    
    <P> This defines the probability, in an arbitrary sense, that an ion
      entering the far periphery will experience sufficient parallel diffusion
      or other effects to carry it to the target plates outside the normal
      strike zones. The loss time is entered in units of seconds. Different
      values may be specified for the OUTER and INNER halves of the main plasma
      edge as described above for the Far Periphery width. These ions do not at
      this time result in self-sputtering - but the totals of such particles are
      recorded for later analysis. These particles may be re-launched from the
      corners of the targets closest to their point of entry into the Far
      Peripheral Region. (See the input option TN998 - Far Periphery Recycle
      Option described earlier.) </P>
    
    <P> </P>
    
    <H2><A NAME="fpdiff">Far Periphery Diffusion Rate</A></H2>
    
    <P> This specifies the diffusion coefficient (m<SUP>2</SUP>s<SUP>-1</SUP>)
      to be used for the far periphery region. This can be used to vary the ion
      sink strength of the periphery region by increasing the rate of
      cross-field diffusion. It can be set to any value. A value less than zero
      results in the diffusion coefficient in the far periphery region being the
      same as that used for the rest of the plasma.</P>
    
    <P> </P>
    
    <H2><A NAME="wprmul">Wall Launch Segment Probability Multipliers</A></H2>
    
    <P> This applies to the <A HREF="#launch">Wall Launch option</A> (option
      2). The wall is composed (presently) of a set of line segments joining the
      points defining the outermost SOL ring, both plates, and the outermost
      trap ring. Depending on the geometry, there are approximately 60 of these
      segments. For the wall launch, all of the target segments automatically
      have a probability multiplier of zero - thus preventing wall launches from
      occurring at the targets. (The previous statement may no longer be true in
      some DIVIMP versions, i.e. the targets will be included as valid sources
      of wall-launched particles, so it is desirable to explicitly set the
      launch probability modifiers for these segments to zero.) In addition,
      this option can be used to further restrict and/or limit the probability
      of neutral launch from any particular wall segment or range of wall
      segments. Initially, the probability of launch from a specific segment is
      proportional to the length of that segment. This function will modify
      those probabilities.</P>
    
    <P> </P>

<pre>    
    ' ' ' TN487 Launch Probability modifiers for each '
    ' TN487 wall segment range #1 #2 mod. :- ' 2
       1   28   0.0
      53   60   0.0
</pre>
    
    <P>The example above prevents neutral launch from the first half of the
      main wall region and from the walls of the trapped plasma region. The
      probability modifiers could as easily have been set to 0.1 to reduce but
      not eliminate the wall sources in these regions or to a value greater than
      1.0 to enhance the probability of launch from these regions. </P>
    
    <P>This option is also used, in combination with the following option, to
      specify the proportional probability of launch from each wall segment. The
      lengths of the wall segments are ignored and the values in this table
      substituted and normalized to 1.0 to generate a wall launch distribution.
      Finally, if the wall launch probability data is being generated directly
      from the results of a PIN run then this table can be used to modify those
      numbers via a mechanism the same as that above.</P>
    
    <P> </P>
    
    <H2><A NAME="abspro">Absolute Wall Probabilities</A></H2>
    
    <P> <B>Option 0</B>: Off - treat wall launch data as multipliers of
      initial wall segment launch probability which is calculated based on the
      relative size of the wall segments.</P>
    
    <P> <B>Option 1</B>: On - treat wall launch probabilities as actual
      segment probability weightings.</P>
    
    <P>When this is set to 0, the values in the table above are taken as
      relative multipliers of wall launch probabilities obtained through another
      method. If it is set to 1, then the values entered in the table above are
      used as the actual weight for launch from that specific wall segment with
      the sum total of all weights equal to one and the individual weights
      renormalized using that sum.</P>
    
    <P> <B>Option 2</B>: On - Wall Segment Launch probabilty is loaded from PIN and 
      multiplied by the probability modifiers.</p>

    <P> <B>Option 3</B>: On - Wall Segment Launch probabilty is loaded from PIN and 
      is NOT multiplied by the probability modifiers.</p>


    <P> </P>
    
    <H2><A NAME="polv">Poloidal Drift Velocity - Vpol (m/s)</A></H2>
    
    <P> This is the drift velocity used if <A HREF="#poldrf">poloidal drift
        option</A> 1 is specified. This velocity is applied along the field
      lines in the SOL. It is not imposed directly on the motion in the poloidal
      plane.</P>
    
    <P> </P>

    <H2><A NAME="polvr">Poloidal Drift Velocity - Range of Effect</A></H2>
    
    <P> This entry specifies two values. These are the start and stop points of the range of 
    effect of the poloidal drift velocity. These numbers are expressed as a fraction of SMAX
    along each individual flux tube. If <A HREF="#poldrf">poloidal drift
    option</A> 1 is specified then this velocity is applied along the field
    lines in the SOL for particles in the region from Factor1 * SMAX < S < Factor2 * SMAX.
    For example, if Factor1 is specified as 0.1 and Factor2 is 0.9 then the poloidal drift velocity
    will act on particles when their S-position is in the range 0.1 < S/SMAX < 0.9.</P>
    
    <P> </P>
    
    <H2><A NAME="emaxf">Emax-factor for NEUT launch velocity - Emaxf</A></H2>
    
    <P> Required for NEUT cases with <A HREF="#vaflag">Vel/ang flag</A> 4 or
      5. This allows us to adjust the cut-off on the velocity distribution at
      launch. This factor is normally set to 1.0 but can be adjusted up or down
      (Note 93).</P>
    
    <P> </P>
    
    <H2><A NAME="wlener">Impurity ion impact energy for Wall Launch neutrals</A></H2>
    
    <P> This is part of the formula for calculating the maximum launch energy
      available to wall launched neutrals. It represents the mean or average
      expected impact energy of the particles causing the neutral wall particles
      to sputter.</P>
    
    <P> </P>
    
    <H2><A NAME="runpin">Run PIN Option</A></H2>
    
    <P> <B>Run PIN Option 0</B> : PIN is not executed from within DIVIMP.</P>
    
    <P> <B>Run PIN Option 1</B> : Execute PIN from inside DIVIMP and import
      results.</P>
    
    <P>This on/off switch instructs DIVIMP, when running JET grids, to invoke
      PIN and pass it the background plasma characteristics. PIN then invokes
      NIMBUS, a hydrogenic neutral code that follows the hydrogen background
      given the initial DIVIMP plasma and generates the expected distribution of
      hydrogen ionization as well as carbon sputtering, charge exchange and
      several other quantities. This information can then be imported back into
      DIVIMP and used for several different purposes. (e.g. Recalculation of the
      background plasma using the PIN source ionization, calculation of charge
      exchange probabilities using the hydrogen neutral densities, plotting of
      Halpha radiation distributions, Carbon ion launch based on the
      distribution of primary Carbon ionization and several other
      possibilities.)</P>
    
    <P>Note: PIN can be run from DIVIMP in a number of ways. The whole PIN
      module can be bound to DIVIMP and invoked as a subroutine. Alternatively,
      PIN can be invoked as a stand-alone program that is called from inside
      DIVIMP and while running, the DIVIMP process is not active. Each procedure
      has different advantages and disadvantages and the option chosen is
      architecture and processor specific.</P>
    
    <P>If this option is invoked when DIVIMP is being run on a Sonnet grid then
      DIVIMP will write a background plasma file in the B2/EIRENE format and
      then invoke EIRENE to calculate the hydrogenic behaviour. EIRENE is an
      alternate Monte Carlo hydrogen code that is available and runs on Sonnet
      grids. It reads it's input from a data file in the EIRENE subdirectory.
      This information in this data file needs to be tailored to the specific
      machine specifications and contains all of the simulations parameters
      required by EIRENE. The name of this file is passed as a command-line
      parameter to the reirediv script. If a datafile name is not specified it
      uses a default file called &quot;asdex.dat&quot;</P>
    
    <P> </P>
    
    <H2><A NAME="pincom">PIN Command Line</A></H2>
    
    <P> This is not a simple optional choice or specifiable value. It should
      contain the UNIX command to execute PIN with the appropriate options. </P>
    
    <P> e.g. rpindiv</P>
    
    <P> or</P>
    
    <P> reirediv</P>
    
    <P>The name (rpindiv) is the name of the command file that will execute
      PIN. The character string in UNIX is passed directly to the operating
      system by the SYSTEM subroutine and is then executed. The input for this
      option would be ignored if PIN has been bound to the DIVIMP executable and
      is being called as a subroutine. The script file obtains the name of the
      case and other information from environment variables that are set when
      the script that runs DIVIMP begins executing.</P>
    
    <P> </P>
    
    <H2><A NAME="ihcorr">PIN Cell Area Option (IHCORR)</A></H2>
    
    <P> NIMBUS has two methods for calculating the cell areas. These two
      methods do NOT give the same results either for cell area or for final
      results from the neutral code. As a result we have added this as a DIVIMP
      input parameter that is passed directly to NIMBUS. IHCORR=0 will instruct
      NIMBUS to use the EDGE2D cell areas based on the formula Rho * Theta *
      Drho * Dtheta while IHCORR=1 instructs NIMBUS to use the cell polygon
      areas. </P>
    
    <P> </P>
    
    <H2><A NAME="hybrid">PIN Hybrid Wall Option</A></H2>
    
    <P> This option applies only to PIN runs on JET grids. It selects one of a
      limited set of hybrid wall specifications. The option seeks to simulate an
      &quot;average&quot; wall for JET by allowing for a wall with greater gaps
      between the plasma and the wall than is done when the grid file is
      created. The hybrid wall file contains wall descriptions for both MKII and
      MKIIa divertor configurations.</P>
    
    <P> <B>Hybrid Wall Option 0</B>: Off. This option specifies the use of the
      Standard Wall in the grid file.</P>
    
    <P> <B>Hybrid Wall Option 1</B>: On. Use the MKII hybrid wall specified in
      the ancillary input file &quot;hybrid.dat&quot;. </P>
    
    <P> <B>Hybrid Wall Option 2</B>: On. Use the MKIIa hybrid wall
      specification found in the same input file as option 1.</P>

    <P> <B>Hybrid Wall Option 3</B>: On. Use the corrected MKIIa hybrid wall
      specification found in the same input file as option 1.</P>

    <P> <B>Hybrid Wall Option 4</B>: On. Use the modified corrected MKIIa hybrid wall
      specification found in the same input file as option 1.</P>
    
    <P> </P>
    
    <H2><A NAME="ppuff">PIN Puffing Option</A> </H2>
    
    <P> This option specifies the form of the PIN/NIMBUS puffing that will be
      used if NIMBUS is run. Puffing is the process of adding additional sources
      to the hydrogenic Monte Carlo solution that is produced by NIMBUS. (See:
      TN1421, 10 Sept. 1996; Memos of L.Horton of 6 Aug. 1996, 16 Aug. 1996, 20
      Aug.1996, 9 Sept.1996, 27 Oct.1996,) </P>
    
    <P> <B>PIN/NIMBUS Puffing Option 0</B>: Puffing is OFF.</P>
    
    <P> <B>PIN/NIMBUS Puffing Option 1</B>: Puffing is ON.</P>
    
    <P> Particles lost to the Albedo (PUMP) escape regions are re-injected with
      characteristics specified by the following quantities. The puffing will
      only occur on subsequent iterations of PIN because the neutral code does
      not know how many will be lost until it has finished and thus can not puff
      these at the beginning.</P>
    
    <P> Puff Fraction (proportion of losses reinjected) = <A HREF="#hpcpuf">HPCPUF</A>.</P>
    
    <P> Puff Temperature (eV) = <A HREF="#tpufh">TPUFH</A>.</P>
    
    <P> The location of the puff is specified by the location option in
      combination with the segment specifiers.</P>
    
    <P> <B>PIN/NIMBUS Puffing Option 2</B>: Puffing is ON.</P>
    
    <P> A portion of the target flux is injected as a puff instead. </P>
    
    <P> Fraction of target flux to be puffed = <A HREF="#ppcpuf">PPCPUF</A></P>
    
    <P> Puff Temperature (eV) = <A HREF="#tpufh">TPUFH</A></P>
    
    <P> The location of the puff is specified by the location option in
      combination with the segment specifiers.</P>
    
    <P> </P>
    
    <H2><A NAME="ppuffl">PIN Puff Location Switch</A></H2>
    
    <P> This switch determines the general location of the puffed particles.
      The <A HREF="#jhpuf1">segment specifiers</A> allow the region of the
      source to be fine-tuned. </P>
    
    <P> <B>PIN/NIMBUS Puff Location option 0</B>: From main SOL walls.</P>
    
    <P> <B>PIN/NIMBUS Puff Location option 1</B>: From private void walls.</P>
    
    <P> </P>
    
    <H2><A NAME="hpcpuf">PIN Puff Fraction - HPCPUF</A> </H2>
    
    <P> This parameter applies to puff option 1 only. It specifies the fraction
      of all particles lost to the Albedo regions that will be re-injected by
      puffing. Thus a value of 1.0 will result in all Albedo losses from the
      system being re-injected. This will not work on the first PIN iteration -
      only on subsequent ones. </P>
    
    <P> </P>
    
    <H2><A NAME="ppcpuf">PIN Flux Puff Fraction - PPCPUF</A></H2>
    
    <P> This parameter applies to Puff option 2 only. It specifies a fraction
      of the total target flux that is redirected into a puffed hydrogen source.
      A value of 0.0 should result in no extra source even if puff option 2 is
      in use. </P>
    
    <P> </P>
    
    <H2><A NAME="tpufh">PIN Puff Injection Temperature (eV) - TPUFH</A></H2>
    
    <P> This is the initial temperature of the puffed hydrogen atoms. (Note: It
      is not clear at this time whether NIMBUS actually puffs these particles as
      atoms or molecules. It is believed that they are puffed as atoms but there
      is no confirmation of this at this time.) </P>
    
    <P> </P>
    
    <H2><A NAME="jhpuf1">PIN Puff Location Indices - JHPUF1</A></H2>
    
    <P> The exact meaning of these numbers is difficult to determine before
      running a case and becoming familiar with the particular grid. The
      following quantities - JHPUF1(1), JHPUF2(1), JHPUF1(2) and JHPUF2(2) are
      integers that define the indices of the wall segments from which puffing
      will occur. There are two relationships that need to be defined before
      these numbers can be interpreted. First, how are the indices of the outer
      grid segments defined inside the NIMBUS/EDGE2D code for an arbitrary grid?
      Second, how are the numbers specified here employed to determine valid
      puff segments? </P>
    
    <P>1) NIMBUS puffs neutrals in these cases from the outermost boundary of
      the plasma grid. The neutrals are then followed towards the outer wall -
      reflect from the wall - and then re-enter the plasma or are removed by
      other methods. (i.e. Albedo or core loss). The index numbers of these
      segments are defined in the following manner. </P>
    
    <P>All rings have the same number of cells. There is a certain number of
      cells along the separatrix ring on both the left and right divertor legs
      that are adjacent to private plasma cells. The rest are adjacent to cells
      in the core plasma. The number of the cell that is first adjacent to a
      core cell is designated as JPRGT. The number of the last cell on the
      separatrix adjacent to a core cell is called JPLFT. All of the cell
      indexing for main SOL wall launches is done relative to these two
      positions. In addition, although the private plasma rings in DIVIMP are
      treated as separate and smaller rings - in the fluid codes (EDGE2D or B2)
      and in the hydrogenic Monte Carlo codes (NIMBUS or EIRENE) - the private
      plasma rings are extensions of the corresponding core rings. Each of these
      combined private plasma + core rings has the same number of cells - in
      these other codes - as the main SOL rings. As a result, designation of the
      puffing segments in the private plasma is handled in a somewhat similar
      fashion to main SOL puffing.</P>
    
    <P>2) The numbers specified in these inputs are interpreted in the
      following way to determine at which boundary segments the puff should
      occur. </P>
    
    <P>In the case of main SOL puffing - Segments J - satisfying the following
      relationships are selected for puffing.</P>
    
    <P> A) JPRGT + JHPUF1(1) ( J ( JPRGT + JHPUF2(1)</P>
    
    <P> or JPLFT - JHPUF2(2) ( J ( JPLFT - JHPUF1(2)</P>
    
    <P> Examples: (1) To puff from the corner of the right target up to the
      X-point.</P>
    
    <P> JHPUF1(1) = -1000 JHPUF2(1) = -1</P>
    
    <P>( Using -1000 will guarantee that all knots on the boundary of the grid
      from the right X-point down to the target will be selected. (Unless one is
      using an incredibly large grid.) A value of -1 will start the puffing at
      the first segment whose corresponding cell on the separatrix is adjacent
      to the private plasma. Unless the grid is very non-orthogonal JPRGT and
      JPLFT will roughly correspond to the cells just up from the Xpoint.</P>
    
    <P> ( To puff from the corner of the left target up to the X-point simply
      set </P>
    
    <P> JHPUF1(2) = -1000 JHPUF2(2) = -1</P>
    
    <P> ( This will do exactly the same as the above except for the left target</P>
    
    <P> (2) To puff from the entire main SOL wall.</P>
    
    <P> JHPUF1(1) = -1000 JHPUF2(1) = 1000</P>
    
    <P> ( This will select the entire wall.</P>
    
    <P> ( Wall segments will not be selected &quot;twice&quot; if overlapping
      regions from the right and left targets are specified. To turn OFF puffing
      relative to one of the conditions just specify values for JHPUF that can
      not be satisfied.</P>
    
    <P> JHPUF1(2) = 1 JHPUF2(2) = 0</P>
    
    <P> ( For the left target - this would require that JPLFT ( J ( JPLFT -1
      which can not be satisfied and thus no segments would be selected for
      puffing through this condition. </P>
    
    <P> (3) To puff from the top of the torus. This can be specified relative
      to either target and knowledge of the values of JPRGT and JPLFT as well as
      what numbers correspond to what boundary elements is required before these
      can be specified with confidence. IF - (for example) - JPRGT = 10 and
      JPLFT = 30 then the middle segment between these two might be roughly 20.
      To select this segment for puffing one could choose to set the following
      values.</P>
    
    <P> JHPUF1(1) = 10 JHPUF2(1) = 10</P>
    
    <P> JHPUF1(2) = 1 JHPUF2(2) = 0</P>
    
    <P> ( These should select the segment numbered 20 relative to the right
      target. To puff from both the 20th and 21st - set the values in the first
      line to the following.</P>
    
    <P> JHPUF1(1) = 10 JHPUF2(1) = 11</P>
    
    <P>In the case of puffing in the private plasma the following relationship
      is used to define which segments to puff from. The values entered for
      JHPUF1(2) and JHPUF2(2) have no relevance for a private plasma boundary
      puff source.</P>
    
    <P> B) J &lt; JPRGT or J &gt; JPLFT</P>
    
    <P> and 1 + JHPUF1(1) ( J ( NR - JHPUF2(1)</P>
    
    <P> NR is the total number of segments on the ring.</P>
    
    <P> Examples: (1) To puff from the entire private plasma boundary.</P>
    
    <P> JHPUF1(1) = 0 JHPUF2(1) = 0</P>
    
    <P> (2) To puff from the right side of the private plasma boundary</P>
    
    <P> JHPUF1(1) = JPRGT JHPUF2(1) = 0</P>
    
    <P> (3) To puff from the left side of the private plasma boundary</P>
    
    <P> JHPUF1(1) = JPLFT JHPUF2(1) = 0</P>
    
    <P> (4) To puff from the middle segments of the private plasma boundary</P>
    
    <P> JHPUF1(1) = JPRGT-1 JHPUF2(1) = JPLFT+1</P>
    
    <P>These are indices that specify the bounds of the region from which the
      extra puffing will occur. The general region is specified by the location
      option. These parameters allow the specific segments or range of segments
      to be selected. The default values of JHPUF1 and JHPUF2 together should
      result in the entire main plasma wall or the entire private void wall
      being specified as the injection region. </P>
    
    <P>The default entry for this quantity is:</P>
    
    <P>' PIN Puff Location Indices JHPUF1 (1 and 2) ' -1000 -1000</P>
    
    <P> </P>
    
    <H2><A NAME="jhpuf2">PIN Puff Location Indices - JHPUF2</A></H2>
    
    <P> See the previous entry for a detailed description of the meaning and
      interpretation of these parameters.</P>
    
    <P>These are indices that specify the bounds of the region from which the
      extra puffing will occur. The general region is specified by the location
      option. These parameters allow the specific segments or range of segments
      to be selected. The default values of JHPUF1 and JHPUF2 together should
      result in the entire main plasma wall or the entire private void wall
      being specified as the injection region. </P>
    
    <P>The default entry for this quantity is:</P>
    
    <P>' PIN Puff Location Indices JHPUF2 (1 and 2) ' -1 -1</P>
    
    <P> </P>
    
    <H2><A NAME="solite">Iterate SOL Option</A> </H2>
    
    <P> <B>Iterate SOL Opt 0</B> : Off - Do NOT calculate the SOL iteratively
      if PIN has been run. This allows the use of PIN data without requiring a
      recalculation of the background characteristics.</P>
    
    <P> <B>Iterate SOL Opt 1</B> : On - Re-calculate the characteristics of
      the SOL a <A HREF="#nsolit">specified number of times</A>, recalculating
      each time after PIN has been executed. If the correct options are
      selected, this will use the PIN generated data in the SOL recalculation.</P>
    
    <P> </P>
    
    <H2><A NAME="secsol">Secondary SOL option</A></H2>
    
    <P> This specifies the <A HREF="#sol">SOL option</A> to be used in the
      plasma background recalculation. It is allowed to differ from the SOL
      option originally specified. Of course, if a SOL option is chosen that
      does not use the data generated by iteration then the calculated
      background plasma will be unchanged. This may be useful wen trying to
      stabilize the effect of PIN puffing. If this option is specified as &quot;-2&quot;
      then the iteration will automatically use the same SOL option as was
      specified for the first iteration. </P>
    
    <P> </P>
    
    <H2><A NAME="ssoliz">Ionization Option for Iterative SOL</A></H2>
    
    <P> This is the same as the <A HREF="#s12-iz">ionization source options</A>
      specified previously for SOL 12 to 15, except that only ionization options
      2 and 3 are meaningful. Option 2 will normalize the ionization data on the
      flux tube so that the total ionization is equal to the total flux to the
      plates. This then ensures no flux recirculation and simply uses the PIN
      data to distribute the ionization along the flux tube. Option 3 takes the
      PIN ionization data directly (it is not adjusted or normalized except to
      convert to MKS units) and allows over and under ionization to occur and
      thus allows for the possibility of flow reversal and its effects on the
      background plasma characteristics.</P>
    
    <P> </P>
    
    <H2><A NAME="nsolit">Number of Pin/SOL Iterations</A></H2>
    
    <P> This quantity specifies the number of <A HREF="#solite">iterations</A>
      that will be made in a DIVIMP SOL option -&gt; Pin -&gt; DIVIMP SOL option
      iteration sequence in an attempt to generate a convergent background
      solution with the aid of the hydrogenic neutral code.</P>
    
    <P> </P>
    
    <H2><A NAME="tcoord">Set of Target Coordinates</A></H2>
    
    <P> This table specifies target co-ordinates for each ring. The first line
      is a comment. The second contains a comment and the number of lines in the
      table. The rest of the lines contain the co-ordinates of the targets for
      each ring. For this data to be used, the target option must be set
      appropriately and the geometry option set to -1. The contents of each line
      in the table are:</P>
    
    <P>Ring number R,Z Outer target R,Z Inner target</P>
    
    <P>The R,Z values are specified in meters. There are then 5 numbers on each
      line of the table. Target points must be specified for each ring.</P>
    
    <P> </P>
    
    <H2><A NAME="wcoord">Set of Wall Coordinates</A></H2>
    
    <P> This table specifies the set of wall segments that will make up the
      wall. The first line is a comment, the second is a comment plus the number
      of lines in the table, the rest are the R,Z coordinates of the end-points
      of the wall segments, one end-point per line. The end-point of the first
      section is the corner point of the outer plate. The sections then number
      clockwise from that point to the outer corner point of the inner plate.
      The wall in the private plasma cannot (at this time) be independently
      specified. Furthermore, the targets are assumed to be part of the wall.
    </P>
    
    <P> </P>
    
    <H2><A NAME="twcoor">Set of Trap Wall or ITER second wall coordinates</A></H2>
    
    <P> This table specifies the points that will be used either for trap wall
      option 3 - where a neutral wall is specified in the trap region or for the
      second wall in an ITER double null geometry. The first line in the input
      is a comment, the second is a comment plus the number of lines in the
      table, the rest are the R,Z coordinates of the end-points of the wall
      segments, one end-point per line. These points are joined by line segments
      and connected to the inside corners of the targets to give a continuous
      wall surface for neutrals inside the trap region. </P>
    
    <P> </P>
    
    <H2><A NAME="maxgen">Maximum Number of Sputtered Generations</A></H2>
    
    <P> This parameter limits the number of iterations or generations for which
      a sputter fragment can exist. The purpose of this is to limit the CPU time
      for cases using recycling gases with high YMF values. Recycling gases and
      pumping rates are simulated through two mechanisms. First, they are
      defined to have a sputter yield of 1.0. This means that every particle
      striking the target would be relaunched. This runaway condition is limited
      by applying a yield modifier of, for example, 0.95, which gives an
      effective pumping rate at the targets of 5% of the incident recycling
      impurity flux. These particles will only be followed until their weight is
      less than the sputter threshold (usually 0.1) or their weight reaches
      (YMF)^n where n is the specified number of sputter generations. This is
      implemented by simply ceasing to follow the ion fragment after the
      specified number of target collisions. </P>
    
    <P> </P>
    
    <H2><A NAME="bgir">Ring number for Detailed Background Data</A></H2>
    
    <P> Some of the higher numbered SOL options may allow calculations of the
      background on a much finer grid than the bin system that is used for
      particle accounting. In order to save storage, these high resolution
      background values are not stored for every ring. This parameter specifies
      the one ring of interest for which these high resolution background data
      will be stored. This is useful for debugging purposes and for looking at
      transitional effects which are not visible on the scale of the larger bin
      system. (Not available for all SOL options) </P>
    
    <P> </P>
    
    <H2><A NAME="cospow">Power of Cosine release distribution (V/A flag 12,13)</A></H2>
    
    <P> This specifies the exponential power of the cosine distribution used to
      inject particles in <A HREF="#vaflag">V/A flag options</A> 12 and 13.</P>
    
    <P> </P>
    
    <H2><A NAME="vmult">Velocity Multiplier for Velocity/Angle Flag 14 and 15</A>
    </H2>
    
    <P> This number is used to multiply the velocity of all initial impurity
      neutral launches which use <A HREF="#vaflag">Velocity/Angle flags</A> 14
      or 15. It does not apply to the velocity assigned to any recombined
      impurity neutrals.</P>
    
    <P> </P>
    
    <H2><A NAME="vmultr">Velocity Multiplier for Recombined Ions</A></H2>
    
    <P> This quantity multiplies the velocity assigned to <A HREF="#folrec">recombined
        impurity neutrals</A>.</P>
    
    <P> </P>
    
    <H2><A NAME="sleak">Set of S-values for Ion Leakage Diagnostic</A></H2>
    
    <P> The first line specifies the number of entries. This is limited by the
      value of MAXPTS, set in the PARAMS common block. The rest of the data, one
      number per line, specifies the S-bin values at which the leakage
      information will be collected. When an ion exceeds the value of S along
      the field line that is listed in this table then the count for that
      distance will be incremented by the weight of the particle. The particle
      will not be counted more than once for any of the distances. The distances
      are specified in meters.</P>
    
    <P>e.g. </P>
    
    <P></P>

<pre>    
    ' ' 'Set of S-distances for ion leakage diagnostic (m)'
    'TN982 Number of S-values :-' 5
      1.0
      2.0
      3.5
      6.0
     13.35
</pre>    

    <P>The limitations on these values are that they be greater than zero and
      be recorded in ascending order.</P>
    
    <P> </P>
    
    <H2><A NAME="det">Detached Plasma Model Parameters</A></H2>
    
    <P> The following is based on a simple prescription specified in TN988 for
      a detached plasma. The parameters here specify various characteristics of
      this prescription which is implemented through SOL option 21 described
      above. The detached plasma prescription defines three regions where
      different behaviours, as defined by the following quantities are
      implemented. The detached plasma description has been further refined to
      allow the distances to be specified as either absolute lengths in meters
      along the grid or as a fraction of the total distance along the ring in
      either an S (along the field line) or P (poloidal) coordinate system. The
      option has also been further refined to allow different values for the
      OUTER and INNER SOL to be defined. </P>
    
    <P> </P>
    
    <H2><A NAME="detlsw">Detached Plasma - Length Scaling Switch</A></H2>
    
    <P> This option determines how the values entered for the distances L1, L2
      and Lv will be interpreted. </P>
    
    <P> <B>DP Length Scaling option 0</B>: Distance values are interpreted as
      a fraction of Smax.</P>
    
    <P> <B>DP Length Scaling option 1</B>: Distance values are interpreted as
      a fraction of Pmax.</P>
    
    <P> <B>DP Length Scaling option 2</B>: Distance values are interpreted as
      absolute distances along S.</P>
    
    <P> <B>DP Length Scaling option 3</B>: Distance values are interpreted as
      absolute distances along P.</P>
    
    <P> </P>
    
    <H2><A NAME="detter">Detached Plasma Te/Te0 Ratio</A></H2>
    
    <P> The Electron temperature at the upper boundary of region A is this
      quantity times the electron temperature at the target. The electron
      temperature ramps linearly between these two values in this region.
      Different values may be specified for inner and outer (JET=OUTER/INNER,
      Sonnet=INNER/OUTER).</P>
    
    <P> </P>
    
    <H2><A NAME="dettir">Detached Plasma Ti/Ti0 Ratio</A></H2>
    
    <P> The ion temperature at the upper boundary of region A is this quantity
      times the ion temperature at the target. The ion temperature ramps
      linearly between these two values in this region. Different values may be
      specified for inner and outer. (JET=OUTER/INNER, Sonnet=INNER/OUTER).</P>
    
    <P> </P>
    
    <H2><A NAME="detner">Detached Plasma Ne/Ne0 Ratio</A></H2>
    
    <P> The plasma density at the upper boundary of A is this ratio times the
      density at the target. The density ramps linearly from the value at the
      target to this value at the boundary. Different values may be specified
      for inner and outer (JET=OUTER/INNER, Sonnet=INNER/OUTER).</P>
    
    <P> </P>

    <H2><A NAME="r05">Detached Plasma N-exponent Factor</A></H2>
    
    <P> The plasma density in region A usually rises linearly from the value at 
      the target if this input is specified as 1.0. However, specifying a value
      other than 1.0 will result in profile of the form: N(s) = Nt + Nt (Nrat-1) (s/S1)^Alpha.
      Different values may be specified
      for inner and outer (JET=OUTER/INNER, Sonnet=INNER/OUTER).</P>
    
    <P> </P>
    
    <H2><A NAME="detqr">Detached Plasma Qrad/Q0 Ratio</A></H2>
    
    <P> This ratio defines the amount of power radiated in region B, as a
      function of the power flux onto the targets (Q0). Different values may be
      specified for inner and outer (JET=OUTER/INNER, Sonnet=INNER/OUTER).</P>
    
    <P> </P>
    
    <H2><A NAME="detl1r">Detached Plasma L1/SMAX Ratio</A></H2>
    
    <P> Upper bound of region A is this Ratio times SMAX. This is also the
      lower bound of region B. Different values may be specified for inner and
      outer. (JET=OUTER/INNER, Sonnet=INNER/OUTER).</P>
    
    <P> </P>
    
    <H2><A NAME="detl2r">Detached Plasma L2/SMAX Ratio</A></H2>
    
    <P> Upper bound of region B/ lower bound of C as defined above. Different
      values may be specified for inner and outer (JET=OUTER/INNER,
      Sonnet=INNER/OUTER).</P>
    
    <P> </P>
    
    <H2><A NAME="detlvr">Detached Plasma LV/SMAX Ratio</A></H2>
    
    <P> The background flow velocity ramps to 0.0 at this Ratio times SMAX from
      the value it has as calculated at the upper bound of region A. Different
      values may be specified for inner and outer (JET=OUTER/INNER,
      Sonnet=INNER/OUTER).</P>
    
    <P> </P>
    
    <H2><A NAME="detv1m">Detached Plasma V1 Velocity Multiplier</A></H2>
    
    <P> The background flow velocity in region A is usually controlled by conservation
    of flux and is described by equation (1). This option multiplies the velocity at position
    L1 by the given factor. It would usually be used if one supected that there was a loss of
    flux in region A due to cross-field drifts or other effects. The velocity in region A is then 
    calculated lineraly based on the value of V0 at the target and a value of V1 at position L1. </P>
    
    <P><IMG SRC="images/divref-121.gif" WIDTH=336 HEIGHT=55></P>
    
    <P> </P>

    <H2><A NAME="r11"><A NAME="r12">Detached Plasma - Ring by Ring Specifications</A></A></H2>

    <P> These inputs allow the parameters used for the detached plasma model to be specified
      independently on a ring by ring basis for both the inside and the outside. This is necessary
      at times because not all flux tubes are equally detached and it was found that changing the
      detached plasma parameters for each ring could result in better agreement with experimental 
      observations. Each line of the input specifies the ring, Te-ratio, Ti-ratio, N-ratio,
      Q-ratio, L1 and L2 fractions, the Lv value, and the velocity multiplier. The exponent of 
      the density equation can not be specified independently for each ring at this time. The 
      R11 input line specifies data for the INNER-JET (OUTER-SONNET) while the R12 input
      line defines the data for the OUTER-JET (INNER-SONNET) halves of the rings.</p>

<pre>
    '+R11  ' 'TN    DETACHED Plasma Specifications on a by ring basis'
    'TN    INNER - IR TER TIR NR QR L1R L2R LVR VBM - N= '    2
        10   1.0  2.0  1.0  0.1   0.2   0.25  1.0
        11   1.0  3.0  3.0  0.1   0.15  0.2   1.0
    '+R12 ' 'TN    DETACHED Plasma Specifications on a by ring basis'
    'TN    OUTER - IR TER TIR NR QR L1R L2R LVR VBM - N= '    3
        11   2.0  2.0  1.0  0.1   0.2   0.25  1.0
        12   1.0  3.0  3.0  0.1   0.15  0.2   1.0
        15   1.0  2.0  2.0  0.1   0.15  0.2   1.0
</pre>


    <H2><A NAME="absfac">ABSFAC or Power to Targets</A> </H2>
    
    <P> Normally this quantity will be calculated by the DIVIMP run. However,
      for purely ion injection cases it is not possible for DIVIMP to calculate
      an absolute calibration factor for the results. This quantity can be
      externally calculated or deduced for a given shot or other simulation and
      then entered into the code to check the absolute values of the results
      generated by DIVIMP against the experiment. This quantity may instead be
      interpreted as the Power onto the targets when SOL option 21 is used. This
      also yields an absolute calibration factor but has the additional effect
      of easing the definition of the region B power loss in terms of plate
      target power. The absolute factor would have values on the order of 10<SUP>19</SUP>
      for ABSFAC and 2.0 X 10<SUP>5</SUP> for the power onto the targets.</P>
    
    <P> </P>
    
    <H2><A NAME="sonnnr">Sonnet Grid Characteristic Specifications - Asdex U -
      CMOD - Textor - DIIID : Number of Rings</A></H2>
    
    <P> These quantities are now usually included at the beginning of a SONNET
      style grid file. If there are no numbers present in the grid file then
      the values specified here will be used. The values in the grid file
      will always take precedence over numbers specified in the input file. </p>
    
    <P>The following set of values specify the characteristics of grids created
      by the Sonnet mesh generator. This generator creates grids compatible with
      the B2/Eirene code combination. Thus the grid is initially stored in an
      indexed XY array that needs to be divided into three segments for DIVIMP.
      The core plasma, the trapped or private plasma and the SOL. This first
      parameter specifies the number of rings in the Sonnet geometry file. (This
      would typically be the number of rows in the Sonnet mesh- since the Sonnet
      mesh is indexed from 0 to n - the number entered here is n+1)</P>
    
    <P> </P>
    
    <H2><A NAME="sonnnk">Sonnet Grid: Number of Knots</A></H2>
    
    <P> This quantity specifies the number of knots along each ring. It is
      typically larger than the number of rings but there is no requirement that
      this be true. Again, since Sonnet numbers from 0 to m, the number entered
      here will be m+1.</P>
    
    <P> </P>
    
    <H2><A NAME="sncutr">Sonnet Grid: Cut ring number</A></H2>
    
    <P> This is the last ring composing the trapped and core plasma regions.
      (The last ring containing a B2 cut line.) Note: the terminology comes from
      B2 where the square geometry has two regions - the SOL is usually the
      upper half and the trapped plasma and core are the lower half. However
      there is no direct coupling between the trapped plasma and the core and so
      there are &quot;insulating&quot; lines (cut lines) inserted separating
      these regions on these rings. That is why they are termed &quot;cut rings&quot;.
      DIVIMP needs to split these rings into core and trapped plasma rings which
      DIVIMP deals with separately and so needs to know the ring number to stop
      this procedure at - again since Sonnet grids are numbered from 0 - this
      number is the cut ring index number +1.</P>
    
    <P> </P>
    
    <H2><A NAME="sncp1">Sonnet Grid: Cut point 1</A></H2>
    
    <P> This index specifies the last element belonging to the trapped plasma
      region on the cut rings. All the elements greater than this and less than
      cut point 2 belong on the core plasma rings. </P>
    
    <P> </P>
    
    <H2><A NAME="sncp2">Sonnet Grid: Cut point 2</A></H2>
    
    <P> This specifies the first point after the second cut belonging to the
      trapped plasma rings. (see above.)</P>
    
    <P> </P>
    
    <H2><A NAME="snnfla">Sonnet Grid: Number of Fluid results in background
      plasma file (NFLA)</A></H2>
    
    <P> This specifies the number of fluid solution that will be found in the
      B2/UEDGE background plasma solution that will be read by the case.
      Specifying this number enables the input file to be read correctly and
      will allow the code to load the impurity fluid results for comparison with
      the DIVIMP results.</P>
    
    <P> </P>
    
    <H2><A NAME="rdaux">Read Background Plasma Auxiliary Input File</A></H2>
    
    <P> This switch instructs DIVIMP to try to read in an auxiliary plasma
      input file. This file will typically contain additional information that
      is not included in the plasma file. For example, at this time, when this
      option is activated for a JET grid and EDGE2D background , DIVIMP will
      look for a file connected to unit #12 that contains the EDGE2D down flux
      information for the case. The expected name for this file is &quot;shots/&lt;gridfile&gt;.&lt;plasma
      descriptor&gt;.aux&quot;. For an UEDGE case, the auxiliary file is
      expected to contain a variety of information in a B2 plasma file format.
      This includes such items as the hydrogenic neutral density, the carbon
      neutral density and the 2-D carbon neutral production rate on the grid
      among other items.</P>
    
    <P> </P>
    
    <H2><A NAME="stgrad">STGrad : Gradient End-point Specifier</A></H2>
    
    <P> This quantity is used for some simple options to arbitrarily turn off
      the temperature gradient force or velocity diffusion for values of S &gt;
      stgrad * smax ... and yet still allow a temperature gradient for S &gt;
      stgrad * smax and temperature gradient forces for the region less than
      Stgrad * smax (from both targets). This option was used in testing some
      specific modelling conditions involving various collision options and
      force balance effects and is not recommended for regular use. </P>
    
    <P> </P>
    
    <H2><A NAME="sol22">SOL OPTION 22</A></H2>
    
    <P> </P>
    
    <P> SOL Option 22 is a multi-parameter OSM (Onion Skin Model) that uses a
      Runge-Kutta based solver to numerically evaluate the one-dimensional fluid
      equations. Starting from given target conditions and including a wide
      variety of effects, the option generates a complete background plasma
      solution for density, ion and electron temperature, parallel flow velocity
      and parallel electric field. The solutions represent what appears to be a
      reasonable approximation to the conditions found in the edge - and as such
      should be a useful research tool in examining the behaviour of impurities
      as well as the hydrogenic species behaviour in the reactor. It is
      especially useful for comparing predicted observables to actual
      experimental results. However, it is important to verify that the solution
      generated for a given set of target conditions does appear to be
      reasonable. The code can not definitively evaluate the legitimacy of a
      given background solution - this requires that the user look at the
      solution generated and evaluate it in the context of the physical
      situation being modelled. The following are the input parameters to SOL
      Option 22 in the order they are found in the input file. SOL option 22
      itself is selected by setting the SOL option input parameter to 22. </P>
    
    <P>There are three other options that are not a part of the SOL Option 22
      input block that affect the functioning of SOL Option 22. These are the
      Run PIN option, the Calculate SOL iteratively switch and the input item
      for the number of times to iterate the SOL calculation. These options are
      described in the documentation above and are not repeated here.</P>
    
    <P> <FONT SIZE="4">List of Parameter Values for SOL option 22</FONT>:</P>
    
    <P> </P>
    
    <H3><A NAME="force">Forcing Te=Ti </A></H3>
    
    <P> <B>Option 0</B>: 0=Off - Te and Ti are calculated separately applying
      the source terms that are appropriate for each species in the independent
      heat transport equations. </P>
    
    <P> <B>Option 1</B>: 1=On - Te and Ti are forced to be equal each other at
      all points - source terms for the two are combined into one heat transport
      equation.</P>
    
    <P> </P>
    
    <H3><A NAME="mach0">Initially Imposed Target Mach Number</A> </H3>
    
    <P> This is the value of the flow velocity initially imposed at the target
      as a multiple of the target sound speed. (A value of 1.0 is usually used
      initially for the target mach number). If the iterative mach solver option
      is turned on - then the value of the mach number at the target may move
      from this initial value as the solver searches for a smooth solution at
      the point of the super-sonic to sub-sonic transition. </P>
    
    <P> </P>
    
    <H3><A NAME="dmach">Initial Mach Number Step Size</A></H3>
    
    <P> When the iterative Mach solver is turned ON the values of the Mach
      number are initially stepped by this amount as the solver conducts its
      search. (Typically this value is set to 0.1 - so that mach number solver
      initially proceeds in increments of 0.1 - trying to bracket the critical
      target mach number.)</P>
    
    <P> </P>
    
    <H3><A NAME="mchres">Ultimate Mach Number Resolution</A></H3>
    
    <P> The solver resolves the Mach number to this level of &quot;accuracy&quot;.
      (Usually 0.00001 is used) . Due to instabilities encountered in the
      equations, the solution is found to bifurcate at the value of the critical
      mach number - even for exceptionally small changes in the Mach number of
      10<SUP>-10</SUP> or less. As such, it has proven difficult to actually
      find a solution that smoothly traverses the transition region when
      examined on a small scale length. Usually, the solutions containing sonic
      transitions are adequate given the granularity of the grid on which the
      simulation is taking place. </P>
    
    <P> </P>
    
    <H3><A NAME="izl">Ionization Source Length Switch</A></H3>
    
    <P> This option controls the interpretation of the length entries of the
      ionization source characteristics that are entered below.</P>
    
    <P> <B>Option 0</B>: Source lengths are interpreted to be in absolute
      units (meters)</P>
    
    <P> <B>Option 1</B>: Source lengths are expressed in relative units as a
      proportion of SMAX for each individual ring.</P>
    
    <P> </P>
    
    <H3><A NAME="izbeg">Start of Ionization Source</A></H3>
    
    <P> The interpretation of this number depends on the analytic ionization
      option selected. This number is interpreted as the starting S position
      (relative or absolute) of the ionization source. In the case of the
      triangular or rectangular ionization sources there will be no ionization
      for S less than the value listed here.</P>
    
    <P> </P>
    
    <H3><A NAME="izend">End or Length of Ionization Source</A></H3>
    
    <P> This specifies the end of the ionization source or effectively its
      length if the ionization source starts at 0.0. All of the source lengths
      are limited to a maximum of 1/2 of the field line. This is because the
      solver operates from each target out to the point mid-way from both
      targets along the field line and would ignore any source contributions
      outside this range. </P>
    
    <P> </P>
    
    <H3><A NAME="izfact">Decay Factor or Width of Ionization Source</A></H3>
    
    <P> This is the characteristic decay length or the width factor of the
      ionization source depending on which ionization source option has been
      selected. In particular, this value is used for the decay length of the
      default Exponential Decay Ionization Source.</P>
    
    <P> </P>
    
    <H3><A NAME="radl">Length of the Radiation Source</A></H3>
    
    <P> Length of radiating source region in meters.</P>
    
    <P> </P>
    
    <H3><A NAME="radlam">Decay Length of Radiation Source</A></H3>
    
    <P> Characteristic decay length for the exponential decay radiation source
      - Prad Option 1.</P>
    
    <P> </P>
    
    <H3><A NAME="radfrr">Source Strength Fraction (Frr)</A></H3>
    
    <P> </P>
    
    <P> This specifies the total power radiated by the radiation source term in
      terms of the power flux onto the target. A value of 3.0 means that the
      integrated strength of radiated losses will total 3 times the total target
      power flux for the specific ring.</P>
    
    <P> </P>
    
    <H3><A NAME="garcha">Garching Radiation Model: Parameter Alpha</A></H3>
    
    <P> The Garching model for impurity radiation uses the following formula.
      The quantities Alpha, the base temperature and the two exponents are read
      from the input data file using these lines. The actual option is selected
      through the Radiative Source Switch (Prad Option 2) which is found below.</P>
    
    <P> <IMG SRC="images/divref-49.gif" WIDTH="353" HEIGHT="38"></P>
    
    <P> <IMG SRC="images/divref-50.gif" WIDTH="231" HEIGHT="63"></P>
    
    <P> <IMG SRC="images/divref-51.gif" WIDTH="220" HEIGHT="60"></P>
    
    <P> </P>
    
    <H3><A NAME="garcht">Garching Radiation Model: Temperature Base</A></H3>
    
    <P> This is the base temperature in the above radiation formula. It is
      typically 15 eV.</P>
    
    <P> </P>
    
    <H3><A NAME="garch1">Garching Radiation Model: First Exponent</A></H3>
    
    <P> This is the first exponent in the above radiation formula. It is
      typically 1.5.</P>
    
    <P> </P>
    
    <H3><A NAME="garch2">Garching Radiation Model: Second Exponent</A></H3>
    
    <P> This is the second exponent in the above radiation formula. It is
      typically -3.</P>
    
    <P> </P>
    
    <H3><A NAME="gcori">Correction factor to Gamma (ion)</A></H3>
    
    <P> Ion sheath heat transmission coefficient correction factor. This factor
      adjusts the total ion heat flux onto the targets by adjusting the Gamma
      factor for the ion heat sheath transmission. It is usually set to zero.</P>
    
    <P> The formula used to calculate Ion heat flux is (where M is the target
      Mach number):</P>
    
    <P> <IMG SRC="images/divref-52.gif" WIDTH="178" HEIGHT="31"></P>
    
    <P> <IMG SRC="images/divref-53.gif" WIDTH="308" HEIGHT="60"></P>
    
    <P> </P>
    
    <H3><A NAME="gcore">Correction factor to Gamma (electron)</A></H3>
    
    <P> Electron sheath heat transmission coefficient correction factor. This
      factor adjusts the total electron heat flux onto the targets by adjusting
      the Gamma factor for the electron heat sheath transmission.</P>
    
    <P> <IMG SRC="images/divref-54.gif" WIDTH="185" HEIGHT="31"></P>
    
    <P> <IMG SRC="images/divref-55.gif" WIDTH="171" HEIGHT="31"></P>
    
    <P> </P>
    
    <H3><A NAME="cxpowc">CX Power Coefficient</A></H3>
    
    <P> </P>
    
    <P> Ion charge exchange is one of the power loss mechanisms that play a
      role in the ion heat equation. Roughly 3/2 kT is removed for each charge
      exchange event. This coefficient can be used to increase or decrease the
      number of charge exchange events occurring and thus adjust the
      significance of the associated terms. This factor is used in most of the
      Pcx Options. This is usually set to 1.0.</P>
    
    <P> </P>
    
    <H3><A NAME="recsrc">Recycling Source Coefficient</A></H3>
    
    <P> The recycling source coefficient should be set to 1.0 in most cases. It
      represents the proportion of target flux that is being recycled into the
      ionization source. This feature is particularly useful and necessary when
      dealing with PIN or EDGE2D ionization results where the recycling fraction
      was intentionally reduced to obtain a &quot;flow&quot; from the core.
      Effectively assuming that a certain proportion of the total ion source is
      effectively entering the system through the core and not through the
      ionization of particles recycling at the targets. This factor is used to
      multiply the ionization sources obtained from either PIN or EDGE2D and
      thus is a factor in determining the amount of cross-field flow required to
      equalize the sources and sinks on the field line. This cross-field flow
      can be added as a source through the use of the various Gperp options.
    </P>
    
    <P> </P>
    
    <H3><A NAME="peicor">Pei (Equipartition) Correction Factor</A></H3>
    
    <P> This factor multiplies the Pei power transfer term in the Te and Ti
      heat equations, thus allowing some flexibility in the strength of
      equipartition. (Pei may be turned on and off completely through the use of
      the Pei Option Switch described below.) The value SHOULD always be set to
      1.0 unless there is a good reason for changing it or the objective is to
      match results from other sources which may have used an alternative form
      of equipartition.</P>
    
    <P> </P>
    
    <H3><A NAME="velerr">Velocity Error Switch</A></H3>
    
    <P> This switch affects the default action of the R-K solver when it
      calculates conditions that result in an imaginary quantity for the
      density. This condition likely arises in the system of equations because
      not all of the physical effects are necessarily included. Furthermore, the
      models of the included physical processes, although as good as possible,
      are approximations in many cases. Thus, over small scale lengths or in
      regions near or beyond a super-sonic/sub-sonic flow transition region the
      relationship between pressure, flux, Te and Ti can result in no solution
      for the density. This is unphysical since it is believed that the density
      is a smoothly varying physical quantity. However, the product of the
      density and the velocity, ( = nv (flux), is a well-defined quantity at all
      points. When the equations yield an imaginary n, the solver assigns a
      value of v, either equal to the local sound speed or equal to the last
      value of v that was correctly calculated and from this value for the
      velocity and the known parallel particle flux, calculates a local value of
      n. These methods seem to produce reasonable solutions of n and v for the
      cases that have been examined.</P>
    
    <P> <B>Velocity Error Switch Option 0 </B>: Cs</P>
    
    <P> <B>Velocity Error Switch Option 1</B> : Const</P>
    
    <P> <B>Velocity Error Switch Option 2</B> : Pressure Adjustment -
      additional pressure required carried forward.</P>
    
    <P> <B>Velocity Error Switch Option 3</B> : Pressure Adjustment -
      additional pressure required is not carried forward.</P>
    
    <P> </P>
    
    <P> </P>
    
    <H3><A NAME="powbeg">Distributed Power Start Position </A></H3>
    
    <P> This parameter is used with power distribution options 7, 8 and 9. It
      specifies the starting position, as a function of SMAX for the ring, of
      the region where the power being carried by the electrons and ions should
      start reducing. This can be used for distributing the target power flux
      and any volume power terms if present. The simplest assumption in SOL 22
      occurs when there are no heat sources or sinks along the ring and the
      power reaching the target is carried by the electrons and ions all the way
      from the mid-point (&quot;top&quot;). This is an adequate first order
      assumption - but in fact the power carried to the target or being radiated
      along the length of the ring would have likely entered the ring with some
      spatial distribution and not at the top. The power distribution options
      address the question of distributing this power loading. </P>
    
    <P> </P>
    
    <H3><A NAME="powend">Distributed Power End Position</A> </H3>
    
    <P> This specifies the position (times SMAX for the ring) at which all the
      power has been input. (See previous entry and notes on power distribution
      options.)</P>
    
    <P> </P>
    
    <H3><A NAME="cgpfr">Compound Gperp - Fraction of Gperp in Rectangular
      Distribution</A></H3>
    
    <P> Gperp is the amount of additional cross-field source or sink that is
      necessary to force particle conservation on an individual flux-tube. This
      additional source or sink can be distributed in a variety of ways -
      determined by the Gperp option described below. This parameter specifies
      the fraction of the required amount that will be added in a rectangular
      distribution in a region defined by the following two parameters. The
      remainder is added uniformly over the length of the flux tube. This
      parameter is used with Gperp options 5 and 6.</P>
    
    <P> </P>
    
    <H3><A NAME="cgpbeg">Compound Gperp - Start of Region</A></H3>
    
    <P> For Gperp options involving a specified region for adding the
      perpendicular flux - this option defines the start of this region. The
      starting point is calculated by multiplying this factor times the value of
      SMAX for the ring.</P>
    
    <P> </P>
    
    <H3><A NAME="cgpend">Compound Gperp - End of Region</A> </H3>
    
    <P> For Gperp options involving a specified region for adding the
      perpendicular flux - this option defines the end point of this region. The
      ending point is calculated by multiplying this factor times the value of
      SMAX for the ring. </P>
    
    <P> </P>
    

    <H3><A NAME="227">227    Gextra Source strength - Target flux multiplier</A> </H3>

    <P> If the <a href="#274">"extra" source/sink switch</a> is turned on then an 
      additional source is added to the ring over a specified region and a 
      sink of exactly equal magnitude is removed over a second specified region.
      This artificial addition of a source and sink does not affect the global particle 
      balance on a ring but will significantly affect the flow pattern. </p>

    <p> This first parameter specifies the magnitude of the source/sink to be applied to 
      the ring. The magnitude is expressed as a fraction of the total target outflux for
      the entire flux tube. Both source and sink will exactly equal the particle influx
      specified by this parameter resulting in a net influx/outflux of zero. This
      option is designed to redistribute the influx/outflux on the flux tube in order
      to replicate experimentally observed flows at the mid-plane. </p>

    <p></p>


    <H3><A NAME="228">228    Gextra Source Start/Stop * SMAX </A> </H3>

    <p> This entry consists of two numbers in the range [0.0,1.0]. These are then 
      multiplied by the Smax distance for the ring to obtain the region over
      which the additional source is uniformly added. </p>

    <p></p>


    <H3><A NAME="229">229    Gextra Sink   Start/Stop * SMAX </A></H3>

    <p> This entry consists of two numbers in the range [0.0,1.0]. These are then 
      multiplied by the Smax distance for the ring to obtain the region over
      which the additional sink is uniformly removed. </p>

    <p></p>

    <H3><A NAME="230">230    PP target power loss redistribution range *SMAX </A></H3>

    <p> If the <a href="#264> private plasma target loss redistribution options</a>
      are turned on then 
      this parameter specifies the fraction of the length of the flux tubes in the
      main SOL over which the power is removed. The idea behind this option is that 
      the power fluxes to the private plasma target are fed from the rings in the main
      SOL close to the separatrix. As a result, the power lost to the private plasma
      target must be removed from the main SOL flux tubes. This represents only a 
      first order approximation.</p>

    <p></p>   

    <H3><A NAME="e2dik">Start Knot Index for EDGE2D Compatibility Option</A></H3>
    
    <P> This parameter specifies the starting knot number for EDGE2D
      compatibility option 9. SOL option 22 will start solving at this knot
      using the fluxes and background plasma conditions taken from EGE2D at this
      point. The following option describes what is done with the cells between
      the target and the starting point of the solver. </P>
    
    <P> </P>
    
    <H3><A NAME="e2dfil">Fill Option for Skipped Cells in EDGE2D Compatibility
      Option 9</A></H3>
    
    <P> This option specifies how the plasma background is calculated for the
      cells between the target and the starting point of the SOL 22 solver when
      compatibility option 9 is invoked. </P>
    
    <P><B>Fill Option 0</B>: Linear interpolation from the target conditions
      extracted from EDGE2D to the solver solution at the knot where the solver
      starts. </P>
    
    <P><B>Fill Option 1</B>: Extrapolation. The cell values and target
      conditions are linearly extrapolated back to the target from the values
      found by the solver in the first two cells for which it has a solution. If
      this extrapolation would yield negative target temperatures then the
      values are held constant from the start cell to the target at the values
      for the solver start cell. </P>
    
    <P><B>Fill Option 2</B>: Constant at solver start cell values. The cells
      from the target to the start cell are held constant at the start cell
      values. The target conditions themselves are extracted from the EDGE2D
      solution and are not changed. </P>
    
    <P><B>Fill Option 3</B>: Constant at EDGE2D target values. The cells from
      the target to the start cell are held constant at the EDGE2D target
      values. </P>
    
    <P> </P>
    
    <H3><A NAME="qecut">Qe Term - Temperature Cutoff (eV)</A></H3>
    
    <P> It has been found that some of the power terms calculated by various
      sources may be erroneous or very destabilizing for the solver at very low
      temperatures. As a result this cutoff temperature was introduced such that
      for any cell with a Te &lt; Qe Term Tcutoff - the contributions from PINQE
      would be set to zero. </P>
    
    <P> </P>
    
    <H3><A NAME="qidaic">PINQID - Atomic Ionization - T cutoff (eV)</A></H3>
    
    <P> It has been found that some of the power terms calculated by various
      sources may be erroneous or very destabilizing for the solver at very low
      temperatures. As a result this cutoff temperature was introduced such that
      for any cell with a Ti &lt; PINQID atomic Tcutoff - the contributions
      calculated for the atomic ionization portion of PINQID would be set to
      zero. </P>
    
    <P> </P>
    
    <H3><A NAME="qidmic">PINQID - Molecular Ionization - T cutoff (eV)</A></H3>
    
    <P> It has been found that some of the power terms calculated by various
      sources may be erroneous or very destabilizing for the solver at very low
      temperatures. As a result this cutoff temperature was introduced such that
      for any cell with a Ti &lt; PINQID molecular Tcutoff - the contributions
      calculated for the molecular ionization portion of PINQID would be set to
      zero. </P>
    
    <P> </P>
    
    <H3><A NAME="qidrc">PINQID - Recombination - T cutoff (eV)</A></H3>
    
    <P> It has been found that some of the power terms calculated by various
      sources may be erroneous or very destabilizing for the solver at very low
      temperatures. As a result this cutoff temperature was introduced such that
      for any cell with a Ti &lt; PINQID recombination Tcutoff - the
      contributions calculated for the recombination portion of PINQID would be
      set to zero. </P>
    
    <P> </P>
    
    <H3><A NAME="qidcxc">Qi Term / PINQID - Charge Exchange - T cutoff (eV)</A></H3>
    
    <P> It has been found that some of the power terms calculated by various
      sources may be erroneous or very destabilizing for the solver at very low
      temperatures. As a result this cutoff temperature was introduced such that
      for any cell with a Ti &lt; PINQID charge exchange Tcutoff - the
      contributions calculated for the charge exchange portion of PINQID would
      be set to zero. </P>
    
    <P>This cutoff term is also used for the PINQI quantity read in from
      NIMBUS. For Ti &lt; Qi Term Tcutoff - the contributions from PINQI would
      be set to zero.</P>
    
    <P> </P>
    
    <H3><A NAME="qidtrf">PINQID - Charge Exchange Option 1 - Reference
      Temperature (eV)</A></H3>
    
    <P> PINQID charge exchange option 1, described in the section on SOL 22
      switches, requires a reference temperature in order to calculate the power
      loss through the ion charge exchange channel. </P>
    
    <P> </P>
    
    <H3><A NAME="mint">Minimum Temperature Allowed in Solver (SOL 22)</A></H3>
    
    <P> This is the minimum temperature allowed in the solver. If temperatures
      lower than the value entered here are encountered within the solver they
      are set equal to this value. Usually this is set to zero. However, in some
      extreme cases, usually when modelling detachment, recombination and charge
      exchange processes can result in cases where power and particle balances
      will result in a falling ion temperature - to such an extent that the
      temperature would be negative unless this is prevented. </P>
    
    <P> </P>
    
    <H3><A NAME="maxdt">Maximum Allowed Temperature Drop Fraction</A></H3>
    
    <P> This quantity specifies the maximum fractional temperature drop that is
      allowed on a ring. If the temperature drops to less than this fraction of
      it's maximum value then the solver generates an error condition and exits
      for this flux tube. At this point the error correcting code can adjust the
      solution options for this flux tube and re-run for this ring. This
      requires that the error correction option be activated. The solver records
      the maximum temperature reached along the ring and checks to see that the
      calculated temperature does not fall below this fraction of that value.
      Specifying a value of 0.0 will turn off this option. Specifying a value of
      1.0 is the same as requiring only solutions with constantly increasing or
      at least constant temperatures along the field line. </P>
    
    <P> </P>

    <H3><A NAME="ml-mult">Momentum Loss Term Multiplier</A></H3>
    
    <P> This is an arbitrary variable factor used to scale the momentum
      loss term if desired. It can be used to enhance or decrease the effect of 
      calculated momentum loss terms for the purposes of exploring the effect, comparing
      with other codes utilizing a somewhat different model or to proportionally
      allow for other physical effects that are not a part of the current model.
      It should usually be set to 1.0.
      See the descriptions of Momentum Loss formulae in the DIVIMP guide
      and for the Momentum loss options below. </P>
    
    <P> </P>
   
    <H3><A NAME="ml-ff">Friction Factor for Momentum Loss</A></H3>
    
    <P> This is a variable factor used in the simplified formulae for momentum
      loss. See the descriptions of Momentum Loss formulae in the DIVIMP guide
      and for the Momentum loss options below. </P>
    
    <P> </P>
    
    <H3><A NAME="ml-len">Length of Momentum Loss region</A> </H3>
    
    <P> Length of momentum loss region for the simpler analytic momentum loss
      options. (0.25 is a typical value - distributing the momentum loss over
      the first quarter of the ring.)</P>
    
    <P> </P>
    
    <H3><A NAME="ml-lam">Decay Length of Momentum Loss</A></H3>
    
    <P> The decay length is used as the scale length or exponential
      characteristic length in some of the analytic momentum source options. See
      the descriptions of Momentum Loss formulae in the DIVIMP guide and the
      descriptions of the Momentum Loss Option switch in the section below.</P>
    
    <P> </P>
    
    <H3><A NAME="ml-cxr">Correction ratio of CX to Ionization events for
      Momentum transfer</A></H3>
    
    <P> This is an extra correction multiplier for the number of CX momentum
      events (and thus pressure loss) to ionization events for those momentum
      sources that depend on the ionization source. It is typically set to 1.0
      unless one wants to increase the effectiveness of the momentum loss term.</P>
    
    <P> </P>
    
    <H3><A NAME="ml-cxc">Te Cut-off for increased CX multiplier</A></H3>
    
    <P> At low Te the ratio of CX events to ionization events increases at a
      great rate - dependent on the local electron temperature. In order to
      replicate this and thus approximately estimate the momentum loss terms -
      it is necessary to increase the number of momentum transfer events
      occurring / ionization. The following formula is used to give the ratio of
      momentum loss to ionization rates.</P>
    
    <P> <IMG SRC="images/divref-56.gif" WIDTH="150" HEIGHT="31"></P>
    
    <P> <IMG SRC="images/divref-57.gif" WIDTH="128" HEIGHT="28"></P>
    
    <P> <IMG SRC="images/divref-58.gif" WIDTH="116" HEIGHT="55"></P>
    
    <P> <IMG SRC="images/divref-59.gif" WIDTH="555" HEIGHT="28"></P>
    
    <P> For temperatures above the Tcut value specified in this entry - the
      multiplier is equal to 1.0. Below this temperature - the multiplier
      increases rapidly. However, behaviour at very low temperatures is not well
      understood. So the following entry cuts off the multiplication factor for
      temperatures lower than the given cut-off.</P>
    
    <P> </P>
    
    <H3><A NAME="ml-cxt">Te Lower Limit Cutoff for CX Multiplier</A></H3>
    
    <P> The CX multiplier described in the previous entry returns a value of
      1.0 for temperatures below this cut-off value. </P>
    
    <P> </P>

    <H3><A NAME="qemult">PIN Qe Term Multiplier</A></H3>
    
    <P> This is a factor to allow for scaling of the electron energy loss term that 
    is returned by the hydrogenic neutral code. It should usually be set to 1.0.</P>
    
    <P> </P>
 
    <H3><A NAME="249">249    PRAD option 3 multiplier (x PINQE) </a></H3>

    <p> This option applies to <a href="#swprad"> PRAD option 3</a>. Prad option 
      3 defines the radiative loss term to be a multiple of the PINQE (electron
      energy loss term that is calculated by PIN. This parameter specifies the 
      value of the multiplier. </P>

    <p></p>
    
    <H3><A NAME="rkstep">Initial Number of Runge-Kutta Steps Between Grid
      Points</A></H3>
    
    <P> This is the initial number of Runge-Kutta steps that the solver assumes
      between each consecutive grid point where a solution is necessary. The
      solver will increase or decrease the actual step-sizes taken depending on
      errors encountered and the solver's estimate of the error on any given
      step. The usual value entered here is 100.</P>
    
    <P> </P>
    
    <H2><A NAME="sol22sw">SOL Option 22 - Switches</A></H2>
    
    <P> The general options to the solver are invoked by a series of switches
      that can each take a number of values for each option. The following
      section describes the switches, their functions and the various acceptable
      input values. </P>
    
    <P> </P>
    
    <H3><A NAME="swion">Ionization Option</A> </H3>
    
    <P> There are, at present, eleven different ionization options that can be
      chosen. This number changes so if the code version is newer than this
      documentation then you might want to examine the code and the ECHOSOL
      subroutine for additional information. </P>
    
    <P> <B>Option 0.0</B>: Exponential Decay The ionization source is modelled
      as an exponential decay falling away from the target. This is the simplest
      and usually the default option. Lengths of the source region and the
      characteristic decay are as specified above in the ionization parameter
      section. </P>
    
    <P> <A HREF="#izfact"><IMG SRC="images/divref-118.gif" WIDTH="146" HEIGHT="33"></A></P>
    
    <P> Where S<SUB>0</SUB> is the normalization factor - usually set so that
      the integral of the ionization source along the ring will equal the flux
      to the targets. </P>
    
    <P><B>Option 1.0</B>: PIN data Normalized PIN data is read in and
      normalized to the target flux for each end of the flux tube individually.</P>
    
    <P><B>Option 2.0</B>: PIN data Unnormalized PIN data is read in and used
      as is - there is a global normalization check performed to make sure that
      the integral of ionization over the entire grid is equal to the particle
      sources (usually target flux and recombination).</P>
    
    <P><B>Option 3.0</B>: Triangular Source The ionization is distributed in a
      triangular shape between the <A HREF="#izbeg">Start position</A> of the
      ionization Source to the <A HREF="#izend">End position</A> (specified as
      parameters above). The integral over the triangle is normalized to the
      target flux for each end of the flux tube. </P>
    
    <P><B>Option 4.0</B>: Rectangular Source The ionization is a rectangular
      shape from the <A HREF="#izbeg">Start of the ionization source</A> to the
      <A HREF="#izend">End of the ionization source</A> region. (Start and End
      are parameters specified above). The strength of the ionization is
      constant over the region. The integral of the source is normalized to the
      target flux for each end of the flux tube.</P>
    
    <P><B>Option 5.0</B>: Algorithmic Source 1 This option chooses between the
      Triangular and Rectangular sources and their characteristics applied to
      these sources based on the target conditions for the half-ring. </P>
    
    <P> The algorithm used is the following:</P>
    
    <P> If n<SUB>target</SUB> &gt; 1.0e19 then a Triangular Source (option 3
      is used).</P>
    
    <P> If Te &lt; 1.3 eV </P>
    
    <P> Start of Triangular Source = 13 - 10 X Te</P>
    
    <P> End of Triangular Source = Start + 2.0</P>
    
    <P> If Te >= 1.3 eV</P>
    
    <P> Start of Triangular Source = 0.0</P>
    
    <P> End of Triangular Source = 2.0 meters</P>
    
    <P> If n<SUB>target</SUB> <= 1.0e19 then a Rectangular Source (option 4 is
      used).</P>
    
    <P> If Te &lt; 10 eV </P>
    
    <P> Start of Rectangular Source = 0.0</P>
    
    <P> End of Rectangular Source = 13.0 - Te</P>
    
    <P> If Te >= 10 eV</P>
    
    <P> Start of Rectangular Source = 0.0</P>
    
    <P> End of Rectangular Source = 2.0 meters</P>
    
    <P><B>Option 6.0</B>: s<SUP>5</SUP> Gaussian This option selects a source
      of the form s<SUP>5</SUP> exp(-s<SUP>2</SUP>) (i.e. s<SUP>5</SUP> times
      a Gaussian distribution). This may be a good analytic source for low
      temperature cases where the ionization is somewhat removed from the
      target. However, the almost complete lack of ionization immediately
      adjacent to the target can cause problems with the solver. The solver
      often needs to use a very small step-size in these regions and may run
      into conditions resulting in imaginary solutions. Either of these can
      significantly increase the computational time required by SOL 22 to
      provide a background plasma solution. The &quot;Decay Length of Ionization
      Source&quot; specified above is used as the width or decay factor for this
      distribution - it approximately specifies the location of the peak of this
      distribution. The source starts at S=0 and is cutoff at the End of
      ionization source specified in the parameter section. The total integrated
      source strength for each half ring is normalized to the target flux for
      each end of the flux tube. This form of a Gaussian was chosen for the
      source because of it's reasonable spatial distribution and because it is
      analytically integrable. </P>
    
    <P> where <IMG SRC="images/divref-61.gif" WIDTH="231" HEIGHT="35"></P>
    
    <P> <IMG SRC="images/divref-62.gif" WIDTH="66" HEIGHT="55"></P>
    
    <P><B>Option 7.0</B>: Algorithmic Source 2 This option chooses between the
      s<SUP>5 </SUP>Gaussian and Rectangular type sources based on target
      conditions. It is otherwise similar to option 5.0.</P>
    
    <P> The algorithm used is the following:</P>
    
    <P> If n<SUB>target</SUB> &gt; 1.0e19 then an s<SUP>5</SUP>Gaussian
      Source (option 6 is used).</P>
    
    <P> If Te &lt; 1.3 eV </P>
    
    <P> Start of s<SUP>5</SUP>Gaussian Source = 0.0</P>
    
    <P> End of s<SUP>5</SUP>Gaussian Source = End of 1/2 ring</P>
    
    <P> Width Factor = 14.0 - 10 ( Te </P>
    
    <P> If Te >= 1.3 eV</P>
    
    <P> Start of s<SUP>5</SUP>Gaussian Source = 0.0</P>
    
    <P> End of s<SUP>5</SUP>Gaussian Source = End of 1/2 ring</P>
    
    <P> Width Factor = 1.0</P>
    
    <P> If n<SUB>target</SUB> <= 1.0e19 then a Rectangular Source (option 4 is
      used).</P>
    
    <P> If Te &lt; 10 eV </P>
    
    <P> Start of Rectangular Source = 0.0</P>
    
    <P> End of Rectangular Source = 13.0 - Te</P>
    
    <P> If Te >= 10 eV</P>
    
    <P> Start of Rectangular Source = 0.0</P>
    
    <P> End of Rectangular Source = 2.0 meters</P>
    
    <P><B>Option 8.0</B>: PIN Source Strength This option runs PIN to obtain
      the total ionization on each field-line, affected only by global
      normalization. It then applies the ionization option specified in the
      initial ionization option on each subsequent iteration except that instead
      of the ionization source being normalized to the target flux, it is
      normalized to the amount of ionization on the 1/2 flux tube as determined
      from PIN.</P>
    
    <P><B>Option 9.0</B>: Offset s<SUP>5</SUP>Gaussian This ionization option
      is almost the same as option 6.0 except that the width factor for the
      distribution is also simultaneously used as a zero offset. The form of the
      ionization source is the following. The source is normalized (by setting
      the factor A) so that the integral over the source is equal to the target
      flux for the 1/2 ring. </P>
    
    <P> <IMG SRC="images/divref-63.gif" WIDTH="243" HEIGHT="38"> </P>
    
    <P> <IMG SRC="images/divref-64.gif" WIDTH="66" HEIGHT="55"></P>
    
    <P> and </P>
    
    <P> <IMG SRC="images/divref-65.gif" WIDTH="53" HEIGHT="51"> </P>
    
    <P> </P>
    
    <P><B>Option 10.0</B>: Algorithmic Source 3 This option chooses between
      the Offset s<SUP>5</SUP>Gaussian source and the Rectangular source based
      on target conditions. </P>
    
    <P> The algorithm used is the following:</P>
    
    <P> If n<SUB>target</SUB> &gt; 1.0e19 then Offset s<SUP>5</SUP>Gaussian
      (option 9 is used).</P>
    
    <P> If Te &lt; 1.3 eV </P>
    
    <P> Start of s<SUP>5</SUP>Gaussian Source = 0.0</P>
    
    <P> End of s<SUP>5</SUP>Gaussian Source = End of 1/2 ring</P>
    
    <P> Width Factor = 28.0 - 20 ( Te </P>
    
    <P> If Te >= 1.3 eV</P>
    
    <P> Start of s<SUP>5</SUP>Gaussian Source = 0.0</P>
    
    <P> End of s<SUP>5</SUP>Gaussian Source = End of 1/2 ring</P>
    
    <P> Width Factor = 2.0</P>
    
    <P> If n<SUB>target</SUB> <= 1.0e19 then a Rectangular Source (option 4 is
      used).</P>
    
    <P> If Te &lt; 10 eV </P>
    
    <P> Start of Rectangular Source = 0.0</P>
    
    <P> End of Rectangular Source = 13.0 - Te</P>
    
    <P> If Te >= 10 eV</P>
    
    <P> Start of Rectangular Source = 0.0</P>
    
    <P> End of Rectangular Source = 2.0 meters</P>
    
    <P></P>
    
    <H3><A NAME="swioni">Initial Ionization Option:</A></H3>
    
    <P>This ionization option is used to generate the seed plasma solution (&quot;Starter
      Plasma&quot;) for PIN iteration. Since PIN needs a plasma solution before
      it can determine the hydrogenic ionization and power loss terms, which
      will be used as the OSM iterates to calculate better estimates of the
      background plasma, it is necessary to start with an analytically
      calculated plasma. This option specifies the ionization source to be used
      when the ionization option is set to 1.0, 2.0 or 8.0.</P>
    
    <P><B>Options:</B> Match Previous These are identical to the options
      above. Options 1, 2 and 8 are invalid as the initial ionization option.</P>
    
    <P>In addition, the following ionization source options are available on
      the initial iteration. </P>
    
    
    <P><B>Option 11</B>: Edge2D Ionization Source This option is only useful
      when trying to directly compare OSM model solutions to Edge2D background
      plasma solutions. This option requires that the Edge2D data be read into
      DIVIMP so that the ionization source, as it was used by Edge2D in it's
      calculations, is then available within DIVIMP for use by SOL option 22.
      This can reduce or eliminate differences in the solutions caused by
      differences in the source terms.</P>

    <P><B>Option 12</B> : PIN is run once with EDGE2D background in the SOL
      before SOL 22 is invoked. This generates power terms but does not include
      puffing.</P>
    
    <P><B>Option 13</B>: PIN is run twice with an EDGE2D background in the SOL
      before SOL22 is invoked. This generates power terms and a more correct
      puffing approximation.</P>
    
    <P><B>Option 14</B>: PIN is run twice with an EDGE2D background everywhere
      (SOL+CORE) before SOL 22 is invoked. This option must be used in
      conjunction with core option -1 or else the EDGE2D solution in the core
      will be overwritten.</P>
    
    <P><B>Option 15</B>: Ionization source data is read from the EDGE2D input
      for the case. The EDGE2D plasma solution is assigned as the &quot;previous&quot;
      solution so that cross-field gradient dependent perpendicular flux and
      power terms may be assigned correctly. </P>
    
    <P><B>Option 16</B> : PIN is run once with previously generated DIVIMP background 
      in the SOL
      before SOL 22 is invoked. This generates power terms but does not include
      puffing.</P>
    
    <P><B>Option 17</B> : PIN is run once with previously generated DIVIMP background 
      in the SOL
      before SOL 22 is invoked. This generates power terms but does not include
      puffing. In addition, each subsequent iteration through the solver will
      ensure that the original solution is used for the core and private plasma regions.
      Only the main SOL plasma is allowed to evolve. This option pre-dated the 
      piece-wise background plasma options and it is recommended that one use
      the piece-wise method of combining plasma solutions to obtain the same effect. </P>
    
    <P> </P>
    
    <H3><A NAME="swionp">Private Plasma Ionization Option</A> </H3>
    
    <P> This option allows one to specify a different analytic ionization model
      in the private plasma from what is used in the main SOL. The physics in
      the private plasma are very different from the main SOL and a very
      different background plasma may result. This makes using the same initial
      ionization source option in these two regions somewhat invalid since one
      might expect quite different behaviour. These options will only be active
      IF the Tgrad option has been set to &quot;1&quot; so that SOL22 will be
      applied to both main SOL and PP rings. </P>


    <P><B>Option -6.0</B>: A uniform plasma is assigned
          to each ring in the private flux zone from a listing of temperature 
          and density in the divimp input file.  The target values are set
          from the bulk plasma values.</p>

    <P><B>Option -5.0</B>:  A uniform plasma is assigned
          to each ring in the private flux zone from a listing of
          temperature and density in the divimp input file.  The target values are not
          modified.</p>

    <P><B>Option -4.0</B>:  Experimental Thomson data is applied to the private plasma.
          the average value of the Thomson data on a ring is assigned
          to every cell on the ring.  Rings without 
          data are interpolated.  The target flux is
          assigned using the thomson data.</P>

    <P><B>Option -3.0</B>: Experimental Thomson data is applied to the private plasma.
          The average value of the Thomson data on a ring is assigned
          to every cell on the ring.  Rings without 
          data are interpolated.  The target flux is
          specified in the divimp input file.</p>
    
    <P><B>Option -2.0</B>: Specified Plasma This option uses a completely
      arbitrary, <A HREF="#ppspec">specified background plasma</A> for the
      private plasma region. This specification is exactly the same as Trap
      Temperature Gradient Option 2 and uses all the coefficients that are
      defined for that option. In practice, this option is identical to using
      Tgrad Option 2. Historically, this option was developed first and then
      later generalized into Tgrad Option 2 for use in combination with other
      SOL options.</P>
    
    <P><B>Option -1.0</B>: Matches Previous Same as Initial Ionization Option
      if the Main Ionization option has been set to 1.0, 2.0 or 8.0. Otherwise,
      the private plasma ionization option is set to the value of the Ionization
      option.</P>
    
    <P><B>Options 0.0 to 15.0</B>: These are identical to the options outlined
      in the Initial Ionization Option.</P>
    
    <P> </P>
    
    <H3><A NAME="swnvkt">5/2 nv kT Term:</A></H3>
    
    <P> This option turns on/off the first convection term in the fluid
      equations for both ions and electrons. </P>
    
    <P><B>Option 0.0</B>: Off</P>
    
    <P><B>Option 1.0</B>: On</P>
    
    <P> </P>
    
    <H3><A NAME="swmv3n">1/2 m v<SUP>3</SUP> n Term </A></H3>
    
    <P> This will turn on/off the kinetic convection term for ions.</P>
    
    <P><B>Option 0.0</B>: Off</P>
    
    <P><B>Option 1.0</B>: On</P>
    
    <P> </P>
    
    <H3><A NAME="swprad">Prad Option:</A></H3>
    
    <P> This option turns on and off the radiative loss source term. The
      radiative loss term imposes a certain amount of power loss in each cell
      that could be due to radiative power losses. There are a couple of options
      supported.</P>
    
    <P><B>Option 0.0</B>: Off - No Radiative Losses</P>
    
    <P><B>Option 1.0</B>: On - Exponential Decay radiation source. The
      radiation falls off exponentially away from the target. The
      <A HREF="#radl">length of the decay source</A>, the <A HREF="#radlam">characteristic
        decay distance of the exponential</A>, and the <A HREF="#radfrr">total
        integrated power radiated</A> are all specified in parameters described
      earlier in the document.</P>
    
    <P> <IMG SRC="images/divref-66.gif" WIDTH="323" HEIGHT="61"></P>
    
    <P><B>Option 2.0</B>: On - The power loss is described by the
      <A HREF="#garcha">Garching Model.</A> The equations and their parameters
      are described in the parameter section.</P>
    
    <P><B>Option 3.0</B>: On - Radiative losses are proportional to PINQE. The multiplier
      is specified by <a href="#249">this parameter</a>.</P>

    <P> </P>
    
    <H3><A NAME="swphlp">Phelpi Option:</A></H3>
    
    <P> This option estimates the power loss for electrons due to hydrogenic
      ionization.</P>
    
    <P><B>Option 0.0</B>: Off Off - No power loss due to hydrogenic
      ionization.</P>
    
    <P><B>Option 1.0</B>: On On - Analytic calculation of electron energy
      losses due to hydrogenic ionization. The analytic formula used to estimate
      this is the following.</P>
    
    <P> <IMG SRC="images/divref-67.gif" WIDTH="211" HEIGHT="31"></P>
    
    <P> <IMG SRC="images/divref-68.gif" WIDTH="498" HEIGHT="60"></P>
    
    <P><B>Option 2.0</B>: On - PINQE On - PINQE used - Option 1 (ANALYTIC) is
      used on the seed plasma iteration. For subsequent iterations the electron
      energy losses as reported by PIN are used. </P>
    
    <P><B>Option 3.0</B>: On - PINQE On - PINQE used - Option 0 (OFF) is used
      on the seed plasma iteration. For subsequent iterations the electron
      energy losses as reported by PIN are used. </P>
    
    <P> </P>
    
    <H3><A NAME="swpei">Pei Option:</A></H3>
    
    <P> Equipartition power term due to electron/ion energy transfer. This term
      has been found to be quite destabilizing at low temperatures because as
      one solves the equations moving upstream - the hotter species will get
      hotter due to this term and the cooler species will cool further. To be
      stable this term needs adequate compensating flows from other power
      sources. </P>
    
    <P><B>Option 0.0</B>: Off Off - the term is not calculated and is not
      included in the power balance equations. </P>
    
    <P><B>Option 1.0</B>: On On - the term is calculated according to the
      formula in the DIVIMP Guide - modified by the Pei parameter described
      previously. (Note: There is a typographical error in the Guide in the Pei
      equation - eqn. 3.68: the exponent in the numerator should not be 3/2 but
      instead should be 1)</P>
    
    <P> <IMG SRC="images/divref-69.gif" WIDTH="450" HEIGHT="71"></P>
    
    <P> <IMG SRC="images/divref-70.gif" WIDTH="188" HEIGHT="71"></P>
    
    <P><B>Option 3.0</B>: Off - (but calculated) Pei is not applied to the
      solver but the values are calculated using the formula of option 1.0 and
      are then stored in the .lim or .SOL output file. </P>
    
    <P> </P>
    
    <H3><A NAME="swpcx">Pcx Option:</A></H3>
    
    <P> This option instructs the solver to include the designated ion energy
      loss/gain due to various processes in the ion energy balance equation.
    </P>
    
    <P><B>Option 0.0</B>: Off Off - No ion power term is used. </P>
    
    <P><B>Option 1.0</B>: On - Analytic CX An analytic formulation of ion CX
      energy losses only is included. (See Guide for more information)</P>
    
    <P> <IMG SRC="images/divref-71.gif" WIDTH="300" HEIGHT="30"></P>
    
    <P><B>Option 2.0</B>: On - PINQI On - For the seed plasma iteration,
      option 1 is used to calculate the ion power term (keep in mind the CEICF
      factor specified in the parameter list). On subsequent iterations the ion
      energy loss/gain from PIN is used. </P>
    
    <P><B>Option 3.0</B>: On - PINQI On - For the seed plasma iteration,
      option 0 (OFF) is used for the ion power term. On subsequent iterations
      the ion energy loss/gain from PIN is used. </P>
    
    <P><B>Option 4.0</B>: On - DIVIMP QI On - The seed plasma iteration is
      calculated using option 0 (OFF) for the ion power term. On subsequent
      iterations, DIVIMP uses the quantities returned from PIN to estimate the
      values of four of the components parts of the ion power source term. These
      are the Atomic Ionization, Molecular Ionization, Charge Exchange and
      Recombination. Each of these components to DIVIMP QI can be calculated
      with different options which are outlined below. Furthermore, each of the
      contributions has an associated cut-off temperature. If the background
      temperature in a cell is less than the cutoff then no contribution to the
      specific source term in that cell is included in the integration. (This
      term is also referred to as PINQID).</P>
    
    <P><B>Option 5.0</B>: On - PINQI On - Internal PCX term (option 1) is on
      for seed plasma iteration. PINQI term is used for subsequent iterations
      EXCEPT that the PINQI term is clipped. Plasma heating by the PINQI term is
      not allowed. </P>
    
    <P> </P>
    
    <H3><A NAME="qid-ai">PINQID - DIVIMP calculated Qi - Atomic Ionization</A></H3>
    
    <P> This option specifies how the contribution to the ion power source term
      due to atomic ionization is to be calculated. The values for the densities
      of neutral hydrogen as well as neutral hydrogen molecules and the
      ionization source are all generated by PIN. When the temperature in the
      cell is less than a specified cutoff the contribution is set to zero. </P>
    
    <P><B>Option 0</B> : Off Off - no contribution due to atomic ionization</P>
    
    <P><B>Option 1</B>: On On - Ionization from PIN.</P>
    
    <P> <IMG SRC="images/divref-72.gif" WIDTH="360" HEIGHT="70"></P>
    
    <P><B>Option 2</B>: On On - Ionization rates from ADAS</P>
    
    <P> <IMG SRC="images/divref-73.gif" WIDTH="435" HEIGHT="50"></P>
    
    <P> </P>
    
    <H3><A NAME="qid-mi">PINQID - DIVIMP calculated Qi - Molecular Ionization</A></H3>
    
    <P> This option specifies how the contribution to the ion power source term
      due to molecular ionization is to be calculated. The values for the
      densities of neutral hydrogen as well as neutral hydrogen molecules and
      the ionization source are all generated by PIN. When the temperature in
      the cell is less than a specified cutoff the contribution is set to zero.
    </P>
    
    <P><B>Option 0</B> : Off Off - no contribution due to molecular ionization</P>
    
    <P><B>Option 1</B>: On On - Ionization from PIN - fixed 3eV
      contribution/event.</P>
    
    <P> <IMG SRC="images/divref-74.gif" WIDTH="308" HEIGHT="70"> </P>
    
    <P><B>Option 2</B>: On On - Ionization rates from ADAS - the atomic
      ionization rate is used as an approximation to the molecular ionization
      rate.</P>
    
    <P> <IMG SRC="images/divref-75.gif" WIDTH="393" HEIGHT="31"></P>
    
    <P> </P>
    
    <H3><A NAME="qidrec">PINQID - DIVIMP calculated Qi - Recombination</A></H3>
    
    <P> This option specifies how the contribution to the ion power source term
      due to recombination is to be calculated. When the temperature in the cell
      is less than a specified cutoff the contribution is set to zero. </P>
    
    <P><B>Option 0</B> : Off Off - no contribution due to recombination power
      terms.</P>
    
    <P><B>Option 1</B>: On On - Recombination rates from ADAS.</P>
    
    <P> <IMG SRC="images/divref-76.gif" WIDTH="403" HEIGHT="50"></P>
    
    <P> </P>
    
    <H3><A NAME="qidcx">PINQID - DIVIMP calculated Qi - Charge Exchange </A></H3>
    
    <P> This option specifies how the contribution to the ion power source term
      due to charge exchange is to be calculated. The values for the densities
      of neutral hydrogen and the ionization source are generated by PIN. When
      the temperature in the cell is less than a specified cutoff the
      contribution is set to zero. </P>
    
    <P><B>Option 0</B> : Off Off - no contribution due to charge exchange.</P>
    
    <P><B>Option 1</B>: On On - Ionization from PIN. Reference Temperature is
      a specified parameter.</P>
    
    <P> <IMG SRC="images/divref-77.gif" WIDTH="396" HEIGHT="50"></P>
    
    <P><B>Option 2</B>: On On - Charge Exchange cross-section from analytic
      formula. The temperature differential is used for calculating
      contributions.</P>
    
    <P> <IMG SRC="images/divref-78.gif" WIDTH="401" HEIGHT="50"></P>
    
    <P> <IMG SRC="images/divref-79.gif" WIDTH="393" HEIGHT="170"></P>
    
    <P><B>Option 3</B>: On On - Charge Exchange cross-section from ADAS. The
      temperature differential is used for calculating contributions. ADAS
      charge exchange cross-sections were considered unreliable at the time of
      writing.</P>
    
    <P> <IMG SRC="images/divref-80.gif" WIDTH="481" HEIGHT="50"></P>
    
    <P><B>Option 4</B>: On On - This option is identical to Option 2 - except
      that the contributions are limited to ion cooling only. (i.e. &quot;-&quot;
      ve - or power loss from ions - if Tatom is greater than Ti - then the
      contribution (r) 0 for that cell). </P>
    
    <P> </P>



    <H3><A NAME="264">264    Switch: PP ElecLoss    : 0.0-off 1.0-XPT 2.0-DIS </A></H3>

    <P><B>Option 0</B>: Private plasma electron power loss compensation term is OFF.</p>

    <P><B>Option 1</B>: Private Plasma  electron power loss compensation term is ON.
        Electron power lost to each element of the private plasma 
        target is removed from the main SOL rings in
        the corresponding position relative to the
        separatrix. This power loss
        is distrtibuted evenly to the Xpoint on
        the main SOL rings.</p>

    <P><B>Option 2</B>: Private plasma  electron power loss compensation term is ON.
         Electron power lost to each element of the private plasma
         target is removed from main SOL rings in
         the corresponding position relative to the
         separatrix. This power loss
         is distrtibuted evenly over Smax *
           <a href="#230"> the power distribution parameter</a>
         from each target on the main SOL rings.</p>

    <P></P> 

    <H3><A NAME="265">265    Switch: PP IonLoss     : 0.0-off 1.0-XPT 2.0-DIS </A></H3>

    <P><B>Option 0</B>: Private plasma ion power loss compensation term is OFF.</p>

    <P><B>Option 1</B>: Private Plasma  ion power loss compensation term is ON.
        Ion power lost to each element of the private plasma 
        target is removed from the main SOL rings in
        the corresponding position relative to the
        separatrix. This power loss
        is distrtibuted evenly to the Xpoint on
        the main SOL rings.</p>

    <P><B>Option 2</B>: Private plasma ion power loss compensation term is ON.
         Ion power lost to each element of the private plasma
         target is removed from main SOL rings in
         the corresponding position relative to the
         separatrix. This power loss
         is distrtibuted evenly over Smax *
           <a href="#230"> the power distribution parameter</a>
         from each target on the main SOL rings.</p>

    <P></P>
    
    <H3><A NAME="swvisc">Viscosity Option:</A></H3>
    
    <P> NOT IMPLEMENTED. This was associated with attempts to include parallel
      viscosity in the transport equations. At present it does nothing but
      should be specified with an Option of 0.0 to ensure that it is OFF.</P>
    
    <P> </P>
    
    <H3><A NAME="swml">Momentum Loss Option:</A></H3>
    
    <P> This option specifies the form of the momentum loss or pressure term in
      the equations that are being solved. The pressure loss due to neutral 
      interactions can have
      a significant effect on the solution. Furthermore, it tends to be a
      stabilizing factor within the solver since the pressure is an important
      term in the equation where imaginary values are usually found. </P>
    
    <P><B>Option 0</B>: Off Off - pressure loss is turned OFF.</P>
    
    <P><B>Option 1</B>: On - Rectangular On - rectangular/constant/flat
      momentum loss source from the target to specified cut off length, with a
      specified total integral value. (See Guide)</P>
    
    <P> S<sub>mom</sub> = S<sub>mom0</sub>&nbsp;&nbsp; for S <= F<SUB>L</SUB> * SMAX</P>
    
    <P> S<sub>mom</sub> = 0 &nbsp;&nbsp;for S &gt; F<SUB>L</SUB> * SMAX</P>
    
    <P> <IMG SRC="images/divref-81.gif" WIDTH="291" HEIGHT="66"></P>
    
    <P> </P>
    
    <P><B>Option 2</B>: On - Exponential On- Exponential decay momentum loss
      source - decaying away from the target with specified decay length,
      maximum length and magnitude specified by the F<SUB>fric</SUB> factor.
      (See Guide)</P>
    
    <P> <IMG SRC="images/divref-82.gif" WIDTH="495" HEIGHT="60"></P>
    
    <P> <IMG SRC="images/divref-83.gif" WIDTH="288" HEIGHT="28"></P>
    
    <P> <IMG SRC="images/divref-84.gif" WIDTH="495" HEIGHT="66"></P>
    
    <P><B>Option 3</B>: On - Proportional On- Proportional to ionization
      source. The magnitude of the momentum loss is defined as in options 2 and
      3. However, in this case it is distributed in proportion to the ionization
      source. The integral is performed over the half field line. This is
      proportional to the specified ionization source - either analytic or
      returned from a PIN run. </P>
    
    <P> <IMG SRC="images/divref-85.gif" WIDTH="225" HEIGHT="28"></P>
    
    <P> <IMG SRC="images/divref-86.gif" WIDTH="383" HEIGHT="66"></P>
    
    <P><B>Option 4</B>: On - Proportional On - Proportional to the ionization
      source. The momentum loss in this case is calculated assuming that the
      ions are moving at the background velocity found at the given s-position
      by the solver. In addition it is proportional to the ionization source
      modified by a number of multiplicative factors defined earlier in the
      text. R<SUB>cxmult</SUB> is a function of Te and varies between 1.0 and
      1500.0. The other multiplicative factor R<SUB>cx/iz</SUB> is a constant
      parameter that is usually set to 1.0 but can be used to increase the
      effectiveness of the momentum loss term over the entire range. </P>
    
    <P> <IMG SRC="images/divref-87.gif" WIDTH="445" HEIGHT="30"></P>
    
    <P><B>Option 5</B>: Off Off - not used at present. This was an initial
      test option for PIN related momentum loss. It now sets momentum loss equal
      to zero if it is selected. </P>
    
    <P><B>Option 6</B>: On- PIN - <I>Untested</I> On - PIN - This option
      generates the seed plasma using Momentum Loss Option 0 (OFF) and then
      reads the momentum source from PIN (PINMP array). The PINMP array may be
      unreliable for statistical reasons so this option is not recommended
      unless some verification of the validity of the PINMP values has already
      been completed. </P>
    
    <P><B>Option 7</B>: On- PIN - <I>Untested</I> On - PIN - This option
      generates the seed plasma using Momentum Loss Option 1 (Rectangular) and
      then reads the momentum source from PIN (PINMP array). The PINMP array may
      be unreliable for statistical reasons so this option is not recommended
      unless some verification of the validity of the PINMP values has already
      been completed. </P>
    
    <P><B>Option 8</B>: On- PIN - <I>Untested</I> On - PIN - This option
      generates the seed plasma using Momentum Loss Option 2 (Exponential) and
      then reads the momentum source from PIN (PINMP array). The PINMP array may
      be unreliable for statistical reasons so this option is not recommended
      unless some verification of the validity of the PINMP values has already
      been completed. </P>
    
    <P><B>Option 9</B>: On - EDGE2D On - EDGE2D - This option is based on
      charge exchange momentum loss Cross-sections taken from the Edge2D/NIMBUS
      implementation. The option needs quantities from a PIN run so for the
      initial seed plasma calculation the momentum loss option is turned OFF.
      The rates are multiplied by the R<SUB>cx/iz</SUB> factor.</P>
    
    <P> Implemented in DIVIMP by Wojciech Fundamenski.</P>
    
    <P><B>Option 10</B>: On - EDGE2D On - EDGE2D - This option is similar to
      option 9. This option factors in the H<SUP>0</SUP> velocity distributions
      as returned by PIN.</P>
    
    <P> </P>
    
    <H3><A NAME="swmach">Iterative Mach Number Option:</A></H3>
    
    <P> This option instructs the solver to attempt to resolve any invalid
      solutions for density or temperature (e.g. imaginary density values or
      negative temperatures) by increasing the background flow mach number at
      the target. Following both the super and sub-sonic solutions to the
      equations yields a situation in which one follows the super-sonic branch
      from the target until it can make a smooth transition (at the point where
      the two solutions just touch) to the sub-sonic branch. The solver steps up
      the mach number until it finds a solution where there are no imaginary
      values encountered. It then steps back to the previous mach number that
      did not work, divides the mach number increment by 10 and starts iterating
      up from there until it again finds a solution that does not generate
      invalid results. It continues this process until it reaches the resolution
      limit for the mach number specified in the input and then stops. At this
      time, the mach solver finds that the solutions near the critical mach
      number are very dependent on the exact value of the target mach number.
      This instability can cause odd effects near the transition point in the
      plasma solution. If the mach solver is in use, it is important to peruse
      the results and check them for validity as well as checking the output
      files for any warnings. </P>
    
    <P><B>Option 0</B>: Off Off - the target Mach number is fixed at the input
      value - usually 1.0. The velocity error setting is used to deal with any
      imaginary values encountered. </P>
    
    <P><B>Option 1</B>: On On - Target Mach number is changed as indicated to
      obtain a solution but the density at the target is held fixed. This
      effectively becomes a modification of the target particle flux.</P>
    
    <P><B>Option 2</B>: On On - The target density is changed as well as the
      target mach number in such a way that the particle flux onto the target
      segment is conserved. This is the only option compatible with unnormalized
      PIN ionization and perpendicular flux correction option 2. Since most
      target data is actually based on flux measurements - it is believed that
      this is the better option to select if using mach number iteration. </P>
    
    <P><B>Option 3</B>: On Fixed Target MACH number option. Target mach number
      is NOT fixed to 1.0 but is defined to be a constant value calculated from
      the flow velocity at the target divided by the sound speed. For example,
      if the flow velocity happens to equal the sound speed the solver will use
      MACH=1.0. In this option, for a value other than 1.0 to be found - the
      target flow velocity will have been derived using alternate methods.
      Perhaps obtained from the ratio of the down flux and the target density.
    </P>
    
    <P> </P>
    
    <H3><A NAME="swe2d">Edge 2D Data Compatibility Option:</A> </H3>
    
    <P> This is an attempt to improve compatibility between the SOL Option 22
      solver and Edge2D for comparison purposes. When this option is active the
      solver starts at the middle of the first grid cell using data drawn
      directly from an Edge2D case. There are several different options due to
      the difficulty of precisely specifying the velocity at the middle of the
      first cell based on an Edge2D output. In addition, this option was
      implemented in the first place solely because of the difficulty in
      precisely specifying the target conditions applicable in an Edge2D case.
      As such, this option should be turned off when examining experimental
      data. </P>
    
    <P><B>Option &lt; 0</B>: On On - EDGE2D compatibility options less than
      zero instruct the solver to run once using the EDGE2D background plasma
      solution for the SOL and then to use the absolute value of the
      compatibility option for subsequent iterations of SOL 22.</P>
    
    <P><B>Option 0</B>: Off Off - the solver works from the target with the
      specified target conditions determining the velocity and the sound speed
      at the target.</P>
    
    <P><B>Option 1</B>: On - Pressure On - The velocity at the starting point
      (middle of the first cell) is calculated from conservation of pressure
      from the actual target conditions, as reported by Edge2D, to the values
      reported at the middle of the first cell. This assumes that there is no
      pressure loss in the first half cell. </P>
    
    <P><B>Option 2</B>: On - EDGE2D Ghost On - The velocity at the starting
      point (middle of the first cell) is the average of the velocity at the
      cell faces (as reported by Edge2D) in the ghost (.g80) plasma background
      file. </P>
    
    <P><B>Option 3</B>: On - Parallel Flux On - The velocity at the starting
      point (middle of the first cell) is calculated by taking the parallel flux
      into and out of the cell at each cell boundary - obtaining an average flux
      for the cell and then dividing by the cell density to get an average
      velocity for the cell centre. </P>
    
    <P><B>Option 4</B>: Debug - EDGE2D Ghost On - Edge2D Data is read for
      first cell - the velocity is taken from the EDGE2D value for the first
      cell centre. SOL 22 is NOT run. The EDGE2D solution is used for the
      background plasma. This option is used only to produce detailed flux
      analyses for debugging purposes.</P>
    
    <P><B>Option 5</B>: Debug - Off Off - fluxes are calculated from the
      target - optionally taken from the EDGE2D solution. SOL 22 is NOT run. The
      EDGE2D solution is used for the background plasma. This option is used
      only to produce detailed flux analyses for debugging purposes.</P>
    
    <P><B>Option 6</B>: Debug - Pressure On - Edge2D data is read for first
      cell - EDGE2D pressure is matched at the first cell centre. SOL 22 is NOT
      run. The EDGE2D solution is used for the background plasma. This option is
      used only to produce detailed flux analyses for debugging purposes.</P>
    
    <P><B>Option 7</B>: Debug - Parallel Flux On - Edge2D data is read for
      first cell - the cell centre velocity is calculated from the cell boundary
      fluxes and cell density extracted from the EDGE2D solution. SOL 22 is NOT
      run. The EDGE2D solution is used for the background plasma. This option is
      used only to produce detailed flux analyses for debugging purposes.</P>
    
    <P><B>Option 8</B>: On - Down Flux On - Solver will run from the middle of
      the first cell. Cell centre velocity is obtained by averaging the EDGE2D
      fluxes into the cell and dividing by the density. The fluxes used in this
      option are NOT the EDGE2D fluxes from the GHOST file. These are the EDGE2D
      DOWN fluxes and are read in from an auxiliary input file. These values
      will be extracted from the EDGE2D down flux listing. If EDGE2D TARGET
      OPTION 5 is also selected then the down power fluxes as well as particle
      fluxes will also be used. </P>
    
    <P><B>Option 9</B>: On - Down Flux (Knot) On - Solver runs from the middle
      of a SPECIFIED cell. The starting knot index is specified by the Start
      Knot Index Value described above. Edge2D data is required for the entire
      ring. EDGE2D DOWN fluxes are extracted from an auxiliary file - the EDGE2D
      DOWN flux listing. The starting velocity at the cell centre is determined
      by averaging the cell face down fluxes and dividing by the density. If
      EDGE2D TARGET OPTION 5 is also specified then the solver will use both the
      down particle fluxes and down power fluxes. The cells between the target
      and the cell where the solver begins are filled with values determined by
      the FILL OPTION described above.</P>
    
    <P> </P>
    
    <H3><A NAME="swpow">Power Distribution Option:</A></H3>
    
    <P> Many of the older DIVIMP SOL options implicitly assume that all of the
      power onto the targets plus any other sources must enter at the mid-point
      between targets and be carried all the way along the SOL by the various
      transport mechanisms. This option adds the ability to distribute the
      required input power (target flows and in some options volume sources as
      well) over various lengths of the whole or half-ring. This models the
      expected reduction in power transported as the equations are solved
      towards the mid-point. The effect of this option is to reduce some of the
      &quot;peakiness&quot; towards the mid-point of the temperature solutions
      seen in SOL option 12, 13 and 22 (when this option is turned OFF).
      However, when used in conjunction with PIN ionization and perpendicular
      flux corrections, it can occur that the convection terms in the heat
      equation at the mid-point end up carrying all of the heat flux. In some
      cases, the convection terms carry significantly more than the heat flux
      required to satisfy the target and volume power sinks on the ring. In 
      order to compensate for this, the conduction term is forced to carry heat
      in the opposite direction in order to satisfy the conservation equation.
      This situation can result in temperatures dropping (downward temperature
      gradient) towards the mid-point as the conduction term tries to counteract
      the convection term. In particular, when using PINQI (the ion energy term
      from PIN), the integration of the volume power terms can show a net power
      gain by the ions, which when combined with a reduced requirement for power
      flow as one approaches the mid-point, can result in negative ion
      temperatures being encountered by the solver. This situation is still
      under investigation. However, errors of this type are flagged and printed
      in both the output data file and in the .lim file. Also, unless the power
      distribution option explicitly distributes a specific power source, it
      will be treated as if the power to supply it was coming in at the
      mid-point between the targets.</P>
    
    <P><B>Option 0</B>: Off Off - All power is assumed to come in at the top
      (mid-point on the ring between targets.)</P>
    
    <P><B>Option 1</B>: On - Target - Half Ring On - The total TARGET power
      flux (for both electrons and ions) is evenly distributed over the entire
      1/2 ring. This means that the power required to be carried by each species
      falls linearly from the target power flux at s = 0 to 0.0 at s = SMAX/2.
      There is no adjustment for volume power terms. These are implicitly
      assumed to be supplied by a flow from the mid-plane. </P>
    
    <P><B>Option 2</B>: On - Target - X-point On - The total TARGET power flow
      is evenly distributed from an S-position approximately equivalent to the
      X-point for each ring to the mid-point. For the region from the X-point to
      the target the equations are identical to option 0 where all of the target
      power flow is being transported by the usual mechanisms. </P>
    
    <P><B>Option 3</B>: On - Major Radius On - This is identical to option 1
      except that the power losses have been modified by a Major Radius
      correction. This is for use ONLY when the major radius correction option
      has been selected. In addition, many newer options have not been designed
      to work with the Major Radius corrected version of the solver and can not
      be expected to work correctly. </P>
    
    <P><B>Option 4</B>: On - Targets - Whole Ring On - The power flux to both
      targets is added together and then evenly distributed over the entire
      ring. This forces the power being carried by each species to ramp linearly
      from the value at one target to the value at the other target. This will
      likely result in power being transported across the mid-point. Keep in
      mind that the sign of the power flux at the two targets is different
      because the velocity at the two targets have opposite signs.</P>
    
    <P><B>Option 5</B>: On - Target + PIN - Half On - The TARGET power flow
      and power from both the PINQE and PINQI volume terms are added together
      and distributed over the half ring. This option is equivalent to option 1
      for the seed plasma solution and otherwise only works with PIN when either
      or both of PINQE and PINQI are specified for source power loss terms in
      the Phelpi and Pcx options mentioned above. </P>
    
    <P><B>Option 6</B>: On - Target +PIN - Whole On - This is the same as
      option 4 except that it also includes the PIN based power terms if
      available and in use. </P>
    
    <P><B>Option 7</B>: On - Target - Dist On - the target power flow is
      distributed from a specified position F<SUB>1</SUB> &times; SMAX to the
      midpoint of the ring. The factor F<SUB>1</SUB> is described in the
      parameter section above.</P>
    
    <P><B>Option 8</B>: On - Target + PIN - Dist On - This is the same as
      option 7 except that it also includes the PIN based power terms if they
      are available and in use. </P>
    
    <P><B>Option 9</B>: On - Target - Dist2 On - the Target power flow is
      evenly distributed between two given positions on the field-line. (F<SUB>1</SUB>
      &times; SMAX to F<SUB>2</SUB> &times; SMAX).</P>
    
    <P><B>Option 10</B>: On - Target + PIN - Dist2 On - This is the same as
      option 9 except that it also includes the PIN based power terms if they
      are available and in use. </P>
    
    <P><B>Option 11</B>: On- Target - Whole - Dist On - This is the same as
      option 4 - the total target power outflux is summed and distributed evenly
      over the ring starting at a distance F<SUB>1</SUB> ( SMAX from each
      target.</P>
    
    <P> </P>
    
    <H3><A NAME="swpowp">Private Plasma Power Distribution:</A></H3>
    
    <P> This option allows a different power distribution option to be
      specified in the Private Plasma. This feature may be necessary because the
      physics of the power influx in the private plasma region may be quite
      different from the processes and behaviour that dominate the heat flux
      into the main SOL rings. </P>
    
    <P><B>Option -1.0</B>: Special Set the value of this switch equal to the
      value used for the general power option.</P>
    
    <P><B>Options: 0.0 to 11.0</B> Off/On - These options are identical to
      those described above.</P>
    
    <P> </P>
    
    <H3><A NAME="swgprp">Gamma Perp Option:</A></H3>
    
    <P> This is a perpendicular flux correction option. It is used to ensure
      that the particle balance for each ring is maintained. When using an
      unnormalized ionization source, with or without recombination particle
      sources, a condition of over or under-ionization on a flux tube may be
      encountered. If left uncorrected this will result in a constant background
      drift velocity beyond the end of the ionization source because there are
      no additional particle sources or sinks. Furthermore, the only time the
      velocity will be exactly zero is when the target sink is equal to the
      ionization source. This is obviously both an unacceptable and unphysical
      solution since it is clear that cross-field particle sources and sinks
      will, in steady state, ensure that the sum of sources and sinks on the
      field line is zero. This option implements a very simple version of a
      cross-field source - any particle excess or deficit (after considering the
      target fluxes and the ionization source) is then compensated for by a
      cross-field source/sink term distributed over the entire field line. This
      ensures that the velocity will cross through zero at least once and also
      results in a more realistic evolution of the particle source. This option
      is only effective with unnormalized sources - typically a PIN result. It
      has no effect on sources that are normalized to the target flux as there
      is no excess/deficit that needs to be compensated for in these cases. In
      general, this option will have no effect on the seed plasma iteration
      since the seed plasma ionization source will usually be normalized.</P>
    
    <P><B>Option 0</B>: Off Off - no additional cross-field source or sink is
      used in the calculations. </P>
    
    <P><B>Option 1</B>: On - Half-Ring On - The flux correction is calculated
      for each half ring independently. This causes the flux (and thus also the
      velocity) to fall to zero at the mid-point of the ring and ensures
      particle conservation on each half ring.</P>
    
    <P><B>Option 2</B>: On - Whole Ring On - The flux correction is calculated
      for the entire flux tube from target to target by summing ionization and
      target flux for the entire ring and distributing the resulting difference
      uniformly over the entire ring. The velocity will cross zero somewhere on
      the ring and in the case of ionization exceeding target fluxes - may cross
      more than once. </P>
    
    <P><B>Option 3</B>: On - Whole Ring - N On - The flux correction is
      calculated for the entire flux tube from target to target by summing
      ionization and target flux for the entire ring. Additional cross-field
      sources for under-ionized rings are applied using an evenly distributed
      perpendicular flux. Cross-field sinks for over-ionized rings are applied
      using a flux that is proportional to the density in each cell calculated
      on the previous iteration of the solver.</P>
    
    <P><B>Option 4</B>: On - Half Ring - N On - This is the same as option 3
      except that the particle source excess/deficit is calculated for only one
      half ring at a time. The distribution of the flux uses the strategy
      outlined in option 3.</P>
    
    <P><B>Option 5</B>: On - Half Ring + Rect On - The net flux along the
      field line goes to zero at the midpoint with a specified fraction of the
      required perpendicular flux being distributed uniformly over the half-ring
      with the remainder being distributed uniformly between specified start and
      end points on the half-ring. The fraction in the rectangular source is
      specified by the Compound Gperp fraction described previously. The
      rectangular region is specified from GperpF<SUB>1</SUB> &times; SMAX to GperpF<SUB>2</SUB>
      &times; SMAX from the target.</P>
    
    <P><B>Option 6</B>: On - Whole Ring + Rect On - This is the same as option
      5 except that the net flux goes to zero for the entire flux tube
      considered as a whole with a specified fraction of the required
      cross-field flux being included in the flux in two specified regions. One
      region near each target. The rest of the flux is included uniformly over
      the entire flux tube. The fraction in the rectangular source is specified
      by the Compound Gperp fraction described previously. The rectangular
      region is specified from GperpF<SUB>1</SUB> &times; SMAX to GperpF<SUB>2</SUB>
      &times; SMAX from both targets.</P>
    
    <P><B>Option 7</B>: On-Whole Ring-Gradient On - The net flux over the
      entire ring goes to zero with the excess or deficit distributed
      proportional to the second gradient of the density. This gradient is
      derived from either an EDGE2D solution or the SOL 22 solution from a
      previous iteration. This option is changed to a uniform distribution for
      any rings where the total positive or negative contribution for the ring
      exceeds five times the integrated value of the whole. The reason for this
      is that such case are usually unstable and do not produce useful results.
    </P>
    
    <P><B>Option 8</B>: On-Whole Ring-Absolute On - The net cross-field flux
      over the entire ring goes to zero. A cross-field component of the flux is
      calculated using a second gradient of the density of a previous iteration
      and a fixed value for the diffusion coefficient. Any remaining excess or
      deficit after this term is included is imposed as a uniform source or sink
      over the entire ring.</P>
    
    <P> </P>
    
    <H3><A NAME="swpgp">Private Plasma Gamma Perp Option:</A></H3>
    
    <P> A different Gperp option can be specified for the Private Plasma from
      that used for the main SOL. However, these options will share the same
      parameter values if the Gperp option requires them. The options available
      are the same as those for the regular Gperp option.</P>
    
    <P> </P>

    <H3><A NAME="274">274 Extra Perpendicular Source and Sink Option</A></H3>

    <P><B>Option 0</B>: Extra perpendicular flux term is OFF.

    <P><B>Option 1</B>: Extra perpendicular flux term is ON. An extra source 
         and sink are superimposed on the flux tube. This
         source and sink exactly cancel but will
         affect the flow pattern on the flux tube.

    <p>Source and Sink Strength = (total target flux on ring) * <a href="#227"> Fstr </a></p>

    <p>The source is imposed over the region: Smax  * <a href="#228">[F1,F2] </a> </p>

    <p>The sink is imposed over the region: Smax  * <a href="#229">[F3,F4] </a></p>

    <p></p> 
    
    <H3><A NAME="swmajr">Major Radius Option: </A></H3>
    
    <P> This is an attempt to restructure the entire solver to work using
      equations that have been adapted to a varying value of Major Radius.
      Extensive comparisons have been made between this and the standard OSM
      methods that do not include the major radius effect. Differences are
      minimal and it is recommended that this option be left turned OFF.
      Furthermore, a number of the newer features of both the ionization sources
      and power sources will not work correctly in combination with this option.
      Some of the options are intended to NOT generate correct major radius
      solutions but to instead explore the magnitude of the effects of these
      changes on the solutions. </P>
    
    <P><B>Option 0</B>: Off OFF - NORMAL operation. This is the recommended
      setting.</P>
    
    <P><B>Option 1</B>: On - Target Correction On - All target fluxes are
      adjusted by Rtarg/R0</P>
    
    <P><B>Option 2</B>: On - Source Correction On - All ionization sources are
      adjusted by Rcell/R0</P>
    
    <P><B>Option 3</B>: On - Source Correction On - All ionization sources are
      adjusted by R0/Rcell</P>
    
    <P><B>Option 4</B>: On - General Correction On - Generalized R-correction
      to both ionization and target fluxes. Both of these quantities must be
      adjusted in order to correctly include major radius effects.</P>
    
    <P> </P>
    
    <H3><A NAME="swcore">Core Flux Source:</A></H3>
    
    <P> NOT IMPLEMENTED. The purpose of this option was originally related to
      compensating the ionization source for ionization occurring inside the
      innermost ring on the grid. However, this was then superseded by the
      Perpendicular Flux correction option that ensured particle conservation
      for each ring. It became unnecessary to try to add to the ion source any
      particles that would have been ionized within the central core escape
      region of the grid because the flux of these particles would already be
      included in the Perpendicular Flux option. In addition, the distribution
      of such a source would not be better defined using a separate option than
      would be possible using the available perpendicular flux options. This
      entry in the input file may be redefined in future releases of DIVIMP </P>
    
    <P>Option 0.0: Off Off - This option will do nothing - no matter what value
      is used. </P>
    
    <P> </P>
    
    <H3><A NAME="swrec">Recombination Source Option</A></H3>
    
    <P> <B>Option 0.0</B>: Off Off - No recombination particle source is added
      to the target flux and ionization in the calculation of the spatial
      particle fluxes and ring particle balance.</P>
    
    <P><B>Option 1.0</B>: On - DIVIMP/PIN On - The recombination particle
      source, as calculated by DIVIMP, is added to the calculation of the net
      particle flux and is included in the calculation of the particle balance
      on each ring. The temperature specified for the recombination cut-off
      limit results in this minimum value being used in the calculation of the
      recombination rates. </P>
    
    <P><B>Option 2.0</B>: On - Special Edge2D On - The recombination particle
      source calculated from the input Edge2d background is used in the solver.
      The option specifying the formulae to be used to calculate the
      recombination is described later in the text.</P>
    
    <P> </P>
    
    <H3><A NAME="swsmth">Smoothing Option:</A></H3>
    
    <P> This option will apply a smoothing algorithm to the density, Te and Ti
      profiles across the mid-point of the ring and thus supply a smoother
      looking background without the peakiness at the mid-point associated with
      the non-uniform power distribution usually employed by the solver. This is
      however, a completely ad hoc adjustment to the background and does not
      reflect any physics at all. The sole purpose is to obtain a smoother
      looking background plasma. However, since the solutions from each end of
      the ring would be expected to meet somewhere in the middle, this may not
      be a bad approximation, just one that is difficult to justify.</P>
    
    <P><B>Option 0</B>: Off Off - No smoothing is done</P>
    
    <P><B>Option 1</B>: On On - Smoothing by averaging over a number of
      adjacent cells is applied to smooth the peaks that usually occur at the
      mid-point of the rings. </P>
    
    <P> </P>
    
    <H3><A NAME="swdet">Detached Plasma Prescription Option</A></H3>
    
    <P> This option allows either the inner or outer half-rings to be specified
      using the <A HREF="#det">detached plasma specification</A> instead of
      solved using SOL22. </P>
    
    <P> <B>Option 0</B>: Off Detached Plasma Prescription is OFF</P>
    
    <P> <B>Option 1</B>: On Detached Plasma Model is used for the first
      half-ring starting at (IK=1). (OUTER target for JET)</P>
    
    <P> <B>Option 2</B>: On Detached Plasma Model is used for the second
      half-ring (IK=NKS(IR)) . (INNER target for JET).</P>
    
    <P> </P>
    
    <H3><A NAME="swerr">Error Correction Level</A></H3>
    
    <P> This switch turns on the solver error recovery mechanism. For some
      rings under certain conditions it can be impossible for the solver to
      arrive at a consistent and correct solution with the selected options.
      Usually this will occur when volume power source terms have been turned on
      and it will occasionally result in negative ion temperatures being found
      by the solver. Under these circumstances and if the minimum solver
      temperature option has not been specified, the solver sometimes can not
      find a valid solution for the ring. If this option is turned on the solver
      will restart the solution of the ring using a modified set of options that
      is more conservative than those originally specified. The solver will
      start at the specified error recovery level and work it's way down from
      the highest numbered option to the lowest. Each level of error recovery
      will include all of the error recovery actions taken in all of the higher
      levels unless the option specifically states otherwise. The eventual
      solution may be very simple and thus may not reflect the physics that
      could be included. However, the solution will also not include
      pathological values like negative temperatures that will interfere with
      the behaviour of the rest of the particle transport or with the behaviour
      of the other codes with which DIVIMP interacts. Whenever, this option is
      turned on, the print-out for SOL 22 should be checked and all rings which
      demonstrate an error condition should be closely examined to assure
      validity. </P>
    
    <P><B>Option 0.0</B>: Off - No error correction - if the solver dies
      on a particular ring the contents of the background plasma values will be
      those from the previous iteration OR the target values if this is the
      first iteration. The actual contents depend on the plasma decay option
      selected and the default values that are loaded into the arrays in 
      the &quot;plasma&quot; subroutine.</P>
    
    <P><B>Option 1.0</B>: On - Conduction Only On - The ring is solved using
      an analytic ionization source and only the conduction term - all other
      options and switches are turned OFF. </P>
    
    <P><B>Option 2.0</B>: On - As Level 3.0 + All convective terms are turned off.
    
    <P><B>Option 3.0</B>: On - As Level 4.0 + All power terms are turned off.</p>
    
    <P><B>Option 4.0</B>: On - As Level 5.0 + turn off convection terms 
        proportional to v<sup>2</sup></p>
    
    <P><B>Option 5.0</B>: On - As Level 6.0 + all power enters at the flux tube at the
       mid-point.</p>
    
    <P><B>Option 6.0</B>: On - As Level 7.0 + replace whole ring uniform particle
      balance with the equivalent half ring options.</p>
    
    <P><B>Option 7.0</B>: On - As Level 8.0 + use half-ring uniform power terms instead
       of whole ring.</p>
    
    <P><B>Option 8.0</B>: On - As Level 9.0 + use only the cooling portion of PINQI if
       the PINQI term is included.</P>
    
    <P><B>Option 9.0</B>: On - As level 10.0 + Use a uniform Gperp source
       instead of one proportional to
       d2n/dr2 if this option is active.</p>

    <P><B>Option 10.0</B>: On - Turn off equipartition if it is on. Pei option is
      set to zero.</P>
    
    <P> </P>
    
    <H3><A NAME="swdef">Automatic DEFAULT error correction</A></H3>
    
    <P> This option reads in a list of ring numbers that are to be solved using
      error correction level 1.0 default only. It has been found in some cases
      that only specific rings will experience trouble in the solver and these
      will always experience problems with the given set of selected options and
      switches. To save time in the solver for these rings- one can bypass the
      initial solution and instruct the solver to use the default error recovery
      initially for this list of specified rings. This option is usually used
      ONLY for pathological cases. This option is now redundant except for
      exceptionally pathological cases since the overall error correction level
      would eventually try to solve the ring using these options in any case if
      it could not find a solution using more complex options. </P>
    
    <P> </P>
    
    <H2><A NAME="soltst">SOLTEST Option:</A></H2>
    
    <P> This option is set non-zero when the ONLY purpose of the run is to
      generate a background plasma or to test the background plasma generation
      routines. It will stop the program execution before any ions are injected.
      A value of 0.0 is the normal default condition that will allow DIVIMP to
      execute normally. </P>
    
    <P><B>Option -1.0</B>: Complete Background Calculate a complete background
      plasma for all rings, iterating PIN and the selected SOL options if
      necessary, and stop before any impurity ions are followed. </P>
    
    <P><B>Option 0.0</B>: Run DIVIMP Normally Calculate the background plasma
      using the specified parameters and then execute DIVIMP and the ion
      following portion with the specified options. </P>
    
    <P><B>Option N.0</B>: Specific Ring - Debug Calculate the background
      plasma for the specified ring ONLY. This can be very useful for debugging
      plasma solutions for specific rings and target conditions. Unfortunately,
      since it does NOT generate a complete background, this option is
      incompatible with PIN iteration. </P>
    
    <P> </P>
    
    <H2><A NAME="hrec">H Recombination Calculation Option</A></H2>
    
    <P> This option specifies the formula to be used to calculate the
      Hydrogenic Recombination. This term is calculated in DIVIMP because it is
      not passed back from NIMBUS. (It is available from EIRENE). The option
      specified here is passed to NIMBUS as an input to ensure that the same
      calculations are made in DIVIMP and NIMBUS for the hydrogenic
      recombination source. The following entry is the specification of a lower
      temperature limit that may be used in the calculation of the 
      recombination. Some of the expressions or data used to calculate the
      recombination may not be reliable at very low temperatures. As a result,
      this mechanism was introduced to prevent this term from becoming
      exceedingly large at very low temperatures as seemed to be the trend in
      some cases.</P>
    
    <P><B>Option 0</B>: OFF Hydrogenic Recombination is OFF</P>
    
    <P><B>Option 1</B>: Gordeev Gordeev coefficients - as implemented in
      NIMBUS (May, 1996) - are used to calculate the recombination.</P>
    
    <P><B>Option 2</B>: Janev Janev coefficients - as implemented in NIMBUS
      (May, 1996) - are used to calculate the recombination.</P>
    
    <P><B>Option 3</B>: NRL NRL coefficients - as implemented in NIMBUS (May,
      1996) - are used to calculate the recombination.</P>
    
    <P><B>Option 4</B>: ADAS ADAS coefficients are used to calculate the
      recombination. </P>
    
    <P> </P>
    
    <H2><A NAME="hrect">H Recombination - Limiting Cutoff temperature (eV)</A></H2>
    
    <P> This is a lower limit cut-off temperature, implemented in DIVIMP, which
      is applied in the calculation of the recombination in the above formulae.
      Usually, this quantity is set to 0.0 so that it does not interfere with
      the calculations. It should only be used when a specific situation where a
      specific cell with an exceptionally low temperature contains so much
      recombination that it prevents the solver from working altogether. </P>
    
    <P> </P>
    
    <H2><A NAME="extrct">The Dperp/Chiperp Extractor</A></H2>
    
    <P> The purpose of this new feature is to extract estimates of the
      transport coefficients (Dperp and Xperp) from the background plasma that
      has been utilized by DIVIMP. The DIVIMP background can be calculated using
      the OSM - SOL option 22 - or any of the other SOL options that are
      included in DIVIMP, or it can be read in from the results of a fluid code
      like Edge2D or B2. There are several basic quantities that are required by
      the extractor before it can attempt to deduce estimates of these transport
      coefficients. First, it needs a complete background plasma. Second, it
      needs the hydrogenic ionization pattern associated with this background.
      Finally, it also needs some estimate of the power loss terms due to
      hydrogenic interactions and charge exchange so that these effects can be
      included in the Xperp calculations. These quantities are typically
      obtained from running PIN or another Monte Carlo hydrogenic neutral code
      on the DIVIMP background and retaining the results.</P>
    
    <P> The basic concept behind the extractor is particle and heat
      conservation balance for each ring. The analysis, at present, uses the
      balances for the entire SOL volume from each ring in turn, out to the
      outermost ring and from target to target. Assuming that the particle and
      heat sources (other than ionization) originate in the core plasma, then
      one can calculate a balance for each ring by looking at the sources and
      sinks and then calculating the cross-field flux required to satisfy the
      equations. Since the gradients of density and temperature on the grid can
      be calculated, one can deduce the transport coefficients by dividing the
      integrated gradient contribution for each cell on the ring into the flux
      (assuming the transport coefficients are constant along the ring). These
      values can then be compared to what might be expected experimentally.</P>
    
    <P> This option is still under development. This can be seen when one looks
      at the code itself. Some of the options have been superseded while in
      other cases older versions still remain for the necessary early debugging
      and comparison efforts. At some point this code will be cleaned up and
      some of the options described here will either be modified or removed.
    </P>
    
    <P>The following are the various options that can be set for the Extractor
      routine. </P>
    
    <P> </P>
    
    <H3><A NAME="exmeth">Extractor Methods:</A></H3>
    
    <P> These were various methods used initially to calculate the transport
      coefficients. Only Option 2 should be used now and in later releases this
      input option will be removed. </P>
    
    <P><B>Option 0,1</B>: OBSOLETE</P>
    
    <P><B>Option 2</B>: Calculates transport coefficients ring by ring over
      the entire grid. Gradients are calculated for each cell on the grid, based
      on the values in adjacent cells.</P>
    
    <P> </P>
    
    <H3><A NAME="exrang">Extractor Range:</A></H3>
    
    <P> This option specifies the section of the field-line over which the
      extractor will work. Either the whole ring from target to target or only
      the sub-section of the ring from X-point region around to the X-point
      region on the other side. (The X-point to X-point region is approximately
      defined by the first cell on the separatrix with it's center located above
      the X-point.) Generally, it seems best to use the whole field line in the
      calculations.</P>
    
    <P><B>Option 0</B>: Xpoint</P>
    
    <P><B>Option 1</B>: Whole Ring</P>
    
    <P> </P>
    
    <H3><A NAME="exoutr">Include Outer Ring Losses:</A></H3>
    
    <P> Examining the gradients in density and temperature, it becomes clear
      that there must be a cross-field ion and heat flux across the outermost
      boundary of the grid. In order to calculate the transport coefficients
      correctly, particularly in the rings closer to the outside, it may become
      necessary to include this term in the transport coefficient calculations.
      This may be particularly true for cases with large cross-field gradients
      on the outermost field lines. For cases where there is little or no
      cross-field variation in the background plasma at the outermost ring,
      there will also be little in the way of outer ring losses and so this term
      may not play a role in these cases. The actual amount of outer ring losses
      requires knowledge of the transport coefficients. This difficulty is
      overcome by assuming that the transport coefficient for the outer ring is
      the same as the ring currently being analyzed. This allows the gradient
      summation for the outer ring to be combined with the one for the current
      ring and thus allow a value for the transport coefficient to be extracted.
      This method is used when no data about the transport coefficient is
      available. However, when the Average Calculation Option (described below)
      is turned on, the values of the transport coefficients used for the outer
      ring losses are those calculated by averaging the coefficients found over
      a set of rings closer to the separatrix - themselves calculated using the
      first method described. This average is then applied to the outermost ring
      losses in the transport coefficient calculations for those rings beyond
      the averaging region. </P>
    
    <P><B>Option 0</B>: Off - outermost ring loss corrections are left out of
      the transport coefficient calculations. This assumes that there are no
      particle or heat flows across the outermost plasma ring.</P>
    
    <P><B>Option 1</B>: On - The methods described above are applied to
      calculate an outermost ring perpendicular loss that is factored into the
      transport coefficient calculations.</P>
    
    <P> </P>
    
    <H3><A NAME="exconv">Dperp Convection:</A></H3>
    
    <P> The cross-field flow of particles carries heat and this can be included
      in the calculation of the Xperp coefficients. The Dperp values for each
      ring are calculated first, this then allows the convective heat
      contribution from the Dperps to be added to the Xperp calculations.
      Unfortunately, under certain circumstances, it can be difficult to extract
      a reliable value of Dperp. For example, when the particle balance for the
      ring is almost entirely due to the ionization and target loss (i.e. when
      the actual amount of cross-field flow required is small), the calculation
      of Dperp can be problematic. When this occurs, it is probably better to
      leave this option off and avoid adding the noise in the Dperp extraction
      to the Xperp values.</P>
    
    <P><B>Option 0</B>: Off</P>
    
    <P><B>Option 1</B>: On</P>
    
    <P> </P>
    
    <H3><A NAME="exflux">1/2 Cell Flux Correction:</A></H3>
    
    <P> This is also an obsolete option that was used in examining alternative
      methods of calculating the transport coefficients. It should always be
      turned OFF.</P>
    
    <P><B>Option 0</B>: Off</P>
    
    <P> </P>
    
    <H3><A NAME="exav">Calculate Average Coefficients:</A></H3>
    
    <P> This option will calculate the average values of the transport
      coefficients over the rings IRSEP+N to irsep+N+3 and then apply this
      averaged value to the outer ring loss calculations for all rings greater
      than irsep+N+3. The reason for this is that as one moves out the outer
      ring losses become a bigger contribution to the remaining flux that must
      be accounted for by the transport coefficients. As a result, if the
      transport coefficients for the outer rings are allowed to float the
      calculations can become very sensitive and unstable leading to large
      variations of the transport coefficients on the outer-most rings. This
      option can help to stabilize these variations.</P>
    
    <P><B>Option 0</B>: Off</P>
    
    <P><B>Option N</B>: On - calculate average as noted above where this is
      the value of N indicated. </P>
    
    <P> </P>
    
    <H3><A NAME="exmajr">Major Radius Correction:</A> </H3>
    
    <P> This option is aimed at correcting the extractor for major radius
      effects (toroidal geometry). After testing it was found that this option
      did not cause significant variation in the extracted values of the
      transport coefficients. The code may no longer be up to date with the
      latest extractor options. It is recommended that this option be left
      turned OFF.</P>
    
    <P><B>Option 0</B>: Off</P>
    
    <P> </P>
    
    <H3><A NAME="exgrsm">Gradient Smoothing:</A></H3>
    
    <P> One concern in the extractor was noise in the gradients calculated from
      the plasma background grid. This option allows for averaging/smoothing of
      the gradients in an attempt to even out large variations. It is usually
      left off, at least for initial evaluation purposes. If turned on, a small
      value of N is recommended.</P>
    
    <P><B>Option 0</B>: Off</P>
    
    <P><B>Option N</B>: On - Calculate the gradient in cell (i,j) by averaging the
      values of the gradients in cells (i-N,j), (i-N+1,j) ... (i,j) ... (i+N,j)
      and assigning the average to the (i,j) cell. Where the i'th index runs
      across the field lines.</P>
    
    <P> </P>
    
    <H3><A NAME="exgrad">Gradient Calculation Method:</A></H3>
    
    <P> Different methods used to calculate the cross-field gradients at each
      cell of the grid. Option 0 is usually used.</P>
    
    <P><B>Option -1</B>: On - the gradients are taken from a routine that fits
      a cubic spline to the set of data along each set of knots perpendicular to
      the field line. The cubic spline interpolation itself is not used, only
      the gradients returned by this routine. This is actually functionally
      equivalent to option 0 once the details of the cubic spline interpolation
      routine were examined.</P>
    
    <P><B>Option 0</B>: On - gradient is calculated by taking the average of
      the gradient outward to the next grid cell and inward to the last grid
      cell. </P>
    
    <P><B>Option 1</B>: On - gradient is calculated by taking the value of the
      function at the inward and outward grid cells and the total distance
      between the inward and outward grid cells, ignoring the values in the
      current cell. </P>
    
    <P><B>Option 2</B>: On - gradient is calculated by taking the value of the
      function at the current cell and the next outward cell and the distance
      between them.</P>
    
    <P> </P>
    
    <H3><A NAME="exarea">Cross-field Area Option:</A></H3>
    
    <P> The &quot;area&quot; across which the cross-field flux is moving is
      required in order to estimate the transport coefficients. This could be
      calculated either on the cell centres or at the edge of the respective
      cells. This is typically a very small difference and this option was only
      implemented to test if there was any appreciable change in the calculated
      transport coefficients when this was combined with other options. The cell
      centre Areas are the recommended ones and the ones most often used</P>
    
    <P><B>Option 0</B>: On - Use cell centre evaluated poloidal lengths </P>
    
    <P><B>Option 1</B>: On - Use cell boundary evaluated poloidal lengths</P>
    
    <P> </P>
    
    <H3><A NAME="expow">Power Loss Terms:</A></H3>
    
    <P> This option will include the PIN calculated power loss terms in the
      calculation of the energy transport coefficients (Xperp).</P>
    
    <P><B>Option 0</B>: Off</P>
    
    <P><B>Option 1</B>: On - the values of PINQE and PINQI are read from the
      PIN output and used in the calculation of the extracted transport
      coefficients. </P>
    
    <P><B>Option 2</B>: On - the values of PINQE and PINQI are read from the
      PIN output and used in the calculation of the extracted transport
      coefficients. The value of PEI the equipartition energy transport term is
      calculated analytically and also added in the calculation of the transport
      coefficients. The PEI term is modified by the Pei correction factor
      described below.</P>
    
    <P> </P>
    
    <H3><A NAME="exorth">Non-orthogonal Correction:</A></H3>
    
    <P> This option is a first approximation at correcting the calculated
      gradients for non-orthogonal grids. Since the calculation should use the
      perpendicular gradients, it is necessary to correct the calculated
      gradients based on cell centre positions and quantities for the actual
      perpendicular distance involved. It is recommended to use option 1.
      However, since the majority of the grid is usually orthogonal this is
      often just a small correction.</P>
    
    <P><B>Option 0</B>: Off - No Non-orthogonal corrections are performed.</P>
    
    <P><B>Option 1</B>: On - the calculated value of the gradient for the cell
      is adjusted by dividing by the SIN(cell orthogonal angle). Where the cell
      orthogonal angle is 90 degrees or Pi/2.0 for an orthogonal cell and tends
      towards zero or Pi for a degenerate cell. </P>
    
    <P> </P>
    
    <H3><A NAME="expei">Pei Correction Factor</A></H3>
    
    <P> This value multiplies the analytic expression for the Pei energy
      transfer term used in the extractor. (In option 2 of the Power Loss Term
      option). It would normally be set to 1.0, however, allowing a specifiable
      parameter one can gauge the effect of equipartition on the output. </P>
    
    <P> </P>
    
    <H3><A NAME="exrec">Recycling Coefficient Correction</A></H3>
    
    <P> This value is also usually equal to 1.0. However, in some cases it is
      known that the normalization of the PIN terms is not correct due to
      recycling, pumping or other effects. In these cases, it is not possible to
      extract appropriate transport coefficients because the strength of the
      ionization source is typically too large. This quantity is used to
      multiply all of the source terms that are extracted from the PIN data in
      order to account for recycling/pumping loss. It is also used to match
      Edge2D data where a recycling source fraction less than one is sometimes
      used to induce plasma flow from the core in the fluid simulation. </P>
    
    <P> </P>
    
    <H3><A NAME="exrat">Extractor Dperp/Xperp Ratio Specification</A></H3>
    
    <P> Often the value of Dperp obtained by the extractor can be unreliable
      because it relies on the small difference between two large quantities.
      (The net remaining SOL plasma outflux and the total integrated ionization
      source over a section of the grid.) This unfortunately affects the value
      of Xperp extracted from the background. The Xperp value itself does not
      have the same sensitivity as does the value of Dperp. For this reason it
      can be useful to run the extractor using a fixed ratio of Dperp/Xperp.
      This will allow an estimate of the Xperp value to be extracted while
      losing the error caused by the noisy nature of the extracted Dperp value.
      The cost is the additional constraint of the system of equations. The
      ratio between Dperp and Xperp is not necessarily well known and as a
      result the asigned value may significantly affect the extracted Xperp
      values. </P>
    
    <P> </P>
    
    <H2><A NAME="ppspec">Private Plasma (Trap) Specification Option Inputs</A></H2>
    
    <P> These inputs are used for Tgrad option 2 and SOL22 private plasma
      ionization option -2. The 16 parameters specified here provide a complete
      description of the density, temperatures and velocity of the background
      plasma in the private plasma. This completely prescriptive option was
      implemented because of mounting evidence that the models of the background
      plasma OSM that are appropriate for the main SOL may not apply in the
      private plasma. Furthermore, there are few diagnostics and a limited
      understanding of the physics that lead to the actual conditions in the
      private plasma. As such, it seemed best to allow for the option of
      prescribing the conditions in a manner appropriate for the specific case
      under consideration.</P>
    
    <P>This option uses the specified parameters to impose a two piece
      step-wise linear prescription for the density, temperatures and velocity.
      To make the velocity go to 0.0 at the midpoint, it is necessary to set
      VBF2 = 0.0.</P>
    
    <P>The sixteen parameters are:</P>
    
    <P>Electron temperature (Te): TES1, TEF1, TES2, TEF2 </P>
    
    <P>Ion temperature (Ti): TIS1, TIF1, TIS2, TIF2</P>
    
    <P>Density (Nb): NES1, NEF1, NES2, NEF2</P>
    
    <P>Velocity (Vb): VBS1, VBF1, VBS2, VBF2</P>
    
    <P>They are employed in the following fashion where Q can be interpreted as
      Te, Ti, Nb or Vb.</P>
    
    <P><IMG SRC="images/divref-88.gif" WIDTH="490" HEIGHT="60"></P>
    
    <P><IMG SRC="images/divref-89.gif" WIDTH="763" HEIGHT="60"></P>
    
    <P><IMG SRC="images/divref-90.gif" WIDTH="338" HEIGHT="31"></P>
    
    <P> </P>
    
    <H2><A NAME="rprrn">Vertical Reciprocating Probe - R crossing Number</A></H2>
    
    <P> DIVIMP will produce output for a vertical fast scanning probe. It
      requires two values. The first is the intersection count. The code starts
      at the first target (IK=1, OUTER for JET, INNER for SONNET) and searches
      for intersections at the R value specified for the probe. This quantity
      specifies the R-intersection for which the data will be output. A value of
      0 will turn off the vertical fast scanning probe output. </P>
    
    <P> </P>
    
    <H2><A NAME="rprrl">Vertical Reciprocating Probe - R location</A> </H2>
    
    <P> This specifies the R-location for the vertical fast scanning probe. A
      value of -99.0 will turn off the probe output.</P>
    
    <P> </P>
    
    <H2><A NAME="rprzn">Horizontal Reciprocating Probe - Z crossing number</A></H2>
    
    <P> DIVIMP will produce output for a horizontal fast scanning probe. It
      requires two values. The first is the intersection count. The code starts
      at the first target (IK=1, OUTER for JET, INNER for SONNET) and searches
      for intersections at the Z value specified for the probe. This input
      specifies the Z-intersection for which the data will be output. A value of
      0 will turn off the horizontal fast scanning probe output. </P>
    
    <P> </P>
    
    <H2><A NAME="rprzl">Horizontal Reciprocating Probe - Z location</A></H2>
    
    <P> This specifies the Z-location for the horizontal fast scanning probe. A
      value of -99.0 will turn off the probe output.</P>
    
    <P> </P>
    
    <H2><A NAME="crmarf">Input Parameters for Core Option 4 and 5 (Marfe
      Simulation)</A></H2>
    
    <H2>Vf1, Tf1, Vf2 and Tf2 </H2>
    
    <P>These four parameters are the quantities Vf1, Tf1, Vf2 and Tf2 described
      in the <A HREF="#corepl">Core Option</A> 4 and 5 entries much earlier in
      this document. They are multiplied by the core field line lengths to
      obtain the distances over which the core Marfe descriptions of options 4
      and 5 are applied. </P>
    
    <P>The four quantities in the input are the Velocity distance factor 1,
      Temperature distance factor 1, Velocity distance factor 2, and Temperature
      distance factor 2.</P>
    
    <P> </P>
    
    <H2><A NAME="tgmodf">T-Grad Modification Factor</A></H2>
    
    <P> This factor is used in the UEDGE and Garching correction formulae for
      the temperature gradient forces. These corrections are intended to
      compensate for kinetic effects which would be expected to weaken the
      temperature gradient force which is dependent on a good collisional
      coupling for energy transfer along the field lines. </P>
    
    <P> </P>
    
    <H2><A NAME="300">300 SOL23  Parameter read option  0-NO 1-YES</A></H2>
    
    <P> This input has a value of 0 for OFF and 1 for ON. All this input does
      in indicate whether or not the set of SOL23 input parameters are 
      present in the current input file. There are approximately 75 parameters
      that can be specified for SOL option 23. These are documented in the 
      supplementary <a href="divref-sol23.html">DIVIMP SOL23 Documentation</a>. 


    <P> </P>
    
    <H2><A NAME="nimbin">Nimbus Namelist Input : NIMBIN</A></H2>
    
    <P> The following block of entries are not used by DIVIMP - instead they
      are used by NIMBUS when a PIN run is requested. Since DIVIMP ignores these
      values and NIMBUS will ignore everything else except the namelist input -
      it is safer and more efficient to include the parameters for the NIMBUS
      run in the DIVIMP input file. Under these circumstances, it is always
      clear what options were used to run Nimbus/PIN with a specific DIVIMP
      case. In addition, the entries in the namelist are now analyzed by DIVIMP
      and printed in the data file with a description and their usual default
      values. These items are not printed or analyzed if NIMBUS is not run. </P>
    
    <P>The following is a list of the namelist parameters for PIN/NIMBUS which
      DIVIMP recognizes and for which it can produce a simple description. The
      contents of this list are neither complete nor extensive but simply serve
      as a quick reference for DIVIMP users using the PIN/NIMBUS code. The
      default value for an entry (the value that is assigned inside NIMBUS if
      this parameter is NOT specified) is included in [ ] if it is known.</P>
    
    <P><B>NHIST</B>: Number of Neutral Histories [2000]</P>
    
    <P><B>IFCHAN</B>: 0=No Channels 1=Yes [1]</P>
    
    <P><B>IFWALD</B>: 0=off [0]</P>
    
    <P> 1=request distributions of sputtering and power along walls in print
      file.</P>
    
    <P><B>IFPRIM</B>: 0=do not follow impurity neutrals 1=do [1]')</P>
    
    <P><B>IZWALL</B>: Atomic number of wall</P>
    
    <P><B>IAEMIS</B>: 0=Mol. reemission [0]</P>
    
    <P> 1=Atomic Reemission</P>
    
    <P> -1/-2=INUTPG @ EATMR + AT./MOL</P>
    
    <P><B>KINDPR</B>: Print Switch 0=minimum [0]</P>
    
    <P><B>TWALL</B>: Vessel Wall Temperature (C) [300]</P>
    
    <P><B>ZESCUT</B>: Gap polygons above or equal are wall [INF]</P>
    
    <P><B>JXLM</B>: Knot for projection beyond X-pt. (Use default) [0]</P>
    
    <P><B>JXRM</B>: Knot for projection beyond X-pt. (Use default) [0]</P>
    
    <P><B>XC1</B>: Point for projection beyond X-pt. (Use default) [RPX]</P>
    
    <P><B>YC1</B>: Point for projection beyond X-pt. (Use default) [ZPX]</P>
    
    <P><B>IALB</B>: Albedo condition 0=wall 1=albedo 2=void for P.P. void [0]</P>
    
    <P><B>LWALL</B>: Use Actual Vessel As Wall (True/False) [T]</P>
    
    <P><B>LBUFLE</B>: Use Baffle (Set False) (True/False) [T]</P>
    
    <P><B>LPWALL</B>: Use Vessel Wall for private region (True/False) (forces
      LBUFLE=F) [F]</P>
    
    <P><B>LPSEG</B>: Use Explicit Source segments around private void. (Set
      True!) (True/False) [F]</P>
    
    <P><B>IALBPG</B>: Switch for turning specific wall segments into albedo
      regions - rely on pump files - [off]</P>
    
    <P><B>ALBPG</B>: Switch for turning specific wall segments into albedo
      regions - rely on pump files - [off]</P>
    
    <P><B>ALBEPG</B>: Switch for turning specific wall segments into albedo
      regions - rely on pump files - [off]</P>
    
    <P><B>ALATO</B>: Switch for turning specific wall segments into albedo
      regions - rely on pump files - [off]</P>
    
    <P><B>LNWESC</B>: Use New Escape Figure Method (Use T) (True/False) [T]</P>
    
    <P><B>EATMD</B>: Energy (eV) of neutrals re-emitted as atoms.
      0.0=Franck-Condon [0.025]</P>
    
    <P><B>MCX</B>: Model for energy after CX - use default [0]</P>
    
    <P><B>NTSPUT</B>: Turn on neutral sputtering of impurities? 0=off 1=on [1]</P>
    
    <P><B>IHOR</B>: Switch for multi-group vel. distributions. 0=off 1=on [0]</P>
    
    <P><B>DECIMA</B>: Decimation probability - leave as is - [0.7]</P>
    
    <P><B>MODATM</B>: Model for atomic CX Losses [1]</P>
    
    <P><B>NCOLP</B>: Max # of collisons before R.R. analog game (0 to 100,00)
      (use default) [0]</P>
    
    <P><B>ISEHHE</B>: Model for elastic scattering. 0=none 1to7=diff. comb. of
      H,HZ,HE (use 0) [0]</P>
    
    <P><B>RNLITE</B>: Reflected fraction of light impurity (?) [1]</P>
    
    <P><B>EWLITE</B>: Energy (eV) of reflected light impurity (?) [0]</P>
    
    <P><B>INUTPG</B>: Regions to be set as recyclers (use default) [All Wall]</P>
    
    <P><B>EATMR</B>: Enrgy (eV) of forced reflected neutrals [EATMD]</P>
    
    <P><B>TDIV</B>: Divertor wall temperature (C) [TWALL]</P>
    
    <P><B>LPUMP</B>: Switch on pump - in pump structure - (T/F) [T]</P>
    
    <P><B>INPUMP</B>: Channel for reading pumpfile - SET=18!! - [LDUMIO]</P>
    
    <P><B>FPUMP</B>: Pump structure file name default = none ['' '']</P>
    
    <P><B>ALBPMP</B>: Albedo for pump &lt;0=use pump value [-1e30]</P>
    
    <P><B>PSEMPO</B>: Transparency of Outer SOL DIV &lt;0= use pump file
      [-1e30]</P>
    
    <P><B>PSEMPT</B>: Transparency of TARGET DIV &lt;0=use pump file [-1e30]</P>
    
    <P><B>PSEMPI</B>: Transparency of Inner SOL DIV &lt;0= use pump file
      [-1e30]</P>
    
    <P><B>PSEMPO</B>: Transparency of CHEVRON &lt;0= use pump file [-1e30]</P>
    
    <P><B>IPSEMP</B>: Define wall regions to be semi-transparent - Rely on
      pump files - [none]</P>
    
    <P><B>PSEMP</B>: Define wall regions to be semi-transparent- Rely on pump
      files - [0]</P>
    
    <P><B>PSEMPB</B>: Transparency of baffle - 1e30 = do not use [1e30]')</P>
    
    <P><B>IPVOID</B>: Flag for treatment of pump void walls - use -1! - [1]</P>
    
    <P><B>IVIEW</B>: 0=std. Nimbus geom. map -1=user defined window [0]</P>
    
    <P><B>VIEW</B>: (Rmin,Zmin,Rlen, Zlen) of user defined window GEOM from
      GRID2D - [GEOM]</P>
    
    <P><B>ITRIM</B>: 0=no TRIM files 1=use TRIM files -use 1!- [0]</P>
    
    <P><B>FTRIM</B>: TRIM file prefix - set in /NIMBIN/ - [CTRIMF]</P>
    
    <P><B>LFULL</B>: Full setup for NIMBUS at every call (T/F) - use T - [T]</P>
    
    <P><B>ITARHZ</B>: Switches (2) to determine when to use horizontal escape
      figure - use default - [2*MX]</P>
    
    <P><B>ICHKP</B>: 0=Stop on polygon problems in NIMBUS 1=warn - use default
      - [1]</P>
    
    <P><B>LTIME</B>: Time dependent Monte Carlo (T/F) - use F - [F]</P>
    
    <P><B>TWIDTH</B>: Time slice width - only for time-dependent mode - [0]</P>
    
    <P><B>TWDMIN</B>: Minimum time slice width - only for time dependent mode
      - [0]</P>
    
    <P><B>AYIZ</B>: Enhanced Yield from H: Y''=AY+B [1]</P>
    
    <P><B>BYIZ</B>: Enhanced Yield from H: Y''=AY+B [0]</P>
    
    <P><B>ICORRN</B>: Random number correlation flag - use default - [UNDEF]</P>
    
    <P><B>ALBLK</B>: Albedo of pump leaks &lt;0=use pump file - [-1e30]</P>
    
    <P><B>DCUTCX</B>: Maximum density for CX [1e30]</P>
    
    <P><B>TCUTCX</B>: Minimum temperature for CX [-1e30]</P>
    
    <P><B>ITAU</B>: Model for flux estimator &lt;=1=estimated dist. &gt;1=dist.-
      use default - [1]</P>
    
    <P><B>IYCHEM</B>: Model for chemical sputtering - 0=off 1+=model selected
      - [0]</P>
    
    <P><B>EYCHEM</B>: Energy (eV) of chemically sputtered C ''atom'' - [0.0]</P>
    
    <P><B>IDBHST</B>: Number of histories to store trajectories - use default
      - [0]</P>
    
    <P><B>XGAUGE</B>: R position - to override gauge location in pump file -
      [1e30]</P>
    
    <P><B>YGAUGE</B>: Z position - to override gauge location in pump file -
      [1e30]</P>
    
    <P><B>RGAUGE</B>: Radius - to override gauge location in pump file -
      [1e30]</P>
    
    <P><B>LGAUGE</B>: Label - 'G' for pump gauge (leave as is) - 'K' for
      vessel - [''G'',''K'']</P>
    
    <P><B>MODEZR</B>: Model for impurity ion recycling - use default - [1]</P>
    
    <P><B>ISPOFF</B>: Switch off recycling in specifed macrozones - [0]</P>
    
    <P><B>MIMP</B>: # imp switch - being developed - use 0 for now - [0]</P>
    
    <P><B>LRS</B>: Override leak recycling segments in pump file : '&lt;ID&gt;
      X1 Y1 X2 Y2' - [60*'' '']</P>
    
    <P><B>GAP</B>: Override Gap segments in pump file : '&lt;ID&gt; X1 Y1 X2
      Y2 T' (transparency) - [60*'' '']</P>
    
    <P> </P>
    
    <H1><A NAME="appa"> Appendix A: SKELETON DATAFILE for DIVIMP</A></H1>
    
    <P> <B>This is an example data file for the DIVIMP code that works with
      version 6.10 of the code. It contains a set of options that were used for
      modelling a specific case under specific circumstances. As such, the
      values shown here are only representative and may not apply to any
      particular case a user wishes to model. </B></P>
    
    <p></p>
    
    <h2><a href="xref-div6.10.html">Sample DIVIMP Input File</a></h2>
    
    <P> </P>
 
  </BODY>
</html>
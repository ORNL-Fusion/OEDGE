C
C
      FUNCTION FTHOMP(UB,EMAX)
C
C  RANDOM NUMBER "E" FROM A THOMPSON FUNCTION F(E,UB,EMAX)
C  F(E,UB,EMAX)=CONST*E/(E+UB)**3,  0<E<EMAX
C  CONST=UB/(0.5*1./(EMAX/UB+1.)**2-1./(EMAX/UB+1.)+0.5)
C
      USE PRECISION

      IMPLICIT NONE

      REAL(DP), INTENT(IN) :: UB, EMAX
      REAL(DP) :: A, E, ARG, BETAD2, FTHOMP, EMU
      REAL(DP), EXTERNAL :: RANF_EIRENE

      EMU=1./(EMAX/UB+1.)
      BETAD2=1./(EMU*EMU-EMU-EMU+1.)
C
      A=RANF_EIRENE()
      ARG=A/BETAD2
      E=UB/(1.-SQRT(ARG))-UB
      FTHOMP=E
C
      RETURN
      END

      MODULE BRASCL

C  RESCALING ARRAYS FOR NEUTRAL SOURCE TERMS IN SHORT LOOP

      USE PRECISION
      USE PARMMOD

      IMPLICIT NONE

      PRIVATE

      PUBLIC :: ALLOC_BRASCL, DEALLOC_BRASCL,
     P          INIT_BRASCL1, INIT_BRASCL2

      REAL(DP), PUBLIC, ALLOCATABLE, SAVE ::
     R SPLODA(:,:,:), SEIODA(:,:), SEEODA(:,:), SMOODA(:,:),
     R SPLODI(:,:,:), SEIODI(:,:), SEEODI(:,:), SMOODI(:,:),
     R SPLODM(:,:,:), SEIODM(:,:), SEEODM(:,:), SMOODM(:,:),
     R SPLNWA(:,:,:), SEINWA(:,:), SEENWA(:,:), SMONWA(:,:),
     R SPLNWI(:,:,:), SEINWI(:,:), SEENWI(:,:), SMONWI(:,:),
     R SPLNWM(:,:,:), SEINWM(:,:), SEENWM(:,:), SMONWM(:,:)


      CONTAINS


      SUBROUTINE ALLOC_BRASCL

      IF (ALLOCATED(SPLODA)) RETURN

      ALLOCATE (SPLODA(NRAD,NATM,NPLS))
      ALLOCATE (SEIODA(NRAD,NPLS))
      ALLOCATE (SEEODA(NRAD,NATM))
      ALLOCATE (SMOODA(NRAD,NATM))
      ALLOCATE (SPLODI(NRAD,NION,NPLS))
      ALLOCATE (SEIODI(NRAD,NION))
      ALLOCATE (SEEODI(NRAD,NION))
      ALLOCATE (SMOODI(NRAD,NION))
      ALLOCATE (SPLODM(NRAD,NMOL,NPLS))
      ALLOCATE (SEIODM(NRAD,NMOL))
      ALLOCATE (SEEODM(NRAD,NMOL))
      ALLOCATE (SMOODM(NRAD,NMOL))
      ALLOCATE (SPLNWA(NRAD,NATM,NPLS))
      ALLOCATE (SEINWA(NRAD,NPLS))
      ALLOCATE (SEENWA(NRAD,NATM))
      ALLOCATE (SMONWA(NRAD,NATM))
      ALLOCATE (SPLNWI(NRAD,NION,NPLS))
      ALLOCATE (SEINWI(NRAD,NION))
      ALLOCATE (SEENWI(NRAD,NION))
      ALLOCATE (SMONWI(NRAD,NION))
      ALLOCATE (SPLNWM(NRAD,NMOL,NPLS))
      ALLOCATE (SEINWM(NRAD,NMOL))
      ALLOCATE (SEENWM(NRAD,NMOL))
      ALLOCATE (SMONWM(NRAD,NMOL))

      WRITE (55,'(A,T25,I15)')
     .      ' BRASCL ',NRAD*(NATM*(2*NPLS+4)+NION*(2*NPLS+6)+
     .                 NMOL*(2*NPLS+6)+2*NPLS)*8

      CALL INIT_BRASCL1
      CALL INIT_BRASCL2

      RETURN
      END SUBROUTINE ALLOC_BRASCL


      SUBROUTINE DEALLOC_BRASCL

      IF (.NOT.ALLOCATED(SPLODA)) RETURN

      DEALLOCATE (SPLODA)
      DEALLOCATE (SEIODA)
      DEALLOCATE (SEEODA)
      DEALLOCATE (SMOODA)
      DEALLOCATE (SPLODI)
      DEALLOCATE (SEIODI)
      DEALLOCATE (SEEODI)
      DEALLOCATE (SMOODI)
      DEALLOCATE (SPLODM)
      DEALLOCATE (SEIODM)
      DEALLOCATE (SEEODM)
      DEALLOCATE (SMOODM)
      DEALLOCATE (SPLNWA)
      DEALLOCATE (SEINWA)
      DEALLOCATE (SEENWA)
      DEALLOCATE (SMONWA)
      DEALLOCATE (SPLNWI)
      DEALLOCATE (SEINWI)
      DEALLOCATE (SEENWI)
      DEALLOCATE (SMONWI)
      DEALLOCATE (SPLNWM)
      DEALLOCATE (SEINWM)
      DEALLOCATE (SEENWM)
      DEALLOCATE (SMONWM)

      RETURN
      END SUBROUTINE DEALLOC_BRASCL


      SUBROUTINE INIT_BRASCL1

      SPLODA = 0.D0
      SEIODA = 0.D0
      SEEODA = 0.D0
      SMOODA = 0.D0
      SPLODI = 0.D0
      SEIODI = 0.D0
      SEEODI = 0.D0
      SMOODI = 0.D0
      SPLODM = 0.D0
      SEIODM = 0.D0
      SEEODM = 0.D0
      SMOODM = 0.D0

      RETURN
      END SUBROUTINE INIT_BRASCL1


      SUBROUTINE INIT_BRASCL2

      SPLNWA = 0.D0
      SEINWA = 0.D0
      SEENWA = 0.D0
      SMONWA = 0.D0
      SPLNWI = 0.D0
      SEINWI = 0.D0
      SEENWI = 0.D0
      SMONWI = 0.D0
      SPLNWM = 0.D0
      SEINWM = 0.D0
      SEENWM = 0.D0
      SMONWM = 0.D0

      RETURN
      END SUBROUTINE INIT_BRASCL2

      END MODULE BRASCL

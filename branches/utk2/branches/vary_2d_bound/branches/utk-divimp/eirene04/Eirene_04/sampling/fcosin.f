C
C
      SUBROUTINE FCOSIN
C
C  SAMPLE IRNDVC TRIPLES OF RANDOM NUMBER FROM A COSINE POLAR AND
C  AN EQUI AZIMUTAL DISTRIBUTION
C  AND RETURN THEM IN THE ARRAYS FC1,FC2,FC3
C  THIS ROUTINE IS CALLED, IF INIV4=0, AND IT RETURNS INIV4=IRNDVC
C
      USE CRAND

      IMPLICIT NONE

      REAL(DP) :: A, ZCTHET, ZSTHET, ZCPHI, ZSPHI, PI2, ZTHET
      REAL(DP), EXTERNAL :: RANF_EIRENE
      INTEGER :: J

      DATA PI2/6.283185/
C
      DO 100 J=1,IRNDVC
        ZTHET=PI2*RANF_EIRENE( )
        ZSTHET=SIN(ZTHET)
        ZCTHET=COS(ZTHET)
        A=RANF_EIRENE( )
        ZCPHI=SQRT(A)
        ZSPHI=SQRT(1.-A)
        FC1(J)=-ZCPHI
        FC2(J)=ZSPHI*ZCTHET
        FC3(J)=ZSPHI*ZSTHET
100   CONTINUE
      INIV4=IRNDVC
      RETURN
      END

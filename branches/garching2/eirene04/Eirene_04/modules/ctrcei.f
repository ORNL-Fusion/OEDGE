      MODULE CTRCEI

      USE PRECISION
      USE PARMMOD

      IMPLICIT NONE

      PRIVATE

      PUBLIC :: ALLOC_CTRCEI, DEALLOC_CTRCEI, INIT_CTRCEI

      LOGICAL, PUBLIC, TARGET, ALLOCATABLE, SAVE :: LTRCEI(:)

      LOGICAL, PUBLIC, POINTER, SAVE ::
     L TRCPLT, TRCHST, TRCNAL, TRCMOD, TRCSIG,
     L TRCGRD, TRCSUR, TRCREF, TRCFLE, TRCAMD,
     L TRCINT, TRCLST, TRCSOU, TRCREC, TRCTIM,
     L TRCBLA, TRCBLP, TRCBLE, TRCBLM, TRCBLI,
     L TRCBLPH

      LOGICAL, PUBLIC, ALLOCATABLE, SAVE :: TRCSRC(:)

      INTEGER, PUBLIC, TARGET, ALLOCATABLE, SAVE :: ITRCEI(:)

      INTEGER, PUBLIC, POINTER, SAVE ::
     I NPRTLV(:), NPRTLS(:), NPRSRF(:),
     I NVOLPR,    NFLAGV(:), NTLVFL(:),
     I NSURPR,    NFLAGS(:), NTLSFL(:),
     I I1TRC,     I2TRC

      INTEGER, PUBLIC, ALLOCATABLE, SAVE ::
     I NSPEZV(:,:), NSPEZS(:,:)

      INTEGER, PUBLIC, SAVE :: MCTRC, LCTRC

      CONTAINS


      SUBROUTINE ALLOC_CTRCEI

      IF (ALLOCATED(LTRCEI)) RETURN

      MCTRC=4+300+4*NLIMPS
      LCTRC=21

      ALLOCATE (LTRCEI(LCTRC))
      ALLOCATE (ITRCEI(MCTRC))
      ALLOCATE (TRCSRC(0:NSTRA))
      ALLOCATE (NSPEZV(100,2))
      ALLOCATE (NSPEZS(NLIMPS,2))

      WRITE (55,'(A,T25,I15)')
     .       ' CTRCEI ',(LCTRC+(NSTRA+1))*4
      WRITE (55,'(A,T25,I15)')
     .       ' CTRCEI ',(MCTRC+200+2*NLIMPS)*4

      TRCPLT => LTRCEI( 1)
      TRCHST => LTRCEI( 2)
      TRCNAL => LTRCEI( 3)
      TRCMOD => LTRCEI( 4)
      TRCSIG => LTRCEI( 5)
      TRCGRD => LTRCEI( 6)
      TRCSUR => LTRCEI( 7)
      TRCREF => LTRCEI( 8)
      TRCFLE => LTRCEI( 9)
      TRCAMD => LTRCEI(10)
      TRCINT => LTRCEI(11)
      TRCLST => LTRCEI(12)
      TRCSOU => LTRCEI(13)
      TRCREC => LTRCEI(14)
      TRCTIM => LTRCEI(15)
      TRCBLA => LTRCEI(16)
      TRCBLP => LTRCEI(17)
      TRCBLE => LTRCEI(18)
      TRCBLM => LTRCEI(19)
      TRCBLI => LTRCEI(20)
      TRCBLPH=> LTRCEI(21)

      NPRTLV => ITRCEI(  1 : 100)
      NFLAGV => ITRCEI(101 : 200)
      NTLVFL => ITRCEI(201 : 300)
      NPRTLS => ITRCEI(301        : 300+  NLIMPS)
      NPRSRF => ITRCEI(301+  NLIMPS : 300+2*NLIMPS)
      NFLAGS => ITRCEI(301+2*NLIMPS : 300+3*NLIMPS)
      NTLSFL => ITRCEI(301+3*NLIMPS : 300+4*NLIMPS)
      NVOLPR => ITRCEI(301+4*NLIMPS)
      NSURPR => ITRCEI(302+4*NLIMPS)
      I1TRC  => ITRCEI(303+4*NLIMPS)
      I2TRC  => ITRCEI(304+4*NLIMPS)

      CALL INIT_CTRCEI

      RETURN
      END SUBROUTINE ALLOC_CTRCEI


      SUBROUTINE DEALLOC_CTRCEI

      IF (.NOT.ALLOCATED(LTRCEI)) RETURN

      DEALLOCATE (LTRCEI)
      DEALLOCATE (ITRCEI)
      DEALLOCATE (TRCSRC)
      DEALLOCATE (NSPEZV)
      DEALLOCATE (NSPEZS)

      RETURN
      END SUBROUTINE DEALLOC_CTRCEI


      SUBROUTINE INIT_CTRCEI

      LTRCEI = .FALSE.
      ITRCEI = 0
      TRCSRC = .FALSE.
      NSPEZV = 0
      NSPEZS = 0
      NFLAGV = 1

      RETURN
      END SUBROUTINE INIT_CTRCEI

      END MODULE CTRCEI
